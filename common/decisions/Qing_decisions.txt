########################
#   Qing Decisions     #
#  by MantisToboggan   #
########################

#placate assembly parties
QIE_meet_assembly_parties_decisions = {
	QIE_placate_manchu = {
		icon = generic_agreement

		fire_only_once = yes
		cost = 10
		ai_will_do = { factor = 640 }

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_placate_manchu"
			set_country_flag = QIE_placate_manchu
			country_event = qiedom.14
			hidden_effect = {
				country_event = {
					id = qiedom.17
					days = 3
					random = 72
				}
			}
		}
	}
	QIE_placate_YCP = {
		icon = generic_agreement

		fire_only_once = yes
		cost = 10
		ai_will_do = { factor = 640 }

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_placate_YCP"
			set_country_flag = QIE_placate_YCP
			country_event = qiedom.15
			hidden_effect = {
				country_event = {
					id = qiedom.17
					days = 3
					random = 72
				}
			}
		}
	}
	QIE_placate_NCERA = {
		icon = generic_agreement

		fire_only_once = yes
		cost = 10
		ai_will_do = { factor = 640 }

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_placate_NCERA"
			set_country_flag = QIE_placate_NCERA
			country_event = qiedom.16
			hidden_effect = {
				country_event = {
					id = qiedom.17
					days = 3
					random = 72
				}
			}
		}
	}
}

#############################
#Zhili Plans (liu vs. baili)#
#############################

QIE_jiang_baili_plan_category = {
	QIE_jiang_plan_mission = {
		icon = fortress

		allowed = { always = no } #manually activated

		available = { #goal
			NOT = {
				has_country_flag = jiangbaili1_incomplete
				has_country_flag = jiangbaili2_incomplete
				has_country_flag = jiangbaili3_incomplete
			}
		}

		is_good = no
		days_mission_timeout = 720

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout QIE_jiang_plan_mission"
			add_timed_idea = {
				idea = QIE_unprepared_military
				days = 730
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_jiang_plan_mission"
			add_ideas = QIE_jiang_baili_plan_success
		}
	}

	QIE_jiang_baili_phase1 = { #build land forts on FNG border
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_jiang_baili_phase1"
			clr_country_flag = jiangbaili1_incomplete
			every_owned_state = {
				limit = {
					any_neighbor_state = { NOT = { is_owned_by = ROOT } }
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = {
						all_provinces = yes
						limit_to_border = yes
					}
				}
			}
		}
	}
	QIE_jiang_baili_phase2 = { #build coastal forts
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_jiang_baili_phase2"
			clr_country_flag = jiangbaili2_incomplete
			every_owned_state = {
				limit = { is_coastal = yes }
				add_building_construction = {
					type = coastal_bunker
					level = 3
					province = {
						all_provinces = yes
						limit_to_naval_base = yes
					}
				}
			}
		}
	}
	QIE_jiang_baili_phase3 = {
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_jiang_baili_phase3"
			clr_country_flag = jiangbaili3_incomplete
			every_owned_state = {
				add_building_construction = {
					type = bunker
					province = {
						all_provinces = yes
						limit_to_victory_point = yes
					}
					level = 3
				}
			}
		}
	}
}

QIE_liu_menggeng_plan_category = {
	QIE_liu_plan_mission = {
		icon = generic_military

		allowed = { always = no } #manually activated

		available = { #goal
			NOT = {
				has_country_flag = liumenggeng1_incomplete
				has_country_flag = liumenggeng2_incomplete
				has_country_flag = liumenggeng3_incomplete
			}
		}

		is_good = no
		days_mission_timeout = 720

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout QIE_liu_plan_mission"
			add_timed_idea = {
				idea = QIE_unprepared_military
				days = 730
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_liu_plan_mission"
			add_ideas = QIE_liu_menggeng_plan_success
		}
	}
	QIE_liu_menggeng_phase_1 = { #invest in health care
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_liu_menggeng_phase_1"
			clr_country_flag = liumenggeng1_incomplete
			if = {
				limit = {
					NOT = {
						has_tech = tech_field_hospital
						is_researching_technology = tech_field_hospital
					}
				}
				set_technology = { tech_field_hospital = 1 }
			}
			else = {
				add_tech_bonus = {
					name = QIE_liu_menggeng_phase_1
					bonus = 1
					uses = 1
					category = hospital_tech
				}
			}
		}
	}
	QIE_liu_menggeng_phase_2 = { #invest in logistics
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_liu_menggeng_phase_2"
			clr_country_flag = liumenggeng2_incomplete
			if = {
				limit = {
					NOT = {
						has_tech = tech_engineers
						is_researching_technology = tech_engineers
					}
				}
				set_technology = { tech_engineers = 1 }
			}
			else = {
				add_tech_bonus = {
					name = QIE_liu_menggeng_phase_2
					bonus = 1
					uses = 1
					category = engineers_tech
				}
			}
		}
	}
	QIE_liu_menggeng_phase_3 = { #build some interior railroads
		icon = generic_prepare_civil_war

		available = {
			num_of_civilian_factories_available_for_projects > 2
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = { factor = 800 }

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_liu_menggeng_phase_3"
			clr_country_flag = liumenggeng3_incomplete
			every_owned_state = {
				limit = { is_coastal = no }
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
	}
}

@QIE_german_influence_small_change = 0.05
@QIE_german_influence_large_change = 0.08

############################
#German Influence Decisions#
############################
QIE_manage_german_influence = { #ways to buy down german support or gain PP by selling out
	QIE_bribe_lobbyists = { #lose PP, lose MarLib popularity
		icon = generic_flags

		days_remove = 50
		days_re_enable = 5

		ai_will_do = {
			base = 0
			modifier = {
				add = 25
				market_liberal > 0.40
			}
			modifier = {
				factor = 0
				has_political_power < 0
			}
		}

		custom_cost_text = QIE_MINUS_50_PP_MINUS_5_PEKCOM
		custom_cost_trigger = {
			has_political_power > 50
			market_liberal > @QIE_german_influence_small_change
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_bribe_lobbyists"
			effect_tooltip = {
				set_temp_variable = { change = @QIE_german_influence_small_change }
				multiply_temp_variable = { change = -1 }
				add_popularity = {
					ideology = market_liberal
					popularity = change
				}
			}
			hidden_effect = {
				set_temp_variable = { QIE_final_harmony_association_influence = party_popularity@authoritarian_democrat }
				add_to_temp_variable = { QIE_final_harmony_association_influence = @QIE_german_influence_small_change }
				multiply_temp_variable = { QIE_final_harmony_association_influence = 100 }

				set_temp_variable = { QIE_final_peking_kommission_influence = party_popularity@market_liberal }
				subtract_from_temp_variable = { QIE_final_peking_kommission_influence = @QIE_german_influence_small_change }
				multiply_temp_variable = { QIE_final_peking_kommission_influence = 100 }

				set_political_party = {
					ideology = authoritarian_democrat
					popularity = QIE_final_harmony_association_influence
				}
				set_political_party = {
					ideology = market_liberal
					popularity = QIE_final_peking_kommission_influence
				}
			}
			QIE_recalculate_peking_commission = yes
			add_political_power = -50
		}
	}
	QIE_encourage_domestic_production = { #get spirit that lowers civ factory for 60 days, at end get drop in MarLib popularity
		icon = GFX_decision_generic_industry

		days_remove = 60
		days_re_enable = 5

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				market_liberal > 0.40
			}
		}

		modifier = {
			consumer_goods_factor = 0.1
		}

		custom_cost_text = QIE_MINUS_IND_MINUS_8_PEKCOM
		custom_cost_trigger = {
			market_liberal > 0.08
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_encourage_domestic_production"
			effect_tooltip = {
				set_temp_variable = { change = @QIE_german_influence_large_change }
				multiply_temp_variable = { change = -1 }
				add_popularity = {
					ideology = market_liberal
					popularity = change
				}
			}
			hidden_effect = {
				set_temp_variable = { QIE_final_harmony_association_influence = party_popularity@authoritarian_democrat }
				add_to_temp_variable = { QIE_final_harmony_association_influence = @QIE_german_influence_large_change }
				multiply_temp_variable = { QIE_final_harmony_association_influence = 100 }

				set_temp_variable = { QIE_final_peking_kommission_influence = party_popularity@market_liberal }
				subtract_from_temp_variable = { QIE_final_peking_kommission_influence = @QIE_german_influence_large_change }
				multiply_temp_variable = { QIE_final_peking_kommission_influence = 100 }

				set_political_party = {
					ideology = authoritarian_democrat
					popularity = QIE_final_harmony_association_influence
				}
				set_political_party = {
					ideology = market_liberal
					popularity = QIE_final_peking_kommission_influence
				}
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_encourage_anti_german_boycott = { 	#loses MarLib and AuthDem party, lowers stability
		icon = GFX_decision_generic_scorched_earth

		days_re_enable = 30

		ai_will_do = {
			base = 0
			modifier = {
				factor = 100
				market_liberal > 0.40
			}
		}

		custom_cost_text = QIE_MINUS_5_HA_MINUS_5_PEKOM
		custom_cost_trigger = {
			authoritarian_democrat > @QIE_german_influence_small_change
			market_liberal > @QIE_german_influence_small_change
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_encourage_anti_german_boycott"
			set_temp_variable = { change = @QIE_german_influence_small_change }
			multiply_temp_variable = { change = -1 }
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = change
			}
			add_popularity = {
				ideology = market_liberal
				popularity = change
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_entice_financial_support = { #50 PP for 3 MarLib popularity
		icon = GFX_decision_hol_exchange_intelligence_data
		available = {
			GER = { GER_has_black_monday = no }
			market_liberal < 0.95
		}

		cost = 0
		days_re_enable = 30

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				has_political_power < 50
			}
			modifier = {
				factor = 0
				market_liberal > 0.25
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_entice_financial_support"
			add_political_power = 50
			add_popularity = {
				ideology = market_liberal
				popularity = @QIE_german_influence_small_change
			}
			QIE_recalculate_peking_commission = yes
		}
	}
}

#german weaponry decisions
QIE_buy_german_eqip_decisions = {	#purchase german small arms
	QIE_buy_ger_rifles = {
		icon = generic_prepare_civil_war
		available = {
			has_completed_focus = QIE_buymauser
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@infantry_equipment > 0 }

				set_temp_variable = { QIE_infantry_equipment_ratio = num_equipment_in_armies@infantry_equipment }
				divide_temp_variable = { QIE_infantry_equipment_ratio = num_target_equipment_in_armies@infantry_equipment }

				set_temp_variable = { QIE_purchase_infantry_equipment_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_infantry_equipment_factor = QIE_infantry_equipment_ratio }
				multiply_temp_variable = { QIE_purchase_infantry_equipment_factor = 20 }

				add = QIE_purchase_infantry_equipment_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_3_MARKS
		custom_cost_trigger = {
			market_liberal < 0.97
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_rifles"
			set_country_flag = QIE_bought_foreign_guns
			add_equipment_to_stockpile = {
				type = infantry_equipment_1
				amount = 2500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.03
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_support = { #purchase German support equipment
		icon = GFX_decision_support_equipment
		available = {
			has_completed_focus = QIE_buymauser
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@support_equipment > 0 }

				set_temp_variable = { QIE_support_ratio = num_equipment_in_armies@support_equipment }
				divide_temp_variable = { QIE_support_ratio = num_target_equipment_in_armies@support_equipment }

				set_temp_variable = { QIE_purchase_support_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_support_factor = QIE_support_ratio }
				multiply_temp_variable = { QIE_purchase_support_factor = 20 }

				add = QIE_purchase_support_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_4_MARKS
		custom_cost_trigger = {
			market_liberal < 0.96
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_support"
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.04
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_arty = { #purchase German artillery
		icon = GFX_decision_artillery
		available = {
			has_completed_focus = QIE_buymauser
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@artillery_equipment > 0 }

				set_temp_variable = { QIE_artillery_ratio = num_equipment_in_armies@artillery_equipment }
				divide_temp_variable = { QIE_artillery_ratio = num_target_equipment_in_armies@artillery_equipment }

				set_temp_variable = { QIE_purchase_artillery_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_artillery_factor = QIE_artillery_ratio }
				multiply_temp_variable = { QIE_purchase_artillery_factor = 20 }

				add = QIE_purchase_artillery_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_4_MARKS
		custom_cost_trigger = {
			market_liberal < 0.96
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_arty"
			add_equipment_to_stockpile = {
				type = artillery_equipment_1
				amount = 500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.04
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_anti_tank = { #purchase German anti-tank guns
		icon = GFX_decision_artillery
		available = {
			has_completed_focus = QIE_buymauser
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@anti_tank_equipment > 0 }

				set_temp_variable = { QIE_anti_tank_ratio = num_equipment_in_armies@anti_tank_equipment }
				divide_temp_variable = { QIE_anti_tank_ratio = num_target_equipment_in_armies@anti_tank_equipment }

				set_temp_variable = { QIE_purchase_anti_tank_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_anti_tank_factor = QIE_anti_tank_ratio }
				multiply_temp_variable = { QIE_purchase_anti_tank_factor = 20 }

				add = QIE_purchase_anti_tank_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_4_MARKS
		custom_cost_trigger = {
			market_liberal < 0.96
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_anti_tank"
			add_equipment_to_stockpile = {
				type = anti_tank_equipment_1
				amount = 500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.04
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_anti_air = { #purchase German anti-air guns
		icon = GFX_decision_artillery
		available = {
			has_completed_focus = QIE_buymauser
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@anti_air_equipment > 0 }

				set_temp_variable = { QIE_anti_air_ratio = num_equipment_in_armies@anti_air_equipment }
				divide_temp_variable = { QIE_anti_air_ratio = num_target_equipment_in_armies@anti_air_equipment }

				set_temp_variable = { QIE_purchase_anti_air_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_anti_air_factor = QIE_anti_air_ratio }
				multiply_temp_variable = { QIE_purchase_anti_air_factor = 20 }

				add = QIE_purchase_anti_air_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_4_MARKS
		custom_cost_trigger = {
			market_liberal < 0.96
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_anti_air"
			add_equipment_to_stockpile = {
				type = anti_air_equipment_1
				amount = 500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.04
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_light_tanks = { #purchase German light tanks
		icon = GFX_decision_tank
		available = {
			has_completed_focus = QIE_motorized_armor
		}

		fire_only_once = no
		days_remove = 60
		days_re_enable = 180

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@light_tank_equipment > 0 }

				set_temp_variable = { QIE_light_tank_ratio = num_equipment_in_armies@light_tank_equipment }
				divide_temp_variable = { QIE_light_tank_ratio = num_target_equipment_in_armies@light_tank_equipment }

				set_temp_variable = { QIE_purchase_light_tank_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_light_tank_factor = QIE_light_tank_ratio }
				multiply_temp_variable = { QIE_purchase_light_tank_factor = 20 }

				add = QIE_purchase_light_tank_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_light_tanks"
			add_equipment_to_stockpile = {
				type = light_tank_equipment_1
				amount = 250
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_medium_tanks = { #purchase German medium tanks
		icon = GFX_decision_tank
		available = {
			has_completed_focus = QIE_motorized_armor
		}
		visible = {
			GER = { has_tech = basic_medium_tank }
		}

		fire_only_once = no
		days_remove = 60
		days_re_enable = 180

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@medium_tank_equipment > 0 }

				set_temp_variable = { QIE_medium_tank_ratio = num_equipment_in_armies@medium_tank_equipment }
				divide_temp_variable = { QIE_medium_tank_ratio = num_target_equipment_in_armies@medium_tank_equipment }

				set_temp_variable = { QIE_purchase_medium_tank_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_medium_tank_factor = QIE_medium_tank_ratio }
				multiply_temp_variable = { QIE_purchase_medium_tank_factor = 20 }

				add = QIE_purchase_medium_tank_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_medium_tanks"
			add_equipment_to_stockpile = {
				type = medium_tank_equipment_1
				amount = 250
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_motorized = { #purchase German motorized
		icon = GFX_decision_generic_motorized
		available = {
			has_completed_focus = QIE_motorized_armor
		}

		fire_only_once = no
		days_remove = 40
		days_re_enable = 120

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@motorized_equipment > 0 }

				set_temp_variable = { QIE_motorised_ratio = num_equipment_in_armies@motorized_equipment }
				divide_temp_variable = { QIE_motorised_ratio = num_target_equipment_in_armies@motorized_equipment }

				set_temp_variable = { QIE_purchase_motorised_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_motorised_factor = QIE_motorised_ratio }
				multiply_temp_variable = { QIE_purchase_motorised_factor = 20 }

				add = QIE_purchase_motorised_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_motorized"
			add_equipment_to_stockpile = {
				type = motorized_equipment_1
				amount = 500
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}

	QIE_buy_ger_armored_cars = {
		icon = GFX_decision_hol_attract_foreign_investors

		allowed = {
			has_dlc = "La Resistance"
		}

		available = {
			has_completed_focus = QIE_motorized_armor
		}

		fire_only_once = no
		days_remove = 40
		days_re_enable = 120

		ai_will_do = {
			base = 0
			modifier = {
				# avoid division by zero
				check_variable = { num_target_equipment_in_armies@armored_car_equipment > 0 }

				set_temp_variable = { QIE_armoured_car_ratio = num_equipment_in_armies@armored_car_equipment }
				divide_temp_variable = { QIE_armoured_car_ratio = num_target_equipment_in_armies@armored_car_equipment }

				set_temp_variable = { QIE_purchase_armoured_car_factor = 1 }
				subtract_from_temp_variable = { QIE_purchase_armoured_car_factor = QIE_armoured_car_ratio }
				multiply_temp_variable = { QIE_purchase_armoured_car_factor = 20 }

				add = QIE_purchase_armoured_car_factor
			}
			modifier = {
				set_temp_variable = { QIE_german_influence_negative_factor = party_popularity@market_liberal }
				multiply_temp_variable = { QIE_german_influence_negative_factor = -20 }

				add = QIE_german_influence_negative_factor
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_armored_cars"
			add_equipment_to_stockpile = {
				type = gw_armored_car_equipment
				amount = 200
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}

	QIE_buy_ger_fighter = { #purchase german fighters
		icon = GFX_decision_plane
		available = {
			has_completed_focus = QIE_luftwaffe
		}

		fire_only_once = no
		days_remove = 60
		days_re_enable = 180

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				stockpile_ratio = {
					archetype = fighter_equipment
					ratio < 0.75
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_fighter"
			add_equipment_to_stockpile = {
				type = fighter_equipment_1
				amount = 150
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_cas = { #purchase german CAS
		icon = GFX_decision_plane
		available = {
			has_completed_focus = QIE_luftwaffe
		}

		fire_only_once = no
		days_remove = 60
		days_re_enable = 180

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				stockpile_ratio = {
					archetype = CAS_equipment
					ratio < 0.75
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_cas"
			add_equipment_to_stockpile = {
				type = CAS_equipment_1
				amount = 150
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_buy_ger_tac = { #purchase german tactical bombers
		icon = GFX_decision_bomber
		available = {
			has_completed_focus = QIE_luftwaffe
		}

		days_remove = 60
		days_re_enable = 180
		fire_only_once = no

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				stockpile_ratio = {
					archetype = tac_bomber_equipment
					ratio < 0.75
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_ger_tac"
			add_equipment_to_stockpile = {
				type = tac_bomber_equipment_0
				amount = 150
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_ger_destroyers = {
		icon = generic_naval
		available = {
			NOT = { has_war_with = JAP }
			has_completed_focus = QIE_kriegsmarine
		}

		fire_only_once = yes
		days_remove = 90

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_ger_destroyers"
			custom_effect_tooltip = QIE_ger_destroyers_tooltip
			hidden_effect = {
				load_oob = "QIE_ships1" #destroyer OOB
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.03
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_ger_subs = {
		icon = generic_naval
		available = {
			is_subject = no
			NOT = { has_war_with = JAP }
			has_country_flag = QIE_can_buy_german_ships
			has_completed_focus = QIE_kriegsmarine
			if = {
				limit = { has_dlc = "Man the Guns" }
				has_tech = early_ship_hull_submarine
			}
			else = {
				has_tech = early_submarine
			}
		}

		fire_only_once = yes
		days_remove = 150

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_8_MARKS
		custom_cost_trigger = {
			market_liberal < 0.92
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_ger_subs"
			custom_effect_tooltip = QIE_ger_subs_tooltip
			hidden_effect = {
				load_oob = "QIE_ships2" #submarine OOB
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.03
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_ger_cruisers = {
		icon = generic_naval
		available = {
			NOT = { has_war_with = JAP }
			has_completed_focus = QIE_kriegsmarine
		}
		fire_only_once = yes
		days_remove = 150
		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_10_MARKS
		custom_cost_trigger = {
			market_liberal < 0.9
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_ger_cruisers"
			custom_effect_tooltip = QIE_ger_cruisers_tooltip
			hidden_effect = {
				QIE_EVENT_EC01_naval_variant = yes
				load_oob = "QIE_ships3" #cruisers
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.05
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_ger_battleship = { # buy german battleship
		icon = generic_naval
		available = {
			NOT = { has_war_with = JAP }
			has_completed_focus = QIE_kriegsmarine
		}

		fire_only_once = yes
		days_remove = 150

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_10_MARKS
		custom_cost_trigger = {
			market_liberal < 0.9
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_ger_battleship"
			custom_effect_tooltip = QIE_battleship_tooltip
			hidden_effect = {
				load_oob = "QIE_ships4" #battleship
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.08
			}
			QIE_recalculate_peking_commission = yes
		}
	}
	QIE_ger_convoys = { # buy german convoys
		icon = generic_naval
		available = {
			NOT = { has_war_with = JAP }
			has_completed_focus = QIE_kriegsmarine
		}

		fire_only_once = no
		days_re_enable = 20
		days_remove = 50

		ai_will_do = {
			base = 0
			modifier = {
				add = 80
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
			modifier = {
				add = -100
				market_liberal > 0.25
			}
		}

		custom_cost_text = QIE_5_MARKS
		custom_cost_trigger = {
			market_liberal < 0.95
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_ger_convoys"
			add_equipment_to_stockpile = {
				type = convoy
				amount = 50
				producer = GER
			}
			add_popularity = {
				ideology = market_liberal
				popularity = 0.03
			}
			QIE_recalculate_peking_commission = yes
		}
	}
}

######################################
#Anti-Foreign Military Tree Decisions#
######################################

#hire mercenaries
QIE_hire_mercenaries_decisions = {
	QIE_hire_bandits = {
		icon = generic_industry

		fire_only_once = yes
		cost = 40
		days_remove = 15

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				enemies_strength_ratio > 0.75
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_hire_bandits"
			clr_country_flag = Liu_Zhenhua_dead
			custom_effect_tooltip = QIE_bandits_hired
			hidden_effect = {
				load_oob = "QIE_bandit_merc"
				country_event = {
					id = qieflavor.8
					days = 32
				}
			}
		}
	}
	QIE_hire_russian_cw_veterans = {
		icon = generic_industry

		fire_only_once = yes
		cost = 50
		days_remove = 35

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_hire_russian_cw_veterans"
			army_experience = 15
			add_tech_bonus = {
				name = QIE_hire_russian_cw_veterans
				bonus = 1
				uses = 1
				category = land_doctrine
			}
		}
	}
	QIE_hire_legation_exiles = {
		icon = generic_industry

		fire_only_once = yes
		cost = 50
		days_remove = 35

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_hire_legation_exiles"
			navy_experience = 15
			add_tech_bonus = {
				name = QIE_hire_legation_exiles
				bonus = 1
				uses = 1
				category = cat_trade_interdiction
			}
		}
	}
	QIE_hire_flying_tigers = {
		icon = generic_industry
		visible = {
			has_completed_focus = QIE_zhili_mercs
			has_global_flag = USA_TEX_existed
			NOT = { country_exists = TEX }
		}

		fire_only_once = yes
		cost = 45
		days_remove = 60

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_hire_flying_tigers"
			air_experience = 30
			add_tech_bonus = {
				name = QIE_hire_flying_tigers
				bonus = 1
				uses = 1
				category = air_doctrine
			}
		}
	}
}

#buy foreign guns
QIE_buy_foreign_guns_decisions = {
	QIE_buy_small_arms = {  #czech guns
		icon = generic_prepare_civil_war

		visible = {
			OR = {
				country_exists = CZE
				AND = {
					country_exists = AUS
					AUS = { owns_state = 9 }
				}
			}
			NOT = {
				has_war_with = CZE
				has_war_with = AUS
				has_war_with = GER
			}
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90
		cost = 50

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				stockpile_ratio = {
					archetype = infantry_equipment
					ratio < 0.75
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_small_arms"
			set_country_flag = QIE_bought_foreign_guns
			if = {
				limit = { country_exists = CZE }
				add_equipment_to_stockpile = {
					type = infantry_equipment_1
					amount = 2500
					producer = CZE
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = infantry_equipment_1
					amount = 2500
					producer = AUS
				}
			}
		}
	}
	QIE_retroengineer_small_arms = { #gives bonus
		icon = generic_prepare_civil_war

		available = {
			has_country_flag = QIE_bought_foreign_guns
		}

		fire_only_once = yes
		days_remove = 65
		cost = 75

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_retroengineer_small_arms"
			clr_country_flag = QIE_bought_foreign_guns
			add_tech_bonus = {
				name = QIE_retroengineer_small_arms
				bonus = 1
				uses = 1
				category = infantry_weapons
			}
		}
	}
	QIE_buy_support_equipment = { #buy danish MGs
		icon = generic_prepare_civil_war

		visible = {
			country_exists = DEN
			NOT = {
				has_war_with = DEN
				has_war_with = GER
			}
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90
		cost = 50

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				stockpile_ratio = {
					archetype = support_equipment
					ratio < 0.75
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_support_equipment"
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 500
				producer = DEN
			}
		}
	}
	QIE_buy_arty = { #buy arty
		icon = ger_military_buildup

		visible = {
			country_exists = AUS
			NOT = {
				has_war_with = AUS
				has_war_with = GER
			}
		}

		fire_only_once = no
		days_remove = 30
		days_re_enable = 90
		cost = 50

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				stockpile_ratio = {
					archetype = artillery_equipment
					ratio < 0.75
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_buy_arty"
			add_equipment_to_stockpile = {
				type = artillery_equipment_1
				amount = 500
				producer = AUS
			}
		}
	}
}

#comission navy from Sicily
QIE_comission_sicilian_ships = {
	QIE_sic_destroyers = {
		icon = generic_naval

		fire_only_once = yes
		days_remove = 200
		cost = 100

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_sic_destroyers"
			custom_effect_tooltip = QIE_sic_destroyers_tooltip
			hidden_effect = {
				load_oob = "QIE_ships1" #destroyer OOB
			}
		}
	}
	QIE_sic_subs = {
		icon = generic_naval
		available = {
			is_subject = no
			NOT = {
				has_war_with = JAP
			}
			if = {
				limit = { has_dlc = "Man the Guns" }
				has_tech = early_ship_hull_submarine
			}
			else = {
				has_tech = early_submarine
			}
		}

		fire_only_once = yes
		days_remove = 200
		cost = 150

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_sic_subs"
			custom_effect_tooltip = QIE_sic_subs_tooltip
			hidden_effect = {
				load_oob = "QIE_ships2" #submarine OOB
			}
		}
	}
	QIE_sic_cruisers = {
		icon = generic_naval
		allowed = { tag = QIE }
		available = {
			is_subject = no
			NOT = {
				has_war_with = JAP
			}
		}
		visible = {
			has_completed_focus = QIE_siciliyships
		}
		fire_only_once = yes
		days_remove = 200
		cost = 150

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_sic_cruisers"
			custom_effect_tooltip = QIE_sic_cruisers_tooltip
			hidden_effect = {
				QIE_EVENT_EC01_naval_variant = yes
				load_oob = "QIE_ships3" #cruisers
			}
		}
	}
	QIE_sic_convoys = {
		icon = generic_naval

		fire_only_once = yes
		days_remove = 100
		cost = 50

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				naval_strength_ratio = {
					tag = JAP
					ratio = 0.35
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_sic_convoys"
			add_equipment_to_stockpile = {
				type = convoy
				amount = 25
				producer = SIC
			}
		}
	}
}

#yiguandao decisions

QIE_yiguandao_decisions_category = {
	QIE_raise_yiguandao_militia = {
		icon = generic_prepare_civil_war

		fire_only_once = no
		days_re_enable = 75
		days_remove = 30

		ai_will_do = {
			factor = 15
			modifier = {
				add = 100
				enemies_strength_ratio > 0.75
			}
			modifier = {
				add = -100
				national_populist > 0.25
			}
		}

		visible = {
			NOT = {
				has_government = national_populist
			}
		}

		custom_cost_text = QIE_5_YIGUANDAO
		custom_cost_trigger = {
			check_variable = { party_popularity@national_populist < 0.95 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_raise_yiguandao_militia"
			custom_effect_tooltip = QIE_yiguandao_militia_TT
			hidden_effect = {
				add_popularity = {
					ideology = national_populist
					popularity = 0.05
				}
				QIE_recalculate_yiguandao_influence = yes
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_raise_yiguandao_militia"
			hidden_effect = {
				if = {
					limit = { NOT = { has_template = "Yiguandao Minbing" } }
					division_template = {
						name = "Yiguandao Minbing"
						#division_names_group = "QIE_MIL_01"
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 0 y = 3 }
							infantry = { x = 0 y = 4 }
						}
						template_counter = 68
					}
				}
				random_owned_controlled_state = {
					prioritize = { 608 }
					create_unit = {
						division = "name = \"Yiguandao Minbing Dadui\" division_template = \"Yiguandao Minbing\" start_experience_factor = 1.0"
						allow_spawning_on_enemy_provs = no
						prioritize_location = 7160
						owner = ROOT
					}
				}
				random_owned_controlled_state = {
					prioritize = { 608 }
					create_unit = {
						division = "name = \"Yiguandao Minbing Dadui\" division_template = \"Yiguandao Minbing\" start_experience_factor = 1.0"
						allow_spawning_on_enemy_provs = no
						prioritize_location = 7160
						owner = ROOT
					}
				}
			}
		}
	}
	QIE_refugee_workforce = {
		icon = generic_agreement

		fire_only_once = yes
		days_remove = 180
		days_re_enable = 365

		ai_will_do = {
			factor = 50
			modifier = {
				add = -100
				national_populist > 0.25
			}
		}

		visible = {
			NOT = { has_government = national_populist }
		}

		custom_cost_text = QIE_4_YIGUANDAO
		custom_cost_trigger = {
			check_variable = { party_popularity@national_populist < 0.96 }
		}

		highlight_state_targets = {
			state = 608 #Jingzhao
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_refugee_workforce target: [From.GetName]"
			608 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_refugee_workforce target: [From.GetName]"
			hidden_effect = {
				add_popularity = {
					ideology = national_populist
					popularity = 0.04
				}
				QIE_recalculate_yiguandao_influence = yes
			}
		}
	}
	QIE_yiguandao_infiltraitors = {
		icon = generic_prepare_civil_war
		available = {
			has_war = yes
		}

		fire_only_once = no
		days_remove = 200

		custom_cost_text = QIE_3_YIGUANDAO
		custom_cost_trigger = {
			check_variable = { party_popularity@national_populist < 0.97 }
		}

		ai_will_do = {
			factor = 50
			modifier = {
				add = -100
				national_populist > 0.3
			}
		}

		modifier = {
			recon_factor = 0.075
			resistance_growth_on_our_occupied_states = 0.075
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_yiguandao_infiltraitors"
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_yiguandao_infiltraitors"
			hidden_effect = {
				add_popularity = {
					ideology = national_populist
					popularity = 0.03
				}
				QIE_recalculate_yiguandao_influence = yes
			}
		}
	}
	QIE_hold_prayer_meeting = {
		icon = generic_agreement
		available = {
			has_war = yes
		}

		fire_only_once = no
		days_re_enable = 60

		ai_will_do = {
			factor = 100
			modifier = {
				add = -200
				national_populist > 0.25
			}
		}

		custom_cost_text = QIE_2_YIGUANDAO
		custom_cost_trigger = {
			check_variable = { party_popularity@national_populist < 0.98 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_hold_prayer_meeting"
			add_war_support = 0.05
			add_political_power = 25
			add_stability = 0.05
			hidden_effect = {
				add_popularity = {
					ideology = national_populist
					popularity = 0.02
				}
				QIE_recalculate_yiguandao_influence = yes
			}
		}
	}
	QIE_arrest_yiguandao_priest = {
		icon = generic_agreement

		ai_will_do = {
			base = 0
			modifier = {
				add = 50
				national_populist > 0.10
			}
			modifier = {
				add = 100
				national_populist > 0.17
			}
		}

		visible = {
			NOT = { has_government = national_populist }
		}

		custom_cost_text = QIE_MINUS_5_YIGUANDAO
		custom_cost_trigger = {
			check_variable = { party_popularity@national_populist > 0.05 }
		}

		fire_only_once = no
		days_re_enable = 60

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_arrest_yiguandao_priest"
			add_political_power = -50
			hidden_effect = {
				add_popularity = {
					ideology = national_populist
					popularity = -0.05
				}
				QIE_recalculate_yiguandao_influence = yes
			}
		}
	}
}

#Zhili Foreign Policy
QIE_zhili_reunite_china_decisions_category = {
	QIE_prep_chahar = {
		icon = generic_industry

		visible = {
			num_of_civilian_factories_available_for_projects > 3
			MON = { owns_state = 621 }
		}

		fire_only_once = yes
		days_remove = 60

		modifier = {
			civilian_factory_use = 3
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_prep_chahar"
			611 = { #chahar
				add_building_construction = {
					type = bunker
					level = 2
					province = 952
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 10397
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 828
					instant_build = yes
				}
			}
			615 = {
				add_building_construction = {
					type = bunker
					level = 2
					province = 12432
					instant_build = yes
				}
			}
		}
	}
	QIE_reach_out_to_Yan = {
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { SHX }

		cost = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 100
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_Yan target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.147
					days = 3
				}
			}
		}
	}
	QIE_reach_out_to_lep = { #if intervene pro-LEP
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				has_completed_focus = LEP_government_by_coercion
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { LEP }
		target_root_trigger = {
			has_completed_focus = QIE_rebuild_alliance
		}
		target_trigger = {
			FROM = {
				has_completed_focus = LEP_government_by_coercion
				is_ruled_by_pro_zhili = yes
				is_subject = no
				is_in_faction = no
			}
		}

		cost = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 200
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_lep target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.16
					days = 3
				}
			}
		}
	}
	QIE_reach_out_to_hengti = { #zhao hengti is personal friend of wu peifu's
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { HNN }
		target_root_trigger = {
			has_completed_focus = QIE_rebuild_alliance
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		cost = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 100
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_hengti target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.4
					days = 1
				}
			}
		}
	}
	QIE_reach_out_to_song_if_zhili = {
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { SQI }
		target_root_trigger = {
			has_completed_focus = QIE_rebuild_alliance
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		fire_only_once = yes
		cost = 10

		ai_will_do = {
			factor = 200
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_song_if_zhili target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.4
					days = 1
				}
			}
		}
	}
	QIE_reach_out_to_sichuan = { #sichuan
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { SZC }
		target_root_trigger = {
			has_completed_focus = QIE_rebuild_alliance
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		cost = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 100
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_sichuan target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.5
					days = 1
				}
			}
		}
	}
	QIE_reach_out_to_mas = {
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { XSM }
		target_root_trigger = {
			has_completed_focus = QIE_fallout_of_northwest_conflict
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		fire_only_once = yes
		cost = 10

		ai_will_do = {
			factor = 50
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_mas target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.6
					days = 1
				}
			}
		}
	}
	QIE_reach_out_to_ma_ji = {
		icon = generic_agreement
		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}
		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { GXC }
		target_root_trigger = {
			has_completed_focus = QIE_rebuild_alliance
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		fire_only_once = yes
		cost = 10

		ai_will_do = {
			factor = 50
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_ma_ji target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.100
					days = 1
				}
			}
		}
	}
	QIE_request_LEP_support_during_FNG_war = {
		icon = generic_agreement
		visible = {
			has_war_with = FNG
			FROM = {
				exists = yes
				has_completed_focus = LEP_government_by_coercion
				is_ruled_by_pro_zhili = yes
				is_subject = no
				is_in_faction = no
			}
		}

		targets = { LEP }
		target_root_trigger = { has_war_with = FNG }
		target_trigger = {
			FROM = {
				has_completed_focus = LEP_government_by_coercion
				is_ruled_by_pro_zhili = yes
				is_subject = no
				is_in_faction = no
			}
		}

		fire_only_once = yes
		days_remove = 7
		cost = 0

		ai_will_do = {
			factor = 1000
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_request_LEP_support_during_FNG_war target: [From.GetName]"
			hidden_effect = {
				FNG = {
					country_event = lep.205
					set_country_flag = ger_intervention_ask
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_request_LEP_support_during_FNG_war target: [From.GetName]"
			FROM = {
				country_event = lep.201
			}
		}
	}
	QIE_kill_KUM_khan = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}
		visible = {
			can_declare_war_on = FROM
			FROM = {
				is_subject = no
				is_ruled_by_pro_zhili = no
			}
		}

		targets = { KUM }
		target_root_trigger = {
			has_completed_focus = QIE_looseends
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = {
				is_subject = no
				is_ruled_by_pro_zhili = no
			}
		}

		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		modifier = {
			command_power_gain = -0.10
		}

		ai_will_do = {
			factor = 25
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_kill_KUM_khan target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_kill_KUM_khan target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_rein_in_KUM_zhili = {
		icon = generic_agreement

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}

		visible = {
			FROM = {
				exists = yes
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		targets = { KUM SIK }
		target_root_trigger = {
			has_completed_focus = QIE_fallout_of_northwest_conflict
		}
		target_trigger = {
			FROM = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				is_subject = no
			}
		}

		cost = 10
		days_remove = 5
		fire_only_once = yes

		ai_will_do = {
			factor = 50
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_rein_in_KUM_zhili target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.4
				}
			}
		}
	}

	QIE_attack_warlord = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
			if = {
				limit = { FROM = { is_in_faction_with = FNG } }
				has_completed_focus = QIE_warofnationalresistance
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { same_alignment_as_QIE = no }
		}

		targets = { SHX SQI CHI GXC SZC YUN HNN ANQ LEP }
		target_root_trigger = {
			has_completed_focus = QIE_destroy_isolated_warlords
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { same_alignment_as_QIE = no }
		}

		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		modifier = {
			command_power_gain = -0.10
		}

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				FROM = {
					tag = SHX
					has_government = paternal_autocrat
				}
				NOT = {
					strength_ratio = { tag = FNG ratio > 0.8 }
					LEP = {
						OR = {
							is_guaranteed_by = QIE
							is_in_faction_with = QIE
						}
					}
					ANQ = {
						OR = {
							is_guaranteed_by = QIE
							is_in_faction_with = QIE
						}
					}
				}
			}
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_attack_warlord target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_attack_warlord target: [From.GetName]"
			if = {
				limit = {
					FROM = {
						tag = SHX
						has_government = paternal_autocrat
						NOT = { is_in_faction_with = FNG }
					}
				}
				country_event = qiefor.10
			}
			else = {
				declare_war_on = {
					target = FROM
					type = annex_everything
				}
			}
		}
	}

	QIE_zhili_kill_SIK = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = {
				is_subject = no
				is_ruled_by_pro_zhili = no
			}
		}

		targets = { SIK }
		target_root_trigger = {
			has_completed_focus = QIE_looseends
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = {
				is_subject = no
				is_ruled_by_pro_zhili = no
			}
		}

		fire_only_once = yes
		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		modifier = {
			command_power_gain = -0.10
		}

		ai_will_do = {
			factor = 25
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_zhili_kill_SIK target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_zhili_kill_SIK target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
}

QIE_anqing_diplomacy_decisions_category = {
	QIE_anq_visit_nanjing = {
		icon = generic_form_nation
		visible = {
			ANQ = {
				has_completed_focus = ANQ_relocate_to_nanjing
				exists = yes
			}
		}

		cost = 50
		fire_only_once = yes
		days_remove = 20
		ai_will_do = {
			factor = 25
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_visit_nanjing"
			ANQ = {
				country_event = {
					id = anq.87
					days = 2
				}
			}
		}
	}

	QIE_anq_wu_and_chen_decision = {
		icon = generic_form_nation
		visible = {
			check_variable = { ANQ.ANQ_beijing_level < 5 }
			ANQ = {
				has_completed_focus = ANQ_relocate_to_nanjing
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_two_tt
				check_variable = { ANQ.ANQ_beijing_level > 2 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 70
		fire_only_once = yes
		days_remove = 20

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_wu_and_chen_decision"
			ANQ = {
				custom_effect_tooltip = anq_increase_qie_2
				country_event = {
					id = anq.99
					days = 2
				}
			}
		}
	}

	QIE_anq_send_delegation = {
		icon = generic_form_nation
		visible = {
			check_variable = { ANQ.ANQ_beijing_level < 6 }
			has_country_flag = QIE_visited_puyi_nanjing #triggers 175 days after puyi visit
			ANQ = {
				has_completed_focus = ANQ_relocate_to_nanjing
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_two_tt
				check_variable = { ANQ.ANQ_beijing_level > 2 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 50
		fire_only_once = yes
		days_remove = 10

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_send_delegation"
			ANQ = { #public conference?
				country_event = {
					id = anq.101
					days = 2
				}
			}
		}
	}

	QIE_anq_organize_intellectual_meeting = {
		icon = generic_political_discourse
		visible = {
			check_variable = { ANQ.ANQ_beijing_level > 2 }
			ANQ = {
				has_completed_focus = ANQ_relocate_to_nanjing
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_four_tt
				check_variable = { ANQ.ANQ_beijing_level > 4 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 50
		fire_only_once = yes
		days_remove = 10

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_organize_intellectual_meeting"
			ANQ = {
				country_event = {
					id = anq.90
					days = 2
				}
			}
		}
	}

	QIE_anq_counter_message = {
		icon = generic_political_discourse

		allowed = { always = no } #manually activated

		cancel_trigger = {
			NOT = { country_exists = ANQ }
		}

		cost = 30
		days_remove = 10
		fire_only_once = yes

		selectable_mission = yes
		days_mission_timeout = 50

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout QIE_anq_counter_message"
			add_political_power = -20
			ANQ = {
				custom_effect_tooltip = anq_decrease_qie_1
				hidden_effect = {
					add_popularity = {
						ideology = market_liberal
						popularity = -0.01
					}
					ANQ_remove_beijing_spirit = yes
					ANQ_calculate_beijing_level = yes
					ANQ_add_beijing_spirit = yes
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_counter_message"
			ANQ = {
				custom_effect_tooltip = anq_increase_qie_1
				country_event = {
					id = anq.91
					days = 2
				}
			}
		}
	}

	QIE_anq_contact_anticoncessions_leaders = {
		icon = generic_political_discourse
		visible = {
			check_variable = { ANQ.ANQ_beijing_level > 1 }
			has_country_flag = QIE_anq_wu_has_met_chen
			ANQ = {
				has_completed_focus = ANQ_relocate_to_nanjing
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_four_tt
				check_variable = { ANQ.ANQ_beijing_level > 4 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 50
		fire_only_once = yes
		days_remove = 50

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_anq_contact_anticoncessions_leaders"
			country_event = {
				id = qiefor.78
				days = 2
			}
		}

	}

	QIE_reach_out_to_anqing_before = { #before conflict
		icon = generic_agreement
		visible = {
			has_completed_focus = QIE_rebuild_alliance
			NOT = {
				has_war_with = FNG
				has_war_with = JAP
				has_completed_focus = QIE_looseends
			}
			ANQ = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_four_tt
				check_variable = { ANQ.ANQ_beijing_level > 4 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 10
		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_anqing_before"
			custom_effect_tooltip = QIE_anqing_cant_ask_again_tt
			ANQ = {
				country_event = {
					id = qiefor.66
					days = 2
				}
			}
		}

	}

	QIE_reach_out_to_anqing_during = { #during
		icon = generic_agreement
		visible = {
			ANQ = {
				has_completed_focus = ANQ_five_stars_five_provinces
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
				exists = yes
			}
			OR = {
				has_war_with = FNG
				has_war_with = JAP
			}
		}

		ai_will_do = {
			factor = 200
		}

		cost = 0
		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_anqing_during"
			ANQ = {
				country_event = {
					id = qiefor.67
					days = 2
				}
			}
		}
	}

	QIE_reach_out_to_anqing_after = { #after
		icon = generic_agreement
		visible = {
			has_completed_focus = QIE_looseends
			ANQ = {
				is_ruled_by_pro_zhili = yes
				NOT = {
					is_in_faction = yes
					has_war_with = QIE
				}
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_seven_tt
				check_variable = { ANQ.ANQ_beijing_level > 7 }
			}
		}

		cost = 0
		days_remove = 50
		fire_only_once = yes
		ai_will_do = {
			factor = 25
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_anqing_after"
			ANQ = {
				country_event = {
					id = qiefor.68
					days = 2
				}
			}
		}
	}

	QIE_reach_out_to_anqing_after_again = { #after
		icon = generic_agreement
		visible = {
			has_completed_focus = QIE_looseends
			has_country_flag = QIE_anqing_refuses_after
			ANQ = {
				is_ruled_by_pro_zhili = yes
				NOT = {
					is_in_faction = yes
					has_war_with = QIE
				}
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_ten_tt
				check_variable = { ANQ.ANQ_beijing_level > 10 }
			}
		}

		cost = 0
		days_remove = 50
		fire_only_once = yes
		ai_will_do = {
			factor = 25
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_reach_out_to_anqing_after_again"
			ANQ = {
				country_event = {
					id = qiefor.68
					days = 2
				}
			}
		}
	}

	QIE_war_goal_anqing_for_refusal_faction = { #after
		icon = generic_agreement
		visible = {
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
			OR = {
				has_country_flag = QIE_anqing_refuses_during
				has_country_flag = QIE_anqing_refuses_after
			}
			can_declare_war_on = ANQ
			ANQ = {
				is_ruled_by_pro_zhili = yes
				is_in_faction = no
			}
		}

		available = {
			if = {
				limit = {
					NOT = { has_country_flag = QIE_anqing_refuses_after }
				}
				custom_trigger_tooltip = {
					tooltip = QIE_anqing_influence_lt_eight_tt
					check_variable = { ANQ.ANQ_beijing_level < 8 }
				}
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 0
		days_remove = 20
		fire_only_once = yes
		war_with_target_on_remove = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_war_goal_anqing_for_refusal_faction"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_war_goal_anqing_for_refusal_faction"
			declare_war_on = {
				target = ANQ
				type = annex_everything
			}
		}
	}

	QIE_anqing_attempt_training_again = {
		icon = generic_agreement
		visible = {
			NOT = {
				has_war_with = FNG
				has_war_with = JAP
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
			is_neighbor_of = ANQ
			has_country_flag = QIE_anqing_attempt_training_again_flag
			ANQ = {
				is_ruled_by_pro_zhili = yes
				exists = yes
				is_in_faction = yes
			}
		}

		cost = 15
		fire_only_once = yes
		ai_will_do = {
			factor = 25
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_anqing_attempt_training_again"
			ANQ = {
				country_event = {
					id = anq.93
					days = 3
				}
			}
			add_ideas = QIE_anqing_training
		}
	}

	QIE_integrate_anqing_before = { #before
		icon = generic_agreement

		available = {
			received_expeditionary_forces = { sender = ANQ value < 1 }
		}

		visible = {
			NOT = {
				has_war_with = FNG
				has_war_with = JAP
				has_completed_focus = QIE_looseends
			}
			ANQ = {
				is_ruled_by_pro_zhili = yes
				is_in_faction_with = QIE
				exists = yes
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = QIE_anqing_influence_mt_seven_tt
				check_variable = { ANQ.ANQ_beijing_level > 7 }
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 0
		days_remove = 30
		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_integrate_anqing_before"
			custom_effect_tooltip = QIE_anqing_ask_integration_warning_tt
			ANQ = {
				country_event = {
					id = qiefor.80
					days = 2
				}
			}
		}
	}

	QIE_integrate_anqing_after = { #after
		icon = generic_agreement
		allowed = { tag = QIE }

		available = {
			received_expeditionary_forces = { sender = ANQ value < 1 }
		}

		visible = {
			has_completed_focus = QIE_looseends
			ANQ = {
				is_ruled_by_pro_zhili = yes
				is_in_faction_with = QIE
				exists = yes
			}
		}

		available = {
			if = {
				limit = { date < 1941.1.1 }
				custom_trigger_tooltip = {
					tooltip = QIE_anqing_influence_mt_seven_tt
					check_variable = { ANQ.ANQ_beijing_level > 7 }
				}
			}
			else_if = {
				limit = { date < 1942.1.1 }
				custom_trigger_tooltip = {
					tooltip = QIE_anqing_influence_mt_five_tt
					check_variable = { ANQ.ANQ_beijing_level > 5 }
				}
			}
		}
		ai_will_do = {
			factor = 25
		}
		cost = 0
		days_remove = 50
		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_integrate_anqing_after"
			custom_effect_tooltip = QIE_anqing_ask_integration_warning_tt
			ANQ = {
				country_event = {
					id = qiefor.83
					days = 2
				}
			}
		}

	}

	QIE_integrate_anqing_after_again = { #after
		icon = generic_agreement
		allowed = { tag = QIE }

		available = {
			received_expeditionary_forces = { sender = ANQ value < 1 }
		}

		visible = {
			has_completed_focus = QIE_looseends
			ANQ = {
				has_country_flag = ANQ_refused_integration_qing_after
				is_ruled_by_pro_zhili = yes
				is_in_faction_with = QIE
				exists = yes
			}
		}

		available = {
			date > 1942.1.1
		}

		cost = 0
		days_remove = 50
		fire_only_once = yes
		ai_will_do = {
			factor = 25
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_integrate_anqing_after_again"
			ANQ = {
				country_event = {
					id = qiefor.83
					days = 2
				}
			}
		}
	}
}


#zhili_manchu_war
QIE_zhili_manchu_war_decisions_category = {
	QIE_push_to_yellow_river = {
		icon = generic_prepare_civil_war

		highlight_state_targets = {
			state = 615 #Eastern Shanxi
			state = 1060 #Hebei
			state = 1061 #Daming
			state = 1063 #Cangzhou
		}

		fire_only_once = yes
		cost = 25
		days_remove = 15

		modifier = {
			weekly_manpower = -50000
			command_power_gain = -0.25
		}

		ai_will_do = {
			factor = 640
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_push_to_yellow_river"
			1063 = { set_demilitarized_zone = no }
			1061 = { set_demilitarized_zone = no }
			615 = { set_demilitarized_zone = no }
			1060 = { set_demilitarized_zone = no }
			add_political_power = 50
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = -0.075
			}
			hidden_effect = {
				country_event = { id = qiecoup.25 }
			}
		}
	}

	QIE_assault_luoyang = {
		icon = generic_prepare_civil_war
		available = {
			1063 = { is_demilitarized_zone = no }
			1061 = { is_demilitarized_zone = no }
			615 = { is_demilitarized_zone = no }
			1060 = { is_demilitarized_zone = no }
		}

		highlight_state_targets = {
			state = 607 #Heluo
		}

		fire_only_once = yes
		cost = 25
		days_remove = 7

		modifier = {
			weekly_manpower = -55000
			command_power_gain = -0.25
		}

		ai_will_do = {
			factor = 640
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_assault_luoyang target: [From.GetName]"
			607 = { set_demilitarized_zone = no }
			add_political_power = 50
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = -0.075
			}
			hidden_effect = {
				country_event = { id = qiecoup.26 }
			}
		}
	}
	QIE_mop_up_south = {
		icon = generic_prepare_civil_war

		available = {
			607 = { is_demilitarized_zone = no }
		}

		highlight_state_targets = {
			state = 620 #Xiangyang
			state = 799 #Guanzhong
			state = 1058 #Ruyang
			state = 1059 #Kaifeng
		}

		fire_only_once = yes
		cost = 25
		days_remove = 14

		modifier = {
			weekly_manpower = -55000
			command_power_gain = -0.25
		}

		ai_will_do = {
			factor = 640
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_mop_up_south"
			799 = { set_demilitarized_zone = no }
			620 = { set_demilitarized_zone = no }
			1058 = { set_demilitarized_zone = no }
			1059 = { set_demilitarized_zone = no }
			add_political_power = 50
			add_popularity = {
				ideology = authoritarian_democrat
				popularity = -0.10
			}
			hidden_effect = {
				country_event = { id = qiecoup.27 }
			}
		}
	}
	QIE_final_push = {
		icon = generic_prepare_civil_war

		available = {
			799 = { is_demilitarized_zone = no }
			620 = { is_demilitarized_zone = no }
			1058 = { is_demilitarized_zone = no }
			1059 = { is_demilitarized_zone = no }
		}

		highlight_state_targets = {
			state = 1048 #Wuhan
		}

		fire_only_once = yes
		cost = 25
		days_remove = 7

		modifier = {
			weekly_manpower = -55000
			command_power_gain = -0.25
		}

		ai_will_do = {
			factor = 640
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_final_push target: [From.GetName]"
			1048 = { set_demilitarized_zone = no }
			add_political_power = 50
			add_popularity = {
				ideology = paternal_autocrat
				popularity = -1.00
			}
			hidden_effect = {
				country_event = { id = qiecoup.28 }
			}
		}
	}
}

QIE_manchu_reunite_china_decisions_category = {
	QIE_demand_sichuan_submit_to_authority = {
		icon = generic_prepare_civil_war

		available = {
			FROM = {
				at_peace_or_same_enemies_as_ROOT = yes
				custom_trigger_tooltip = {
					tooltip = QIE_SZC_is_unaligned
					is_in_faction = no
					NOT = { has_variable = SZC_alliance }
				}
			}
		}

		visible = {
			FROM = {
				exists = yes
				is_subject = no
				is_in_faction = no
				SZC_has_baoding_government = yes
			}
		}

		targets = { SZC }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}
		target_trigger = {
			FROM = {
				is_subject = no
				is_in_faction = no
				SZC_has_baoding_government = yes
			}
		}

		fire_only_once = yes
		cost = 10
		days_remove = 5

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_demand_sichuan_submit_to_authority target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_demand_sichuan_submit_to_authority target: [From.GetName]"
			FROM = { country_event = qiefor.38 }
		}
	}
	QIE_rein_in_KUM_manchu = {
		icon = generic_agreement

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}

		visible = {
			FROM = {
				exists = yes
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		targets = { KUM }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}
		target_trigger = {
			FROM = {
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		fire_only_once = yes
		cost = 10
		days_remove = 5

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_rein_in_KUM_manchu target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_rein_in_KUM_manchu target: [From.GetName]"
			FROM = { country_event = qiefor.4 }
		}
	}

	QIE_demand_mas_submit_to_authority = {
		icon = generic_prepare_civil_war

		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}

		visible = {
			FROM = {
				exists = yes
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		targets = { XSM }
		target_root_trigger = {
			has_completed_focus = QIE_demand_fealty
		}
		target_trigger = {
			FROM = {
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		fire_only_once = yes
		cost = 10
		days_remove = 5

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_demand_mas_submit_to_authority target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_demand_mas_submit_to_authority target: [From.GetName]"
			FROM = { country_event = qiefor.39 }
		}
	}

	QIE_demand_shandong_submit_to_authority = { #if SQI is AuthDem and didn't help with the coup
		icon = generic_prepare_civil_war

		available = {
			FROM = { at_peace_or_same_enemies_as_ROOT = yes }
		}

		visible = {
			FROM = {
				exists = yes
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		targets = { SQI }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}
		target_trigger = {
			FROM = {
				is_subject = no
				is_in_faction = no
				is_ruled_by_pro_manchu = yes
			}
		}

		fire_only_once = yes
		cost = 10
		days_remove = 5

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_demand_shandong_submit_to_authority target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_demand_shandong_submit_to_authority target: [From.GetName]"
			FROM = { country_event =  qiefor.40 }
		}
	}

	QIE_prepare_national_pacification_campaign = {
		icon = generic_prepare_civil_war

		visible = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}

		fire_only_once = yes
		cost = 50
		days_remove = 15

		modifier = {
			command_power_gain = -0.50
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_prepare_national_pacification_campaign"
			army_experience = 15
			FNG = {
				country_event = {
					id = qiefor.52
					hours = 6
				}
			}
			if = {
				limit = {
					country_exists = LEP
					country_exists = GEA
					GEA = { has_capitulated = no }
				}
				GEA = {
					country_event = {
						id = qiefor.55
						hours = 6
					}
				}
			}
			hidden_effect = {
				random_other_country = {
					limit = { is_ai = yes }
					news_event = { id = worldnews.234 hours = 2 }
				}
			}
			set_country_flag = reunification_war_prepped
		}
	}

	QIE_prepare_western_thrust = {
		icon = generic_prepare_civil_war

		available = {
			has_country_flag = reunification_war_prepped
		}

		visible = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}

		fire_only_once = yes
		cost = 30
		days_remove = 30

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_prepare_western_thrust"
			799 = {
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			if = {
				limit = {
					OR = {
						is_in_faction_with = SHX
						has_country_flag = QIE_yan_backs_coup
						has_country_flag = QIE_yan_in_government
					}
				}
				622 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
				1015 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			}
			else = {
				615 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
				607 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			}
			set_country_flag = prepped_for_western_attacks
		}
	}
	QIE_manchu_attack_west = {
		name = QIE_manchu_attack_decision
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
			if = {
				limit = {
					FROM = { is_guaranteed_by = FNG }
				}
				NOT = { can_declare_war_on = FNG }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_ruled_by_pro_manchu = no }
		}

		cancel_trigger = {
			OR = {
				NOT = { can_declare_war_on = FROM }
				AND = {
					FROM = { is_guaranteed_by = FNG }
					can_declare_war_on = FNG
				}
			}
		}

		targets = { SHX XSM SIK KUM }
		target_root_trigger = {
			has_country_flag = prepped_for_western_attacks
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { is_ruled_by_pro_manchu = no }
		}

		cost = 30
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_manchu_attack_west target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			if = {
				limit = {
					FROM = {
						tag = XSM
						is_subject = no
						is_in_faction = no
					}
					country_exists = FNG
					FNG = { is_subject = no }
				}
				FROM = {
					country_event = {
						id = qiefor.11
						days = 2
					}
				}
			}
			else = {
				QIE_incoming_attack_notification = yes
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_manchu_attack_west target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}

	QIE_prepare_southern_thrust = {
		icon = generic_prepare_civil_war

		available = {
			has_country_flag = reunification_war_prepped
		}

		visible = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}

		fire_only_once = yes
		cost = 30
		days_remove = 30

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_prepare_southern_thrust"
			620 = {
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			1048 = {
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			set_country_flag = prepped_for_southern_attacks
		}
	}
	QIE_manchu_attack_south = {
		name = QIE_manchu_attack_decision
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_ruled_by_pro_manchu = no }
		}

		targets = { HNN SZC YUN GXC }
		target_root_trigger = {
			has_country_flag = prepped_for_southern_attacks
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = {
				is_ruled_by_pro_manchu = no
			}
		}

		cost = 30
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_manchu_attack_south target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_manchu_attack_south target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}

	QIE_prepare_eastern_thrust = {
		icon = generic_prepare_civil_war
		available = {
			has_country_flag = reunification_war_prepped
		}
		visible = {
			OR = {
				has_completed_focus = QIE_imperial_consolidation
				has_completed_focus = QIE_demand_fealty
			}
		}

		fire_only_once = yes
		cost = 30
		days_remove = 30

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_prepare_eastern_thrust"
			1058 = {
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			1059 = {
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			set_country_flag = prepped_for_eastern_attacks
		}
	}
	QIE_manchu_attack_east = {
		name = QIE_manchu_attack_decision
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_ruled_by_pro_manchu = no }
		}

		targets = { SQI ANQ LEP }
		target_root_trigger = {
			has_country_flag = prepped_for_eastern_attacks
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { is_ruled_by_pro_manchu = no }
		}

		cost = 30
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 200
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_manchu_attack_east target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_manchu_attack_east target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
			#space for JAP/GER events
		}
	}

	QIE_manchu_attack_KMT = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
		}

		targets = { CHI }
		target_root_trigger = {
			has_country_flag = reunification_war_prepped
		}
		target_trigger = {
			can_declare_war_on = FROM
		}

		cost = 30
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 200
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_manchu_attack_KMT target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_manchu_attack_KMT target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_manchu_attack_fengtian = {
		icon = generic_prepare_civil_war
		visible = {
			can_declare_war_on = FROM
		}

		targets = { FNG }
		target_root_trigger = { has_completed_focus = QIE_false_republic }
		target_trigger = {
			can_declare_war_on = FROM
		}

		cost = 30
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_manchu_attack_fengtian target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
			hidden_effect = {
				JAP = { country_event = qiefor.133 }
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_manchu_attack_fengtian target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
			#space for JAP events
		}
	}
}

QIE_northwest_conflict_decisions_category = {
	QIE_send_guns_to_mas = {
		icon = generic_agreement

		available = {
			has_equipment = { infantry_equipment > 49 }
		}

		visible = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		targets = { XSM }
		target_root_trigger = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
		}
		target_trigger = {
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		custom_cost_text = CP_25
		custom_cost_trigger = {
			command_power > 25
		}

		days_remove = 7
		days_re_enable = 30

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
				stockpile_ratio = {
					archetype = infantry_equipment
					ratio < 1
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_send_guns_to_mas target: [From.GetName]"
			hidden_effect = {
				add_command_power = -25
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_send_guns_to_mas target: [From.GetName]"
			send_equipment = {
				type = infantry_equipment_1
				amount = 200
				target = FROM
			}
			FROM = {
				country_event = {
					id = qiefor.17
				}
			}
		}
	}
	QIE_send_heavy_equip_to_mas = {
		icon = generic_agreement

		available = {
			has_equipment = { support_equipment > 49 }
			has_equipment = { artillery_equipment > 49 }
		}

		visible = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		targets = { XSM }
		target_root_trigger = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
		}
		target_trigger = {
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		custom_cost_trigger = {
			command_power > 25
		}
		custom_cost_text = CP_25

		days_remove = 7
		days_re_enable = 30

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
				OR = {
					stockpile_ratio = {
						archetype = artillery_equipment
						ratio < 1
					}
					stockpile_ratio = {
						archetype = support_equipment
						ratio < 1
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_send_heavy_equip_to_mas target: [From.GetName]"
			hidden_effect = {
				add_command_power = -25
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_send_heavy_equip_to_mas target: [From.GetName]"
			send_equipment = {
				equipment = artillery_equipment_1
				amount = 50
				target = FROM
			}
			send_equipment = {
				equipment = support_equipment_1
				amount = 50
				target = FROM
			}
			FROM = {
				country_event = {
					id = qiefor.17
				}
			}
		}
	}
	QIE_send_manpower_to_mas = {
		icon = generic_agreement

		available = {
			has_manpower > 50000
		}

		visible = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		targets = { XSM }
		target_root_trigger = {
			has_global_flag = northwest_conflict_begun
			NOT = { has_global_flag = northwest_conflict_ended }
		}
		target_trigger = {
			FROM = {
				OR = {
					has_war_with = MON
					has_war_with = TIB
				}
			}
		}

		custom_cost_text = CP_25
		custom_cost_trigger = {
			command_power > 25
		}

		days_remove = 7
		fire_only_once = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_manpower < 200000
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_send_manpower_to_mas target: [From.GetName]"
			add_manpower = -50000
			hidden_effect = {
				add_command_power = -25
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_send_manpower_to_mas target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.18
				}
			}
		}
	}
}

foreign_politics = {
	QIE_fng_supports_yan_unless_we_win_fast = {
		icon = GFX_decision_fengtian

		allowed = { always = no } #manually activated

		available = {
			NOT = { country_exists = SHX }
		}

		cancel_trigger = {
			OR = {
				has_war_with = FNG
				NOT = {
					FNG = { can_declare_war_on = ROOT }
				}
			}
		}

		is_good = no
		fire_only_once = yes
		days_mission_timeout = 115

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_fng_supports_yan_unless_we_win_fast"
			#FNG EVENT - FAILED TO PROTECT SHX
		}

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout QIE_fng_supports_yan_unless_we_win_fast"
			effect_tooltip = {
				FNG = {
					add_to_war = {
						targeted_alliance = SHX
						enemy = ROOT
					}
				}
			}
		}
	}
	QIE_fng_supports_yan_unless_we_win_fast_FNG_version = {
		icon = GFX_decision_fengtian

		allowed = { always = no }

		available = {
			NOT = { country_exists = SHX }
		}

		is_good = yes
		fire_only_once = yes
		days_mission_timeout = 115

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_fng_supports_yan_unless_we_win_fast_FNG_version"
			#FNG EVENT - FAILED TO PROTECT SHX
		}

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout QIE_fng_supports_yan_unless_we_win_fast_FNG_version"
			declare_war_on = {
				target = QIE
				type = annex_everything
			}
		}
	}
}

QIE_dam_breaching_decisions_category = {
	QIE_relocate_civilians_out_of_danger_area = {
		icon = generic_political_discourse
		available = {
			has_war = no
		}

		fire_only_once = yes
		cost = 150
		days_remove = 90

		ai_will_do = { factor = 100 }

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_relocate_civilians_out_of_danger_area"
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_relocate_civilians_out_of_danger_area"
			add_stability = 0.025
			set_country_flag = civilians_relocated
			custom_effect_tooltip = civilians_relocated_TT
		}
	}
	QIE_breach_dams_channel_water_north = {
		icon = generic_ignite_civil_war

		available = {
			has_war = yes
			1059 = { is_fully_controlled_by = ROOT } #OTL dam breached was in Zhengzhou - no reason to change really
			NOT = { has_country_flag = breached_dams_so_water_goes_south }
		}

		fire_only_once = yes
		cost = 25
		days_remove = 14

		highlight_provinces = {
			1139
			7074
			4144
			4114
			1169
			7092
			11962
			7160
			9987
			11933
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 1000
				surrender_progress > 0
				alliance_strength_ratio < 0.6
				count_triggers = {
					amount = 2
					1062 = { #Baoding
						controller = { has_war_with = ROOT }
					}
					1063 = { #Cangzhou
						controller = { has_war_with = ROOT }
					}
					615 = { #Eastern Shanxi
						controller = { has_war_with = ROOT }
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_breach_dams_channel_water_north"
			set_country_flag = breached_dams_so_water_goes_north
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_breach_dams_channel_water_north"
			1060 = {
				add_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 1139
						id = 7074
						id = 4144
						id = 4114
					}
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
			}
			1061 = {
				add_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 1169
						id = 7160
						id = 7092
						id = 9987
						id = 11933
						id = 11962
					}
				}
				damage_building = {
					type = infrastructure
					damage = 3
				}
				damage_building = {
					type = industrial_complex
					damage = 0.5
				}
			}
			if = {
				limit = {
					has_country_flag = civilians_relocated
				}
				add_stability = -0.05
			}
			else = {
				add_stability = -0.20
				add_political_power = -200
			}
			hidden_effect = {
				FNG = {
					country_event = {
						id = fengtian.252
						days = 1
					}
				}
			}
		}
	}
	QIE_breach_dams_channel_water_south = {
		icon = generic_ignite_civil_war

		available = {
			has_war = yes
			1059 = { is_fully_controlled_by = ROOT } #OTL dam breached was in Zhengzhou - no reason to change really
			NOT = { has_country_flag = breached_dams_so_water_goes_north }
		}

		fire_only_once = yes
		cost = 25
		days_remove = 14

		highlight_provinces = {
			4010
			4066
			7085
			7126
			7129
			7540
			7656
			9995
			10098
			10364
			12012
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 1000
				surrender_progress > 0
				alliance_strength_ratio < 0.6
				count_triggers = {
					amount = 2
					597 = { #Jinan
						controller = { has_war_with = ROOT }
					}
					1047 = { #Xuhai
						controller = { has_war_with = ROOT }
					}
					1050 = { #Huaisi
						controller = { has_war_with = ROOT }
					}
					1058 = { #Ruyang
						controller = { has_war_with = ROOT }
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_breach_dams_channel_water_south"
			set_country_flag = breached_dams_so_water_goes_south
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_breach_dams_channel_water_south"
			1059 = {
				add_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 4010
						id = 4066
						id = 7085
						id = 7126
						id = 7129
						id = 7540
						id = 7656
						id = 9995
						id = 10098
						id = 10364
						id = 12012
					}
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
				damage_building = {
					type = arms_factory
					damage = 0.75
				}
				damage_building = {
					type = industrial_complex
					damage = 0.75
				}
			}
			if = {
				limit = {
					has_country_flag = civilians_relocated
				}
				add_stability = -0.05
			}
			else = {
				add_stability = -0.20
				add_political_power = -200
			}
			hidden_effect = {
				FNG = {
					country_event = {
						id = fengtian.252
						days = 1
					}
				}
			}
		}
	}
	QIE_rebuild_from_flood_damage_kaifeng = {
		icon = generic_industry

		available = {
			has_war = no
			1059 = { is_fully_controlled_by = ROOT } #OTL dam breached was in Zhengzhou - no reason to change really
			has_country_flag = breached_dams_so_water_goes_south
		}

		visible = {
			QIE = { has_country_flag = breached_dams_so_water_goes_south }
		}

		fire_only_once = yes
		cost = 100
		days_remove = 200

		highlight_state_targets = { state = 1059 } #kaifeng

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_rebuild_from_flood_damage_kaifeng target: [From.GetName]"
			1059 = {
				remove_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 4010
						id = 4066
						id = 7085
						id = 7126
						id = 7129
						id = 7540
						id = 7656
						id = 9995
						id = 10098
						id = 10364
						id = 12012
					}
				}
			}
		}
	}
	QIE_rebuild_from_flood_damage_north = {
		icon = generic_industry

		available = {
			has_war = no
			1060 = { is_fully_controlled_by = ROOT }
			1061 = { is_fully_controlled_by = ROOT }
			has_country_flag = breached_dams_so_water_goes_north
		}

		visible = {
			QIE = { has_country_flag = breached_dams_so_water_goes_north }
		}

		fire_only_once = yes
		cost = 100
		days_remove = 200

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_rebuild_from_flood_damage_north"
			1060 = {
				remove_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 1139
						id = 7074
						id = 4144
						id = 4114
					}
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
			}
			1061 = {
				remove_province_modifier = {
					static_modifiers = { flooded }
					province = {
						id = 1169
						id = 7160
						id = 7092
						id = 9987
						id = 11933
						id = 11962
					}
				}
			}
		}
	}
}

QIE_endgame_FP_decisions_category = {
	QIE_integrate_tibet = {
		icon = generic_agreement

		available = {
			has_war = no
			received_expeditionary_forces = { sender = FROM value < 1 }
		}

		visible = {
			has_non_aggression_pact_with = FROM
			is_neighbor_of = FROM
			FROM = {
				has_government = authoritarian_democrat
			}
		}

		targets = { TIB }
		target_trigger = {
			has_non_aggression_pact_with = FROM
			is_neighbor_of = FROM
			FROM = {
				has_government = authoritarian_democrat
			}
		}

		fire_only_once = yes
		cost = 10

		ai_will_do = {
			factor = 320
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_integrate_tibet target: [From.GetName]"
			country_event = qiefor.44
		}
	}
	QIE_destroy_mongolia = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}

		targets = { MON }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}
		target_trigger = {
			can_declare_war_on = FROM
		}

		fire_only_once = yes
		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 25
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				MON_protected_by_russia_FROM = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_destroy_mongolia target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_destroy_mongolia target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_destroy_tibet = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}

		targets = { TIB }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}
		target_trigger = {
			can_declare_war_on = FROM
		}

		fire_only_once = yes
		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 25
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_destroy_tibet target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_destroy_tibet target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_destroy_uyghurs = { #winnie the pooh wants to know your location
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}

		targets = { ETS }
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
		}
		target_trigger = {
			can_declare_war_on = FROM
		}

		fire_only_once = yes
		cost = 10
		days_remove = 20
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 25
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio < 0.7
				}
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_destroy_uyghurs target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 21 value = 1 }
			QIE_incoming_attack_notification = yes
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_destroy_uyghurs target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}

	QIE_integrate_faction_members = {
		icon = generic_agreement

		available = {
			is_neighbor_of = FROM
			received_expeditionary_forces = { sender = FROM value < 1 }
		}

		visible = {
			is_faction_leader = yes
			FROM = { is_ally_with = ROOT }
		}

		target_array = faction_members
		target_array = subjects
		target_root_trigger = {
			OR = {
				has_completed_focus = QIE_looseends
				has_completed_focus = QIE_we_win
			}
			is_faction_leader = yes
		}
		target_trigger = {
			FROM = { can_become_china = yes }
		}

		cost = 50
		days_remove = 40

		modifier = {
			political_power_cost = 0.1
		}

		ai_will_do = {
			factor = 1000
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_integrate_faction_members target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.49
					hours = 12
				}
			}
		}
	}
	QIE_integrate_LEC = {
		icon = generic_agreement

		available = {
			received_expeditionary_forces = { sender = FROM value < 1 }
		}

		visible = {
			is_in_faction_with = FROM
			has_country_flag = lec_integration_ready
		}

		targets = { LEC }
		target_root_trigger = {
			has_country_flag = lec_integration_ready
		}
		target_trigger = {
			FROM = {
				is_in_faction_with = ROOT
			}
		}

		cost = 50
		days_remove = 40
		fire_only_once = yes

		modifier = {
			political_power_cost = 0.1
		}

		ai_will_do = {
			factor = 1000
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_integrate_LEC target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.49
					hours = 12
				}
			}
		}
	}
	QIE_sieze_macau = {
		icon = generic_prepare_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
			FROM = { has_war = yes }
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { owns_state = 729 }
		}

		targets = { POR }
		target_root_trigger = { has_country_flag = QIE_concession_decisions_unlocked }
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { owns_state = 729 }
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes
		war_with_target_on_remove = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_sieze_macau target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 15 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_sieze_macau target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.50
					hours = 6
				}
			}
		}
	}
	QIE_negotiate_with_LEC = {
		icon = generic_agreement

		visible = {
			is_neighbor_of = FROM
			FROM = {
				OR = {
					has_country_leader = {
						name = "Nelson T. Johnson"
						ruling_only = yes
					}
					AND = {
						has_government = paternal_autocrat
						ROOT = { has_country_flag = wu_intervenes_proLEP }
					}
				}
			}
		}

		cost = 10
		fire_only_once = yes

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				has_war = yes
			}
		}

		targets = { LEC }
		target_root_trigger = { has_country_flag = QIE_concession_decisions_unlocked }
		target_trigger = {
			is_neighbor_of = FROM
			FROM = {
				OR = {
					has_country_leader = {
						name = "Nelson T. Johnson"
						ruling_only = yes
					}
					AND = {
						has_government = paternal_autocrat
						ROOT = { has_country_flag = wu_intervenes_proLEP }
					}
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_negotiate_with_LEC target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.114
					days = 1
				}
			}
		}
	}

	QIE_attack_entente_LEC = {
		icon = generic_ignite_civil_war

		available = {
			is_neighbor_of = FROM
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_in_faction_with = ENT }
		}

		cost = 10
		days_remove = 15
		fire_only_once = yes
		war_with_target_on_remove = yes

		ai_will_do = {
			base = 0
			modifier = {
				add = 100 #Invaded directly
				ENT = {
					any_enemy_country = {
						is_neighbor_of = ENT
						OR = {
							is_american_tag = yes #vs CAN
							is_actual_major = yes #vs AST
							is_subject_of = GER #vs SAF
						}
					}
				}
			}
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		targets = { LEC }
		target_root_trigger = { has_country_flag = QIE_concession_decisions_unlocked }
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { is_in_faction_with = ENT }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_attack_entente_LEC target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 16 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_attack_entente_LEC target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.126
					hours = 6
				}
			}
		}
	}

	QIE_attack_entente_HK = {
		icon = generic_ignite_civil_war

		available = {
			is_neighbor_of = FROM
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { owns_state = 326 }
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes
		war_with_target_on_remove = yes

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				FROM = { is_in_faction = no }
			}
			modifier = {
				add = 100 #Invaded directly
				ENT = {
					is_in_faction_with = FROM
					any_enemy_country = {
						is_neighbor_of = ENT
						OR = {
							is_american_tag = yes #vs CAN
							is_actual_major = yes #vs AST
							is_subject_of = GER #vs SAF
						}
					}
				}
			}
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		targets = { AST }
		target_root_trigger = { has_country_flag = QIE_concession_decisions_unlocked }
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { owns_state = 326 }
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_attack_entente_HK target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 15 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_attack_entente_HK target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.126
					hours = 6
				}
			}
		}
	}
	QIE_attack_GER_LEC = {
		icon = generic_ignite_civil_war

		available = {
			is_neighbor_of = FROM
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_in_faction_with = GER }
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes
		war_with_target_on_remove = yes

		targets = { LEC }
		target_root_trigger = {
			has_country_flag = QIE_concession_decisions_unlocked
			NOT = { has_country_flag = wu_intervenes_proLEP }
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { is_in_faction_with = GER }
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				GER = {
					surrender_progress > 0.5
				}
			}
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_attack_GER_LEC target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_attack_GER_LEC target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_attack_non_aligned_LEC = {
		icon = generic_ignite_civil_war

		available = {
			is_neighbor_of = FROM
		}

		visible = {
			can_declare_war_on = FROM
			FROM = { is_in_faction = no }
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes
		war_with_target_on_remove = yes

		targets = { LEC }
		target_root_trigger = { has_country_flag = QIE_concession_decisions_unlocked }
		target_trigger = {
			can_declare_war_on = FROM
			FROM = { is_in_faction = no }
		}

		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				ROOT_is_threatened = yes
			}
			modifier = {
				factor = 0
				FROM = { is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { overlord_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { faction_leader_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
			modifier = {
				factor = 0
				FROM = { guarantor_is_stronger_than_ROOT_and_not_vulnerable = yes }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_attack_non_aligned_LEC target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 10 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_attack_non_aligned_LEC target: [From.GetName]"
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	QIE_threaten_ger_treaty_ports = {
		icon = generic_ignite_civil_war

		available = {
			OR = {
				is_neighbor_of = FROM
				any_allied_country = { is_neighbor_of = FROM }
			}
		}

		visible = {
			can_declare_war_on = FROM
			FROM = {
				OR = {
					has_full_control_of_state = 996
					has_full_control_of_state = 744
					has_full_control_of_state = 728
				}
			}
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes
		war_with_target_on_remove = yes

		ai_will_do = {
			base = 0
			modifier = {
				add = 300
				GEA = { has_war = yes }
			}
			modifier = {
				factor = 0
				has_war = yes
			}
			modifier = {
				factor = 0
				has_country_flag = imminent_war
			}
		}

		targets = { GEA }
		target_root_trigger = {
			has_country_flag = QIE_concession_decisions_unlocked
			NOT = { has_country_flag = wu_intervenes_proLEP }
		}
		target_trigger = {
			can_declare_war_on = FROM
			FROM = {
				OR = {
					has_full_control_of_state = 996
					has_full_control_of_state = 744
					has_full_control_of_state = 728
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision QIE_threaten_ger_treaty_ports target: [From.GetName]"
			set_country_flag = { flag = imminent_war days = 15 value = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_threaten_ger_treaty_ports target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.119
					days = 3
				}
			}
		}
	}
	QIE_negotiate_ger_treaty_ports = {
		icon = generic_agreement

		visible = {
			is_neighbor_of = FROM
			FROM = {
				OR = {
					has_full_control_of_state = 996
					has_full_control_of_state = 744
					has_full_control_of_state = 728
				}
			}
		}

		cost = 10
		days_remove = 7
		fire_only_once = yes

		ai_will_do = {
			factor = 1000
		}

		targets = { GEA }
		target_root_trigger = {
			has_country_flag = QIE_concession_decisions_unlocked
			has_country_flag = wu_intervenes_proLEP
		}
		target_trigger = {
			is_neighbor_of = FROM
			FROM = {
				OR = {
					has_full_control_of_state = 996
					has_full_control_of_state = 744
					has_full_control_of_state = 728
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_negotiate_ger_treaty_ports target: [From.GetName]"
			FROM = {
				country_event = {
					id = qiefor.122
					days = 1
				}
			}
		}
	}
}

QIE_projects_decisions_category = {
	QIE_develop_wuchang = {
		icon = GFX_decision_generic_industry

		visible = {
			has_country_flag = QIE_can_invest_wuchang
		}

		cost = 30
		days_remove = 150
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 1
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_develop_wuchang"
			ANQ = {
				custom_effect_tooltip = anq_increase_qie_1
				hidden_effect = {
					add_popularity = {
						ideology = market_liberal
						popularity = 0.01
					}
					ANQ_remove_beijing_spirit = yes
					ANQ_calculate_beijing_level = yes
					ANQ_add_beijing_spirit = yes
				}
			}
			1048 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
	}

	QIE_canal_dikes_anqing = {
		icon = generic_naval

		available = {
			#hebei, kaifeng
			controls_state = 1060
			controls_state = 1059
			#huaisi
			ANQ = { controls_state = 1050 }
		}

		visible = {
			has_country_flag = QIE_can_canal_dikes_anqing
		}

		cost = 15
		days_remove = 250
		fire_only_once = yes

		highlight_state_targets = {
			state = 1060
		}

		modifier = {
			civilian_factory_use = 1
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_canal_dikes_anqing target: [From.GetName]"
			ANQ = {
				set_country_flag = ANQ_qie_finishes_canals_with_anqing
				custom_effect_tooltip = anq_increase_qie_1
				hidden_effect = {
					add_popularity = {
						ideology = market_liberal
						popularity = 0.01
					}
					ANQ_remove_beijing_spirit = yes
					ANQ_calculate_beijing_level = yes
					ANQ_add_beijing_spirit = yes
				}
			}
			1060 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			1059 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 2
					instant_build = yes
				}
			}
			1050 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
	}
}

QIE_defensive_preparations_category = {
	QIE_huanghe_line = {
		icon = fortress
		available = {
			num_of_civilian_factories_available_for_projects > 2
			controls_state = 1059 #Kaifeng
			controls_state = 607 #Heluo
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		highlight_provinces = {
			7129 #Kaifeng
			7656 #Kaifeng
			9958 #Kaifeng
			1004 #Heluo
			11931 #Heluo
		}

		ai_will_do = { factor = 100 }
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_huanghe_line"
			1059 = {
				add_building_construction = {
					type = bunker
					province = 7129
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					province = 7656
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					province = 9958
					level = 1
					instant_build = yes
				}
			}
			607 = {
				add_building_construction = {
					type = bunker
					province = 1004
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = bunker
					province = 11931
					level = 1
					instant_build = yes
				}
			}
		}
	}
	QIE_withdraw_government_to_wuhan = {
		icon = GFX_decision_infiltrate_state
		available = {
			num_of_civilian_factories_available_for_projects > 1
			OR = {
				has_war_with = FNG
				has_war_with = JAP
			}
		}
		cost = 30
		days_remove = 60
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 1
			command_power_gain = -0.05
			political_power_gain = -0.01
		}

		highlight_state_targets = {
			state = 1048 #Wuhan
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_withdraw_government_to_wuhan target: [From.GetName]"
			set_global_flag = QIE_withdrew_to_wuhan
			set_victory_points = { province = 9843 value = 20 } #Beijing
			set_victory_points = { province = 7167 value = 0 } #Wuchang
			set_victory_points = { province = 12467 value = 0 } #Hankou
			set_victory_points = { province = 4619 value = 40 } #Wuchang/Wuhan
			set_province_name = { id = 4619 name = "Wuhan" }
		}
	}
	QIE_withdraw_civilian_factories_to_hubei = {
		icon = GFX_decision_generic_factory
		available = {
			num_of_civilian_factories_available_for_projects > 1
			OR = {
				1048 = {
					free_building_slots = {
						building = industrial_complex
						size > 0
					}
					free_building_slots = {
						building = arms_factory
						size > 0
					}
				}
				620 = {
					free_building_slots = {
						building = industrial_complex
						size > 0
					}
					free_building_slots = {
						building = arms_factory
						size > 0
					}
				}
			}
		}
		visible = {
			OR = {
				has_war_with = FNG
				has_war_with = JAP
			}
			has_country_flag = {
				flag = QIE_move_industrial_complex
				value < 3
			}
		}
		cost = 10
		days_remove = 30
		modifier = {
			civilian_factory_use = 1
		}
		ai_will_do = {
			factor = 100
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_withdraw_civilian_factories_to_hubei"
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					is_controlled_by_ROOT_or_ally = yes
					industrial_complex > 0
					NOT = {
						state = 1048
						state = 620
					}
				}
				remove_building = {
					type = industrial_complex
					level = 1
				}
			}
			random_owned_state = {
				limit = {
					is_controlled_by_ROOT_or_ally = yes
					industrial_complex > 0
					OR = {
						state = 1048
						state = 620
					}
				}
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = {
					has_country_flag = {
						flag = QIE_move_industrial_complex
						value = 0
					}
				}
				custom_effect_tooltip = QIE_move_factory_1
			}
			else_if = {
				limit = {
					has_country_flag = {
						flag = QIE_move_industrial_complex
						value = 1
					}
				}
				custom_effect_tooltip = QIE_move_factory_2
			}
			else = {
				custom_effect_tooltip = QIE_move_factory_3
			}
			if = {
				limit = { NOT = { has_country_flag = QIE_move_industrial_complex } }
				set_country_flag = { flag = QIE_move_industrial_complex value = 1 }
			}
			else = {
				modify_country_flag = {
					flag = QIE_move_industrial_complex
					value = 1
				}
			}
		}
	}
	QIE_withdraw_arms_factories_to_hubei = {
		icon = GFX_decision_generic_factory
		available = {
			num_of_civilian_factories_available_for_projects > 1
			OR = {
				1048 = {
					free_building_slots = {
						building = industrial_complex
						size > 0
					}
					free_building_slots = {
						building = arms_factory
						size > 0
					}
				}
				620 = {
					free_building_slots = {
						building = industrial_complex
						size > 0
					}
					free_building_slots = {
						building = arms_factory
						size > 0
					}
				}
			}
		}
		visible = {
			OR = {
				has_war_with = FNG
				has_war_with = JAP
			}
			has_country_flag = {
				flag = QIE_move_arms_factory
				value < 3
			}
		}
		cost = 10
		days_remove = 30
		modifier = {
			civilian_factory_use = 1
		}
		ai_will_do = {
			factor = 100
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_withdraw_arms_factories_to_hubei"
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					is_controlled_by_ROOT_or_ally = yes
					arms_factory > 0
					NOT = {
						state = 1048
						state = 620
					}
				}
				remove_building = {
					type = arms_factory
					level = 1
				}
			}
			random_owned_state = {
				limit = {
					is_controlled_by_ROOT_or_ally = yes
					arms_factory > 0
					OR = {
						state = 1048
						state = 620
					}
				}
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = {
					has_country_flag = {
						flag = QIE_move_arms_factory
						value = 0
					}
				}
				custom_effect_tooltip = QIE_move_factory_1
			}
			else_if = {
				limit = {
					has_country_flag = {
						flag = QIE_move_arms_factory
						value = 1
					}
				}
				custom_effect_tooltip = QIE_move_factory_2
			}
			else = {
				custom_effect_tooltip = QIE_move_factory_3
			}
			if = {
				limit = { NOT = { has_country_flag = QIE_move_arms_factory } }
				set_country_flag = { flag = QIE_move_arms_factory value = 1 }
			}
			else = {
				modify_country_flag = {
					flag = QIE_move_arms_factory
					value = 1
				}
			}
		}
	}

	QIE_fortify_southern_approach = {
		icon = fortress

		available = {
			num_of_civilian_factories_available_for_projects > 2
			controls_state = 1048 #Wuhan
			controls_state = 607 #Xiangyang
			controls_state = 1058 #Ruyang
			custom_trigger_tooltip = {
				tooltip = QIE_wuhan_neighbor
				OR = {
					1048 = {
						any_neighbor_state = { controller = { is_ruled_by_pro_zhili = no } }
					}
					620 = {
						any_neighbor_state = { controller = { is_ruled_by_pro_zhili = no } }
					}
				}
			}
		}

		cost = 40
		days_remove = 180
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 3
		}

		highlight_state_targets = {
			state = 1048 #Wuhan
		}

		ai_will_do = {
			factor = 100
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove QIE_fortify_southern_approach target: [From.GetName]"
			1048 = {
				add_building_construction = {
					type = bunker
					level = 2
					province = {
						all_provinces = yes
						limit_to_border = yes
					}
				}
			}
			607 = {
				add_building_construction = {
					type = bunker
					level = 2
					province = {
						all_provinces = yes
						limit_to_border = yes
					}
				}
			}
			1058 = {
				add_building_construction = {
					type = bunker
					level = 2
					province = 4158
				}
			}
		}
	}
}

