##################################
##    Yunnan Clique Effects     ##
##################################
# Initial YUN rework by Drozdovite, Wrealith Noel and Angry Bird
##################################
# Second South China Rework by Chiang Kai-Shrek, Suzuha, Hazo, Toaster, Clawedash, Festive, and the rest of the Second South China Rework Team
##################################

########################################
#########- Table of Contents - #########
########################################

#Section 1: Introgame Effects
#Section 2: Early game Effects
#Section 3: Mid Game Effects
#Section 4: Late Game Effects
#Section 5: End Game Effects

########################################
######- Section 01: Introgame - ########
########################################

###- Character Related Effects -###

YUN_kmt_recruit_characters_effect = {
	clr_country_flag = YUN_zhu_de_hidden_flag
	clr_country_flag = YUN_chen_cheng_hidden_flag
	clr_country_flag = YUN_zhang_qun_hidden_flag
	clr_country_flag = YUN_yang_yongtai_hidden_flag
	clr_country_flag = YUN_zhu_peide_hidden_flag
	clr_country_flag = YUN_dai_jitao_hidden_flag
	clr_country_flag = YUN_chen_lifu_hidden_flag
	clr_country_flag = YUN_he_yingqin_hidden_flag
	clr_country_flag = YUN_teng_jie_hidden_flag
	YUN_he_yingqin = { CHN_recruit_character_effect = yes }
	YUN_zhu_de = { CHN_recruit_character_effect = yes }
	YUN_chen_cheng = { CHN_recruit_character_effect = yes }
	YUN_teng_jie = { CHN_recruit_character_effect = yes }
	YUN_zhang_jingyu = { CHN_recruit_character_effect = yes }
	YUN_zhang_qun = { CHN_recruit_character_effect = yes }
	YUN_dai_jitao = { CHN_recruit_character_effect = yes }
	YUN_chen_lifu = { CHN_recruit_character_effect = yes }
	YUN_chen_guofu = { CHN_recruit_character_effect = yes }
	YUN_wang_boqun = { CHN_recruit_character_effect = yes }
	YUN_ouyang_ge = { CHN_recruit_character_effect = yes }
}

YUN_UPC_recruit_characters_effect = {
	YUN_tang_jiyao = { CHN_recruit_character_effect = yes }
	YUN_tang_jiyu = { CHN_recruit_character_effect = yes }
	YUN_zhang_taiyan = { CHN_recruit_character_effect = yes }
	YUN_sun_du = { CHN_recruit_character_effect = yes }
	YUN_wang_dong = { CHN_recruit_character_effect = yes }
	YUN_wang_rongbao = { CHN_recruit_character_effect = yes }
	YUN_luo_longji = { CHN_recruit_character_effect = yes }
	YUN_cun_shusheng = { CHN_recruit_character_effect = yes }
	YUN_miao_yuntai = { CHN_recruit_character_effect = yes }
	YUN_liao_xingchao = { CHN_recruit_character_effect = yes }
}

YUN_YSP_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_YSP_character_flag
			NOT = {
				is_character = YUN_wang_fusheng
			}
		}
		retire = yes
	}
	set_country_flag = YUN_wang_fusheng_hidden_flag
}

YUN_3AL_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_3AL_character_flag
			NOT = {
				is_character = YUN_zhu_de
			}
		}
		retire = yes
	}
	set_country_flag = YUN_zhu_de_hidden_flag
}

YUN_CEC_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_CEC_character_flag
			NOT = {
				is_character = YUN_chen_cheng
			}
		}
		retire = yes
	}
	set_country_flag = YUN_chen_cheng_hidden_flag
}

YUN_PSC_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_PSC_character_flag
			NOT = {
				is_character = YUN_zhang_qun
				is_character = YUN_yang_yongtai
			}
		}
		retire = yes
	}
	set_country_flag = YUN_zhang_qun_hidden_flag
	set_country_flag = YUN_yang_yongtai_hidden_flag
}

YUN_3AR_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_3AR_character_flag
			NOT = {
				is_character = YUN_zhu_peide
			}
		}
		retire = yes
	}
	set_country_flag = YUN_zhu_peide_hidden_flag
}

YUN_CCC_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_CCC_character_flag
			NOT = {
				is_character = YUN_dai_jitao
				#is_character = YUN_chen_guofu - Guofu Excluded because this effect would be insignificant otherwise
				is_character = YUN_chen_lifu
			}
		}
		retire = yes
	}
	set_country_flag = YUN_dai_jitao_hidden_flag
	set_country_flag = YUN_chen_lifu_hidden_flag
}

YUN_WPC_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_WPC_character_flag
			NOT = {
				is_character = YUN_he_yingqin
			}
		}
		retire = yes
	}
	set_country_flag = YUN_he_yingqin_hidden_flag
}

YUN_BSS_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_BSS_character_flag
			NOT = {
				is_character = YUN_teng_jie
				#Liu Jianqun excluded because this effect would be insignificant otherwise.
			}
		}
		retire = yes
	}
	set_country_flag = YUN_teng_jie_hidden_flag
}

YUN_TJY_purge_characters_minus_leaders_effect = {
	every_character = {
		limit = {
			has_character_flag = YUN_TJY_character_flag
			NOT = {
				is_character = YUN_tang_xiaoying
				#Tang Xiaoying will become the new leader of Soc Cons
			}
		}
		retire = yes
	}
}

###- YUN Intro-Minigame Effects -###
YUN_introminigame_calculate_difference_effect = {
	set_variable = { YUN_introminigame_KMT_soldiers_difference_var = YUN_introminigame_KMT_soldiers_var }
	subtract_from_variable = { YUN_introminigame_KMT_soldiers_difference_var = YUN_introminigame_UPC_soldiers_var } #Calculates how many more soldiers the KMT has than UPC.

	set_variable = { YUN_introminigame_UPC_soldiers_difference_var = YUN_introminigame_UPC_soldiers_var }
	subtract_from_variable = { YUN_introminigame_UPC_soldiers_difference_var = YUN_introminigame_KMT_soldiers_var } #Calculates how many more soldiers the UPC has than KMT.
}

YUN_introminigame_add_KMT_small_effect = {
	add_to_variable = {
		var = YUN_introminigame_KMT_soldiers_var
		value = 1000
		tooltip = YUN_introminigame_add_KMT_small_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_add_KMT_medium_effect = {
	add_to_variable = {
		var = YUN_introminigame_KMT_soldiers_var
		value = 2000
		tooltip = YUN_introminigame_add_KMT_medium_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_add_KMT_large_effect = {
	add_to_variable = {
		var = YUN_introminigame_KMT_soldiers_var
		value = 3000
		tooltip = YUN_introminigame_add_KMT_large_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_sub_KMT_large_effect = {
	add_to_variable = {
		var = YUN_introminigame_KMT_soldiers_var
		value = -3000
		tooltip = YUN_introminigame_sub_KMT_large_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_add_UPC_small_effect = {
	add_to_variable = {
		var = YUN_introminigame_UPC_soldiers_var
		value = 1000
		tooltip = YUN_introminigame_add_UPC_small_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_add_UPC_medium_effect = {
	add_to_variable = {
		var = YUN_introminigame_UPC_soldiers_var
		value = 2000
		tooltip = YUN_introminigame_add_UPC_medium_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_add_UPC_large_effect = {
	add_to_variable = {
		var = YUN_introminigame_UPC_soldiers_var
		value = 3000
		tooltip = YUN_introminigame_add_UPC_large_effect_tt
	}
	YUN_introminigame_calculate_difference_effect = yes
}

YUN_introminigame_clear_effect = {
	if = {
		limit = { has_active_mission = YUN_introminigame_war_preparation_mission_timer }
		remove_mission = YUN_introminigame_war_preparation_mission_timer
	}
	if = {
		limit = { has_active_mission = YUN_troops_flood_to_the_border_monthly_timer }
		remove_mission = YUN_troops_flood_to_the_border_monthly_timer
	}
	if = {
		limit = { has_decision = YUN_introminigame_switch_sides_decision }
		remove_targeted_decision = { target = YUN decision = YUN_introminigame_switch_sides_decision }
	}
	if = {
		limit = { has_decision = YUN_introminigame_commence_the_assault_decision }
		remove_targeted_decision = { target = YUN decision = YUN_introminigame_commence_the_assault_decision }
	}
	if = {
		limit = { has_decision = YUN_introminigame_accelerate_our_buildup_decision }
		remove_targeted_decision = { target = YUN decision = YUN_introminigame_accelerate_our_buildup_decision }
	}
	if = {
		limit = { has_decision = YUN_introminigame_develop_our_battleplan_decision }
		remove_targeted_decision = { target = YUN decision = YUN_introminigame_develop_our_battleplan_decision }
	}
	if = {
		limit = { has_decision = YUN_introminigame_win_the_war_of_wills_decision }
		remove_targeted_decision = { target = YUN decision = YUN_introminigame_win_the_war_of_wills_decision }
	}
}

########################################
######- Section 02: Early Game - #######
########################################

### Early Game Faction Influence Change Constants ###
@YUN_size_small_constant = 0.01
@YUN_size_medium_constant = 0.03
@YUN_size_large_constant = 0.05
@YUN_size_mega_constant = 0.10
@YUN_size_giga_constant = 0.25

### - Shared Early Game Effects -###
YUN_war_with_GXC_effect = {
	custom_effect_tooltip = YUN_march_on_guangzhou_tt
	#Give them claims on Liangguang
	every_state = {
		limit = {
			OR = {
				has_state_flag = guangxi_province_state
				has_state_flag = guangdong_province_state
			}
		}
		add_claim_by = YUN
	}

	country_event = YUN.earlygame.800 #The Road to Canton
	unlock_decision_tooltip = CHN_war_for_guangzhou
	if = {
		limit = { china_is_aligned_with_kmt = yes }
		if = {
			limit = { country_exists = LKT }
			unlock_decision_tooltip = CHN_join_LKT_decision
		}
		if = {
			limit = { country_exists = RKT }
			unlock_decision_tooltip = CHN_join_RKT_decision
			unlock_decision_tooltip = RKT_eliminate_RKMT_pretenders_decision
		}
	}
	else_if = {
		limit = {
			china_is_aligned_with_federalists = yes
			country_exists = UPC
		}
		unlock_decision_tooltip = CHN_join_UPC_decision
		unlock_decision_tooltip = UPC_eliminate_UPC_pretenders_decision
	}
}

YUN_GXC_increase_morale_effect = {
	if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_1
			has_war_support > 0.19
		}
		custom_effect_tooltip = YUN_GXC_increase_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_1
				add_idea = YUN_GXC_war_morale_idea_2
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_2
			has_war_support > 0.39
		}
		custom_effect_tooltip = YUN_GXC_increase_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_2
				add_idea = YUN_GXC_war_morale_idea_3
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_3
			has_war_support > 0.59
		}
		custom_effect_tooltip = YUN_GXC_increase_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_3
				add_idea = YUN_GXC_war_morale_idea_4
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_4
			has_war_support > 0.79
		}
		custom_effect_tooltip = YUN_GXC_increase_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_4
				add_idea = YUN_GXC_war_morale_idea_5
			}
		}
	}
}

YUN_GXC_decrease_morale_effect = {
	if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_2
			has_war_support < 0.20
		}
		custom_effect_tooltip = YUN_GXC_decrease_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_2
				add_idea = YUN_GXC_war_morale_idea_1
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_3
			has_war_support < 0.40
		}
		custom_effect_tooltip = YUN_GXC_decrease_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_3
				add_idea = YUN_GXC_war_morale_idea_2
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_4
			has_war_support < 0.60
		}
		custom_effect_tooltip = YUN_GXC_decrease_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_4
				add_idea = YUN_GXC_war_morale_idea_3
			}
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_GXC_war_morale_idea_5
			has_war_support < 0.80
		}
		custom_effect_tooltip = YUN_GXC_decrease_morale_effect_tt
		hidden_effect = {
			swap_ideas = {
				remove_idea = YUN_GXC_war_morale_idea_5
				add_idea = YUN_GXC_war_morale_idea_4
			}
		}
	}
}

YUN_GXC_clear_mechanic_effect = {
	if = {
		limit = { has_active_mission = YUN_the_course_of_the_yunnan_guangxi_war_mission }
		remove_mission = YUN_the_course_of_the_yunnan_guangxi_war_mission
	}
	hidden_effect = {
		every_enemy_country = {
			remove_targeted_decision = { target = YUN decision = YUN_accept_yunnans_surrender_decision }
		}
	}
	if = {
		limit = { has_idea = YUN_GXC_war_morale_idea_1 }
		remove_ideas = YUN_GXC_war_morale_idea_1
	}
	if = {
		limit = { has_idea = YUN_GXC_war_morale_idea_2 }
		remove_ideas = YUN_GXC_war_morale_idea_2
	}
	if = {
		limit = { has_idea = YUN_GXC_war_morale_idea_3 }
		remove_ideas = YUN_GXC_war_morale_idea_3
	}
	if = {
		limit = { has_idea = YUN_GXC_war_morale_idea_4 }
		remove_ideas = YUN_GXC_war_morale_idea_4
	}
	if = {
		limit = { has_idea = YUN_GXC_war_morale_idea_5 }
		remove_ideas = YUN_GXC_war_morale_idea_5
	}
}

###- KMT Early Game Effects -###

YUN_KMT_set_initial_parties = {
	set_party_name = {
		ideology = totalist
		long_name = YUN_CSP_YSB_party_long
		name = YUN_CSP_YSB_party
	}
	set_party_name = {
		ideology = syndicalist
		long_name = YUN_CSP_NDS_party_long
		name = YUN_CSP_NDS_party
	}
	set_party_name = {
		ideology = radical_socialist
		long_name = YUN_KMT_3AL_party_long
		name = YUN_KMT_3AL_party
	}
	set_party_name = {
		ideology = social_democrat
		long_name = YUN_KMT_CEC_early_party_long
		name = YUN_KMT_CEC_early_party
	}
	set_party_name = {
		ideology = social_liberal
		long_name = YUN_republicans_party_long
		name = YUN_republicans_party #Will Flip to RCF via events later
	}
	set_party_name = {
		ideology = market_liberal
		long_name = YUN_chamber_of_commerce_party_long
		name = YUN_chamber_of_commerce_party #Will Flip to PSC via events later
	}
	set_party_name = {
		ideology = social_conservative
		long_name = YUN_KMT_3AR_party_long
		name = YUN_KMT_3AR_party
	}
	set_party_name = {
		ideology = authoritarian_democrat
		long_name = YUN_KMT_dian_remnant_party_long
		name = YUN_KMT_dian_remnant_party #Will Flip to CCC via events later
	}
	set_party_name = {
		ideology = paternal_autocrat
		long_name = YUN_KMT_WPC_party_long
		name = YUN_KMT_WPC_party
	}
	set_party_name = {
		ideology = national_populist
		long_name = YUN_KMT_BSS_early_party_long
		name = YUN_KMT_BSS_early_party
	}

	promote_character = {
		character = YUN_wang_fusheng
		ideology = totalist_subtype
	}
	promote_character = {
		character = YUN_wang_fusheng
		ideology = syndicalist_subtype
	}
	promote_character = {
		character = YUN_zhu_de
		ideology = radical_socialist_subtype
	}
	promote_character = {
		character = YUN_chen_cheng
		ideology = social_democrat_subtype
	}
	promote_character = {
		character = YUN_cun_shusheng
		ideology = social_liberal_subtype
	}
	promote_character = {
		character = YUN_assorted_leaders #Miao Yuntai is retired in a previous event. Will flip to assorted leaders later.
		ideology = market_liberal_subtype
	}
	promote_character = {
		character = YUN_zhu_peide
		ideology = social_conservative_subtype
	}
	promote_character = {
		character = YUN_long_yun
		ideology = authoritarian_democrat_subtype
	}
	promote_character = {
		character = YUN_he_yingqin
		ideology = paternal_autocrat_subtype
	}
	promote_character = {
		character = YUN_teng_jie
		ideology = national_populist_subtype
	}
}

#Strengthening YSP
YUN_add_YSP_effect = {
	add_popularity = {
		ideology = syndicalist
		popularity = var:YUN_size_var
	}
}

#No need for a popularity ladder event for these people

YUN_YSP_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_YSP_effect = yes
}
YUN_YSP_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_YSP_effect = yes
}
YUN_YSP_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_YSP_effect = yes
}
YUN_YSP_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_YSP_effect = yes
}
YUN_YSP_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_YSP_effect = yes
}

#Strengthening 3AL
YUN_add_3AL_effect = {
	add_popularity = {
		ideology = radical_socialist
		popularity = var:YUN_size_var
	}
}

YUN_3AL_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_3AL_event_one_flag }
				radical_socialist > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.484 days = 3 } } #Life as a Warlord, Eternity as a Soldier
			set_country_flag = YUN_3AL_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_3AL_event_two_flag }
				radical_socialist > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.485 days = 3 } } #Yunnan's Socialist Stars
			set_country_flag = YUN_3AL_event_two_flag
		}
	}
}

YUN_3AL_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_3AL_effect = yes
	YUN_3AL_mechanic_effect = yes
}
YUN_3AL_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_3AL_effect = yes
	YUN_3AL_mechanic_effect = yes
}
YUN_3AL_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_3AL_effect = yes
	YUN_3AL_mechanic_effect = yes
}
YUN_3AL_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_3AL_effect = yes
	YUN_3AL_mechanic_effect = yes
}
YUN_3AL_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_3AL_effect = yes
	YUN_3AL_mechanic_effect = yes
}

#Strengthening CEC
YUN_add_CEC_effect = {
	add_popularity = {
		ideology = social_democrat
		popularity = var:YUN_size_var
	}
}

YUN_CEC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_CEC_event_one_flag }
				social_democrat > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.478 days = 3 } } #Chen Cheng’s Complex Character
			set_country_flag = YUN_CEC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_CEC_event_two_flag }
				social_democrat > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.479 days = 3 } } #The Hubei Training Institute
			set_country_flag = YUN_CEC_event_two_flag
		}
	}
}

YUN_CEC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_CEC_effect = yes
	YUN_CEC_mechanic_effect = yes
}
YUN_CEC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_CEC_effect = yes
	YUN_CEC_mechanic_effect = yes
}
YUN_CEC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_CEC_effect = yes
	YUN_CEC_mechanic_effect = yes
}
YUN_CEC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_CEC_effect = yes
	YUN_CEC_mechanic_effect = yes
}
YUN_CEC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_CEC_effect = yes
	YUN_CEC_mechanic_effect = yes
}

#Strengthening PSC
YUN_add_PSC_effect = {
	add_popularity = {
		ideology = market_liberal
		popularity = var:YUN_size_var
	}
}

YUN_PSC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_PSC_event_one_flag }
				market_liberal > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.474 days = 3 } } #Yang Yongtai, the Generalissimo’s Workhorse
			set_country_flag = YUN_PSC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_PSC_event_two_flag }
				is_subject = yes
				market_liberal > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.486 days = 3 } } #Forever a Fighter
			set_country_flag = YUN_PSC_event_two_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_PSC_event_two_flag }
				NOT = { is_subject = yes }
				market_liberal > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.475 days = 3 } } #The Banks are Made of Marble
			set_country_flag = YUN_PSC_event_two_flag
		}
	}
}

YUN_PSC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_PSC_effect = yes
	YUN_PSC_mechanic_effect = yes
}
YUN_PSC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_PSC_effect = yes
	YUN_PSC_mechanic_effect = yes
}
YUN_PSC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_PSC_effect = yes
	YUN_PSC_mechanic_effect = yes
}
YUN_PSC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_PSC_effect = yes
	YUN_PSC_mechanic_effect = yes
}
YUN_PSC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_PSC_effect = yes
	YUN_PSC_mechanic_effect = yes
}

#Strengthening 3AR
YUN_add_3AR_effect = {
	add_popularity = {
		ideology = social_conservative
		popularity = var:YUN_size_var
	}
}

YUN_3AR_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_3AR_event_one_flag }
				social_conservative > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.482 days = 3 } } #Sun's Tiger General
			set_country_flag = YUN_3AR_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_3AR_event_two_flag }
				social_conservative > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.483 days = 3 } } #Prime Minister of the Mountains
			set_country_flag = YUN_3AR_event_two_flag
		}
	}
}

YUN_3AR_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_3AR_effect = yes
	YUN_3AR_mechanic_effect = yes
}
YUN_3AR_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_3AR_effect = yes
	YUN_3AR_mechanic_effect = yes
}
YUN_3AR_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_3AR_effect = yes
	YUN_3AR_mechanic_effect = yes
}
YUN_3AR_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_3AR_effect = yes
	YUN_3AR_mechanic_effect = yes
}
YUN_3AR_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_3AR_effect = yes
	YUN_3AR_mechanic_effect = yes
}

#Strengthening MCC
YUN_add_MCC_effect = {
	add_popularity = {
		ideology = social_conservative
		popularity = var:YUN_size_var
	}
}

YUN_MCC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_MCC_event_one_flag }
				social_conservative > 0.15 #minor
			}
			hidden_effect = { country_event = { id = YUN.midgame.480 days = 3 } } #From First Protege to Figurehead
			set_country_flag = YUN_MCC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_MCC_event_two_flag }
				social_conservative > 0.25 #minor
			}
			hidden_effect = { country_event = { id = YUN.midgame.481 days = 3 } } #The Legislative Yuan Rises
			set_country_flag = YUN_MCC_event_two_flag
		}
	}
}

YUN_MCC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_MCC_effect = yes
	YUN_MCC_mechanic_effect = yes
}
YUN_MCC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_MCC_effect = yes
	YUN_MCC_mechanic_effect = yes
}
YUN_MCC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_MCC_effect = yes
	YUN_MCC_mechanic_effect = yes
}
YUN_MCC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_MCC_effect = yes
	YUN_MCC_mechanic_effect = yes
}
YUN_MCC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_MCC_effect = yes
	YUN_MCC_mechanic_effect = yes
}

#Strengthening CCC
YUN_add_CCC_effect = {
	add_popularity = {
		ideology = authoritarian_democrat
		popularity = var:YUN_size_var
	}
}

YUN_CCC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_CCC_event_one_flag }
				authoritarian_democrat > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.472 days = 3 } } #The Generalissimo and his Philosopher
			set_country_flag = YUN_CCC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_CCC_event_two_flag }
				authoritarian_democrat > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.473 days = 3 } } #Chen Lifu’s Vitalism
			set_country_flag = YUN_CCC_event_two_flag
		}
	}
}

YUN_CCC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_CCC_effect = yes
	YUN_CCC_mechanic_effect = yes
}
YUN_CCC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_CCC_effect = yes
	YUN_CCC_mechanic_effect = yes
}
YUN_CCC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_CCC_effect = yes
	YUN_CCC_mechanic_effect = yes
}
YUN_CCC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_CCC_effect = yes
	YUN_CCC_mechanic_effect = yes
}
YUN_CCC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_CCC_effect = yes
	YUN_CCC_mechanic_effect = yes
}

#Strengthening WPC
YUN_add_WPC_effect = {
	add_popularity = {
		ideology = paternal_autocrat
		popularity = var:YUN_size_var
	}
}

YUN_WPC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_WPC_event_one_flag }
				paternal_autocrat > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.470 days = 3 } } #The Rise of the Whampoa Clique
			set_country_flag = YUN_WPC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_WPC_event_two_flag }
				paternal_autocrat > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.471 days = 3 } } #The Generalissimo’s Cult of Personality
			set_country_flag = YUN_WPC_event_two_flag
		}
	}
}

YUN_WPC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_WPC_effect = yes
	YUN_WPC_mechanic_effect = yes
}
YUN_WPC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_WPC_effect = yes
	YUN_WPC_mechanic_effect = yes
}
YUN_WPC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_WPC_effect = yes
	YUN_WPC_mechanic_effect = yes
}
YUN_WPC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_WPC_effect = yes
	YUN_WPC_mechanic_effect = yes
}
YUN_WPC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_WPC_effect = yes
	YUN_WPC_mechanic_effect = yes
}

#Strengthening BSS
YUN_add_BSS_effect = {
	add_popularity = {
		ideology = national_populist
		popularity = var:YUN_size_var
	}
}

YUN_BSS_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_BSS_event_one_flag }
				national_populist > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.476 days = 3 } } #The Lushan Conference
			set_country_flag = YUN_BSS_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_BSS_event_two_flag }
				national_populist > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.477 days = 3 } } #The War on Socialism
			set_country_flag = YUN_BSS_event_two_flag
		}
	}
}

YUN_BSS_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_BSS_effect = yes
	YUN_BSS_mechanic_effect = yes
}
YUN_BSS_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_BSS_effect = yes
	YUN_BSS_mechanic_effect = yes
}
YUN_BSS_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_BSS_effect = yes
	YUN_BSS_mechanic_effect = yes
}
YUN_BSS_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_BSS_effect = yes
	YUN_BSS_mechanic_effect = yes
}
YUN_BSS_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_BSS_effect = yes
	YUN_BSS_mechanic_effect = yes
}

###- UPC Early Game Effects -###

YUN_UPC_set_initial_parties = {
	set_party_name = {
		ideology = totalist
		long_name = YUN_CSP_YSB_party_long
		name = YUN_CSP_YSB_party
	}
	set_party_name = {
		ideology = syndicalist
		long_name = YUN_CSP_NDS_party_long
		name = YUN_CSP_NDS_party
	}
	set_party_name = {
		ideology = radical_socialist
		long_name = YUN_KMT_NRA_party_long
		name = YUN_KMT_NRA_party
	}
	set_party_name = {
		ideology = social_democrat
		long_name = YUN_republicans_party_long #Will Flip to YCD via events later
		name = YUN_republicans_party #Will Flip to YCD via events later
	}
	set_party_name = {
		ideology = social_liberal
		long_name = YUN_CMS_local_party_long
		name = YUN_CMS_local_party
	}
	set_party_name = {
		ideology = market_liberal
		long_name = YUN_chamber_of_commerce_party_long
		name = YUN_chamber_of_commerce_party
	}
	set_party_name = {
		ideology = social_conservative
		long_name = UPC_PGP_party_long
		name = UPC_PGP_party
	}
	set_party_name = {
		ideology = authoritarian_democrat
		long_name = YUN_tang_jiyao_clique_party_long
		name = YUN_tang_jiyao_clique_party
	}
	set_party_name = {
		ideology = paternal_autocrat
		long_name = YUN_garrison_commanders_party_long #Will flip to Mengzi later
		name = YUN_garrison_commanders_party #Will flip to Mengzi later
	}
	set_party_name = {
		ideology = national_populist
		long_name = YUN_YCP_party_long #Manually override this in the history file for initial startup
		name = YUN_YCP_party
	}

	promote_character = {
		character = YUN_wang_fusheng
		ideology = totalist_subtype
	}
	promote_character = {
		character = YUN_wang_fusheng
		ideology = syndicalist_subtype
	}
	promote_character = {
		character = YUN_zhu_peide
		ideology = radical_socialist_subtype
	}
	promote_character = {
		character = YUN_cun_shusheng
		ideology = social_democrat_subtype
	}
	promote_character = {
		character = YUN_luo_longji
		ideology = social_liberal_subtype
	}
	promote_character = {
		character = YUN_miao_yuntai
		ideology = market_liberal_subtype
	}
	promote_character = {
		character = YUN_tang_jiyao
		ideology = social_conservative_subtype
	}
	promote_character = {
		character = YUN_tang_jiyao
		ideology = authoritarian_democrat_subtype
	}
	promote_character = {
		character = YUN_long_yun
		ideology = paternal_autocrat_subtype
	}
	promote_character = {
		character = YUN_liao_xingchao
		ideology = national_populist_subtype
	}
}

#Strengthening YCD
YUN_add_YCD_effect = {
	add_popularity = {
		ideology = social_democrat
		popularity = var:YUN_size_var
	}
}

YUN_CMS_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_YCD_event_one_flag }
				social_democrat > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.760 days = 3 } } #Su Honggang, Educator of the Masses
			set_country_flag = YUN_YCD_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_YCD_event_two_flag }
				social_democrat > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.761 days = 3 } } #The Duel for Youth Support
			set_country_flag = YUN_YCD_event_two_flag
		}
	}
}

YUN_YCD_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_YCD_effect = yes
}
YUN_YCD_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_YCD_effect = yes
}
YUN_YCD_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_YCD_effect = yes
}
YUN_YCD_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_YCD_effect = yes
}
YUN_YCD_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_YCD_effect = yes
}

#Strengthening CMS
YUN_add_CMS_effect = {
	add_popularity = {
		ideology = social_liberal
		popularity = var:YUN_size_var
	}
}

YUN_CMS_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_CMS_event_one_flag }
				social_liberal > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.160 days = 3 } } #Reflections on Human Rights
			set_country_flag = YUN_CMS_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_CMS_event_two_flag }
				social_liberal > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.161 days = 3 } } #Allies of the Crescent Moon
			set_country_flag = YUN_CMS_event_two_flag
		}
	}
}

YUN_CMS_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_CMS_effect = yes
	YUN_CMS_mechanic_effect = yes
}
YUN_CMS_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_CMS_effect = yes
	YUN_CMS_mechanic_effect = yes
}
YUN_CMS_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_CMS_effect = yes
	YUN_CMS_mechanic_effect = yes
}
YUN_CMS_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_CMS_effect = yes
	YUN_CMS_mechanic_effect = yes
}
YUN_CMS_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_CMS_effect = yes
	YUN_CMS_mechanic_effect = yes
}

#Strengthening YCC
YUN_add_YCC_effect = {
	if = {
		limit = { YUN = { has_country_flag = YUN_UPC_satellite_election_path_flag } }
		add_popularity = {
			ideology = social_conservative
			popularity = var:YUN_size_var
		}
	}
	else = {
		add_popularity = {
			ideology = market_liberal
			popularity = var:YUN_size_var
		}
	}
}

YUN_YCC_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_YCC_event_one_flag }
				market_liberal > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.764 days = 3 } } #Miao Yuntai, the Miracle Man
			set_country_flag = YUN_YCC_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_YCC_event_two_flag }
				market_liberal > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.765 days = 3 } } #The Chamber's Coffers
			set_country_flag = YUN_YCC_event_two_flag
		}
	}
}

YUN_YCC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_YCC_effect = yes
}
YUN_YCC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_YCC_effect = yes
}
YUN_YCC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_YCC_effect = yes
}
YUN_YCC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_YCC_effect = yes
}
YUN_YCC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_YCC_effect = yes
}

#Strengthening LYC
YUN_add_LYC_effect = {
	if = {
		limit = { china_is_aligned_with_federalists = yes }
		add_popularity = {
			ideology = paternal_autocrat
			popularity = var:YUN_size_var
		}
	}
	else = {
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = var:YUN_size_var
		}
	}
}

YUN_LYC_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_LYC_effect = yes
}
YUN_LYC_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_LYC_effect = yes
}
YUN_LYC_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_LYC_effect = yes
}
YUN_LYC_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_LYC_effect = yes
}
YUN_LYC_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_LYC_effect = yes
}

#Strengthening TJY
YUN_add_TJY_effect = {
	add_popularity = {
		ideology = authoritarian_democrat
		popularity = var:YUN_size_var
	}
}

YUN_TJY_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_TJY_event_one_flag }
				authoritarian_democrat > 0.25 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.164 days = 3 } } #Tang Jiyao, Yunnan Champion
			set_country_flag = YUN_TJY_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_TJY_event_two_flag }
				authoritarian_democrat > 0.35 #major
			}
			hidden_effect = { country_event = { id = YUN.midgame.165 days = 3 } } #Tang Jiyao's Inner Circle
			set_country_flag = YUN_TJY_event_two_flag
		}
	}
}

YUN_TJY_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_TJY_effect = yes
	YUN_TJY_mechanic_effect = yes
}
YUN_TJY_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_TJY_effect = yes
	YUN_TJY_mechanic_effect = yes
}
YUN_TJY_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_TJY_effect = yes
	YUN_TJY_mechanic_effect = yes
}
YUN_TJY_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_TJY_effect = yes
	YUN_TJY_mechanic_effect = yes
}
YUN_TJY_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_TJY_effect = yes
	YUN_TJY_mechanic_effect = yes
}

#Strengthening HRY
YUN_add_HRY_effect = {
	if = {
		limit = { china_is_aligned_with_kmt = yes }
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = var:YUN_size_var
		}
	}
	else = {
		add_popularity = {
			ideology = paternal_autocrat
			popularity = var:YUN_size_var
		}
	}
}

YUN_HRY_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_HRY_effect = yes
}
YUN_HRY_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_HRY_effect = yes
}
YUN_HRY_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_HRY_effect = yes
}
YUN_HRY_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_HRY_effect = yes
}
YUN_HRY_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_HRY_effect = yes
}

#Strengthening PGP
YUN_add_PGP_effect = {
	if = {
		limit = { YUN = { has_country_flag = YUN_UPC_satellite_election_path_flag } }
		add_popularity = {
			ideology = market_liberal
			popularity = var:YUN_size_var
		}
	}
	else = {
		add_popularity = {
			ideology = social_conservative
			popularity = var:YUN_size_var
		}
	}
}

YUN_PGP_mechanic_effect = {
	if = {
		limit = {
			OR = {
				YUN_is_phase_3_trigger = yes
				YUN_is_phase_4_trigger = yes
				YUN_is_phase_5_trigger = yes
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = YUN_PGP_event_one_flag }
				OR = {
					AND = {
						NOT = { has_country_flag = YUN_UPC_satellite_election_path_flag }
						social_conservative > 0.25 #major
					}
					AND = {
						has_country_flag = YUN_UPC_satellite_election_path_flag
						market_liberal > 0.25 #major
					}
				}
			}
			hidden_effect = { country_event = { id = YUN.midgame.162 days = 3 } } #Lunatic Zhang and the Su Bao Case
			set_country_flag = YUN_PGP_event_one_flag
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = YUN_PGP_event_two_flag }
				OR = {
					AND = {
						NOT = { has_country_flag = YUN_UPC_satellite_election_path_flag }
						social_conservative > 0.35 #major
					}
					AND = {
						has_country_flag = YUN_UPC_satellite_election_path_flag
						market_liberal > 0.35 #major
					}
				}
			}
			hidden_effect = { country_event = { id = YUN.midgame.163 days = 3 } } #The Direction of the PGP:
			set_country_flag = YUN_PGP_event_two_flag
		}
	}
}

YUN_PGP_small_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_small_constant }
	YUN_add_PGP_effect = yes
	YUN_PGP_mechanic_effect = yes
}
YUN_PGP_medium_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_medium_constant }
	YUN_add_PGP_effect = yes
	YUN_PGP_mechanic_effect = yes
}
YUN_PGP_large_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_large_constant }
	YUN_add_PGP_effect = yes
	YUN_PGP_mechanic_effect = yes
}
YUN_PGP_mega_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_mega_constant }
	YUN_add_PGP_effect = yes
	YUN_PGP_mechanic_effect = yes
}
YUN_PGP_giga_effect = {
	set_temp_variable = { YUN_size_var = @YUN_size_giga_constant }
	YUN_add_PGP_effect = yes
	YUN_PGP_mechanic_effect = yes
}

### - Economic Effects -###

YUN_KMT_improve_popular_support_effect = {
	#Swap level 1 to level 2 manually at start of Phase II
	#Appears 2x in Phase II
	#Appears 0x in Phase III
	#Appears 2x in Phase IV (including 1 backup)
	#Appears 2x in Phase V (including 1 backup) and also an epilogue
	if = {
		limit = { has_idea = YUN_unrest_in_kunming_level_2 }
		swap_ideas = {
			remove_idea = YUN_unrest_in_kunming_level_2
			add_idea = YUN_KMT_popular_support_1
		}
	}
	else_if = {
		limit = { has_idea = YUN_KMT_popular_support_1 }
		swap_ideas = {
			remove_idea = YUN_KMT_popular_support_1
			add_idea = YUN_KMT_popular_support_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_KMT_popular_support_2 }
		swap_ideas = {
			remove_idea = YUN_KMT_popular_support_2
			add_idea = YUN_KMT_popular_support_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_KMT_popular_support_3 }
		swap_ideas = {
			remove_idea = YUN_KMT_popular_support_3
			add_idea = YUN_KMT_popular_support_4
		}
	}
	else_if = {
		limit = { has_idea = YUN_KMT_popular_support_4 }
		swap_ideas = {
			remove_idea = YUN_KMT_popular_support_4
			add_idea = YUN_KMT_popular_support_5
		}
	}
	else = {
		custom_effect_tooltip = YUN_popular_support_tt
	}
}

YUN_UPC_improve_popular_support_effect = {
	#Swap level 1 to level 2 manually at start of Phase II
	#Appears 2x in Phase II
	#Appears 0x in Phase III
	#Appears 2x in Phase IV (including 1 backup)
	#Appears 2x in Phase V (including 1 backup) and also an epilogue
	if = {
		limit = { has_idea = YUN_unrest_in_kunming_level_2 }
		swap_ideas = {
			remove_idea = YUN_unrest_in_kunming_level_2
			add_idea = YUN_UPC_popular_support_1
		}
	}
	else_if = {
		limit = { has_idea = YUN_UPC_popular_support_1 }
		swap_ideas = {
			remove_idea = YUN_UPC_popular_support_1
			add_idea = YUN_UPC_popular_support_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_UPC_popular_support_2 }
		swap_ideas = {
			remove_idea = YUN_UPC_popular_support_2
			add_idea = YUN_UPC_popular_support_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_UPC_popular_support_3 }
		swap_ideas = {
			remove_idea = YUN_UPC_popular_support_3
			add_idea = YUN_UPC_popular_support_4
		}
	}
	else_if = {
		limit = { has_idea = YUN_UPC_popular_support_4 }
		swap_ideas = {
			remove_idea = YUN_UPC_popular_support_4
			add_idea = YUN_UPC_popular_support_5
		}
	}
	else = {
		custom_effect_tooltip = YUN_popular_support_tt
	}
}

YUN_NPA_improve_popular_support_effect = {
	#Swap level 1 to level 2 manually at start of Phase II
	#Appears 2x in Phase II
	#Appears 0x in Phase III
	#Appears 2x in Phase IV (including 1 backup)
	#Appears 2x in Phase V (including 1 backup) and also an epilogue
	if = {
		limit = { has_idea = YUN_unrest_in_kunming_level_2 }
		swap_ideas = {
			remove_idea = YUN_unrest_in_kunming_level_2
			add_idea = YUN_NPA_popular_support_1
		}
	}
	else_if = {
		limit = { has_idea = YUN_NPA_popular_support_1 }
		swap_ideas = {
			remove_idea = YUN_NPA_popular_support_1
			add_idea = YUN_NPA_popular_support_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_NPA_popular_support_2 }
		swap_ideas = {
			remove_idea = YUN_NPA_popular_support_2
			add_idea = YUN_NPA_popular_support_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_NPA_popular_support_3 }
		swap_ideas = {
			remove_idea = YUN_NPA_popular_support_3
			add_idea = YUN_NPA_popular_support_4
		}
	}
	else_if = {
		limit = { has_idea = YUN_NPA_popular_support_4 }
		swap_ideas = {
			remove_idea = YUN_NPA_popular_support_4
			add_idea = YUN_NPA_popular_support_5
		}
	}
	else = {
		custom_effect_tooltip = YUN_popular_support_tt
	}
}

YUN_transition_to_NPA_pop_support_effect = {
	hidden_effect = {
		remove_ideas = {
			YUN_UPC_popular_support_1
			YUN_UPC_popular_support_2
			YUN_UPC_popular_support_3
			YUN_UPC_popular_support_4
			YUN_UPC_popular_support_5
			YUN_KMT_popular_support_1
			YUN_KMT_popular_support_2
			YUN_KMT_popular_support_3
			YUN_KMT_popular_support_4
			YUN_KMT_popular_support_5
		}
		add_ideas = YUN_NPA_popular_support_3
	}
}

YUN_transition_to_NPA_army_tree_effect = {
	if = {
		limit = { has_completed_focus = YUN_an_era_of_national_struggle }
		uncomplete_national_focus = {
			focus = YUN_an_era_of_national_struggle
			uncomplete_children = yes
		}
		if = {
			limit = { has_idea = YUN_rejuvenation_of_national_struggle_level_1 }
			swap_ideas = {
				remove_idea = YUN_rejuvenation_of_national_struggle_level_1
				add_idea = YUN_legacy_of_the_huguojun_level_1
			}
		}
		complete_national_focus = YUN_legacy_of_the_huguojun
	}
	if = {
		limit = { has_completed_focus = YUN_the_endpoint_of_chinese_armies }
		uncomplete_national_focus = {
			focus = YUN_the_endpoint_of_chinese_armies
			uncomplete_children = yes
		}
		if = {
			limit = { has_idea = YUN_rejuvenation_of_national_struggle_level_2 }
			swap_ideas = {
				remove_idea = YUN_rejuvenation_of_national_struggle_level_2
				add_idea = YUN_legacy_of_the_huguojun_level_2
			}
		}
		complete_national_focus = YUN_yunnans_militarist_credidentials
		if = {
			limit = { has_idea = CHN_military_disarray_idea2 }
			remove_ideas = CHN_military_disarray_idea1
		}
		if = {
			limit = { has_idea = CHN_military_disarray_idea3 }
			remove_ideas = CHN_military_disarray_idea1
		}
	}
	if = {
		limit = { has_completed_focus = YUN_a_hundred_regiments }
		swap_ideas = {
			remove_idea = YUN_rejuvenation_of_national_struggle_level_3
			add_idea = YUN_legacy_of_the_huguojun_level_2
		}
	}
}

YUN_improve_dian_qian_divide_effect = {
	if = {
		limit = { has_idea = YUN_dian_qian_divide_1 }
		swap_ideas = {
			remove_idea = YUN_dian_qian_divide_1
			add_idea = YUN_dian_qian_divide_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_dian_qian_divide_2 }
		swap_ideas = {
			remove_idea = YUN_dian_qian_divide_2
			add_idea = YUN_dian_qian_divide_3
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_dian_qian_divide_3
			is_subject = yes
		}
		swap_ideas = {
			remove_idea = YUN_dian_qian_divide_3
			add_idea = YUN_dian_qian_divide_4_satellite
		}
	}
	else_if = {
		limit = {
			has_idea = YUN_dian_qian_divide_3
			is_subject = no
		}
		swap_ideas = {
			remove_idea = YUN_dian_qian_divide_3
			add_idea = YUN_dian_qian_divide_4_contender
		}
	}
	else = {
		add_political_power = 100
	}
}

YUN_exploit_economy_effect = {
	if = {
		limit = { has_idea = YUN_industrial_economy_idea1 }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea1
			add_idea = YUN_industrial_economy_idea2a
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea2a }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea2a
			add_idea = YUN_industrial_economy_idea3a
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea3a }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea3a
			add_idea = YUN_industrial_economy_idea4a
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea4a }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea4a
			add_idea = YUN_industrial_economy_idea5a
		}
	}
	else = {
		custom_effect_tooltip = YUN_economic_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

YUN_develop_economy_effect = {
	if = {
		limit = { has_idea = YUN_industrial_economy_idea1 }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea1
			add_idea = YUN_industrial_economy_idea2b
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea2b }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea2b
			add_idea = YUN_industrial_economy_idea3b
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea3b }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea3b
			add_idea = YUN_industrial_economy_idea4b
		}
	}
	else_if = {
		limit = { has_idea = YUN_industrial_economy_idea4b }
		swap_ideas = {
			remove_idea = YUN_industrial_economy_idea4b
			add_idea = YUN_industrial_economy_idea5b
		}
	}
	else = {
		custom_effect_tooltip = YUN_economic_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

YUN_exploit_military_effect = {
	if = {
		limit = { has_idea = YUN_militarised_state_idea1 }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea1
			add_idea = YUN_militarised_state_idea2a
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea2a }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea2a
			add_idea = YUN_militarised_state_idea3a
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea3a }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea3a
			add_idea = YUN_militarised_state_idea4a
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea4a }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea4a
			add_idea = YUN_militarised_state_idea5a
		}
	}
	else = {
		custom_effect_tooltip = YUN_militarisation_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

YUN_develop_military_effect = {
	if = {
		limit = { has_idea = YUN_militarised_state_idea1 }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea1
			add_idea = YUN_militarised_state_idea2b
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea2b }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea2b
			add_idea = YUN_militarised_state_idea3b
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea3b }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea3b
			add_idea = YUN_militarised_state_idea4b
		}
	}
	else_if = {
		limit = { has_idea = YUN_militarised_state_idea4b }
		swap_ideas = {
			remove_idea = YUN_militarised_state_idea4b
			add_idea = YUN_militarised_state_idea5b
		}
	}
	else = {
		custom_effect_tooltip = YUN_balancing_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

YUN_KMT_agriculture_effect = {
	if = {
		limit = { has_idea = YUN_agrarian_economy_idea1 }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea1
			add_idea = YUN_agrarian_economy_idea2a
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea2a }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea2a
			add_idea = YUN_agrarian_economy_idea3a
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea3a }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea3a
			add_idea = YUN_agrarian_economy_idea4a
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea4a }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea4a
			add_idea = YUN_agrarian_economy_idea5a
		}
	}
	else = {
		custom_effect_tooltip = YUN_KMT_agriculture_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

YUN_UPC_agriculture_effect = {
	if = {
		limit = { has_idea = YUN_agrarian_economy_idea1 }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea1
			add_idea = YUN_agrarian_economy_idea2b
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea2b }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea2b
			add_idea = YUN_agrarian_economy_idea3b
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea3b }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea3b
			add_idea = YUN_agrarian_economy_idea4b
		}
	}
	else_if = {
		limit = { has_idea = YUN_agrarian_economy_idea4b }
		swap_ideas = {
			remove_idea = YUN_agrarian_economy_idea4b
			add_idea = YUN_agrarian_economy_idea5b
		}
	}
	else = {
		custom_effect_tooltip = YUN_UPC_agriculture_tt
		custom_effect_tooltip = tooltip_white_line
	}
}

########################################
######- Section 03: Mid Game - #########
########################################

### - Political Effects -###

### - Military Effects - ###
YUN_improve_kunming_effect = {
	if = {
		limit = { has_idea = YUN_kunming_military_academy }
		swap_ideas = {
			remove_idea = YUN_kunming_military_academy
			add_idea = YUN_kunming_military_academy_level_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_kunming_military_academy_level_2 }
		swap_ideas = {
			remove_idea = YUN_kunming_military_academy_level_2
			add_idea = YUN_kunming_military_academy_level_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_kunming_military_academy_level_3 } #Fallback
		every_unit_leader = {
			gain_xp = 200
		}
	}
	else = {
		add_ideas = YUN_kunming_military_academy
	}
}
YUN_improve_autonomous_armies_effect = {
	if = {
		limit = { has_idea = YUN_autonomous_armies_level0 }
		swap_ideas = {
			remove_idea = YUN_autonomous_armies_level0
			add_idea = YUN_autonomous_armies_level1
		}
		country_lock_all_division_template = yes
	}
	else_if = {
		limit = { has_idea = YUN_autonomous_armies_level1 }
		swap_ideas = {
			remove_idea = YUN_autonomous_armies_level1
			add_idea = YUN_autonomous_armies_level2
		}
	}
	else_if = {
		limit = { has_idea = YUN_autonomous_armies_level2 } #Fallback
		every_unit_leader = {
			gain_xp = 200
		}
	}
	else = {
		custom_effect_tooltip = YUN_improve_aa_tt
	}
}

YUN_improve_legacy_of_the_huguojun_effect = {
	if = {
		limit = { has_idea = YUN_autonomous_armies_level2 }
		swap_ideas = {
			remove_idea = YUN_autonomous_armies_level2
			add_idea = YUN_legacy_of_the_huguojun_level_1
		}
	}
	else_if = {
		limit = { has_idea = YUN_legacy_of_the_huguojun_level_1 }
		swap_ideas = {
			remove_idea = YUN_legacy_of_the_huguojun_level_1
			add_idea = YUN_legacy_of_the_huguojun_level_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_legacy_of_the_huguojun_level_2 }
		swap_ideas = {
			remove_idea = YUN_legacy_of_the_huguojun_level_2
			add_idea = YUN_legacy_of_the_huguojun_level_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_legacy_of_the_huguojun_level_3 } #Fallback
		every_unit_leader = {
			gain_xp = 200
		}
	}
	else = {
		custom_effect_tooltip = YUN_improve_huguojun_tt
	}
}

YUN_improve_rejuvenation_of_national_struggle_effect = {
	if = {
		limit = { has_idea = YUN_autonomous_armies_level2 }
		swap_ideas = {
			remove_idea = YUN_autonomous_armies_level2
			add_idea = YUN_rejuvenation_of_national_struggle_level_1
		}
	}
	else_if = {
		limit = { has_idea = YUN_rejuvenation_of_national_struggle_level_1 }
		swap_ideas = {
			remove_idea = YUN_rejuvenation_of_national_struggle_level_1
			add_idea = YUN_rejuvenation_of_national_struggle_level_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_rejuvenation_of_national_struggle_level_2 }
		swap_ideas = {
			remove_idea = YUN_rejuvenation_of_national_struggle_level_3
			add_idea = YUN_rejuvenation_of_national_struggle_level_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_rejuvenation_of_national_struggle_level_3 } #Fallback
		every_unit_leader = {
			gain_xp = 200
		}
	}
	else = {
		custom_effect_tooltip = YUN_improve_national_struggle_tt
	}
}

YUN_isolation_effect = {
	if = {
		limit = { controls_state = 603 }
		603 = {
			add_building_construction = {
				type = bunker
				province = 9939
				level = 1
				instant_build = yes
			}
		}
		603 = {
			add_building_construction = {
				type = bunker
				province = 8095
				level = 1
				instant_build = yes
			}
		}
		603 = {
			add_building_construction = {
				type = bunker
				province = 10616
				level = 1
				instant_build = yes
			}
		}
		603 = {
			add_building_construction = {
				type = bunker
				province = 4532
				level = 1
				instant_build = yes
			}
		}
	}
	if = {
		limit = { controls_state = 1051 }
		1051 = {
			add_building_construction = {
				type = bunker
				province = 1184
				level = 1
				instant_build = yes
			}
		}
	}
	if = {
		limit = { controls_state = 325 }
		325 = {
			add_building_construction = {
				type = bunker
				province = 1172
				level = 1
				instant_build = yes
			}
		}
	}
}

########################################
######- Section 04: Late Game - ########
########################################

YUN_transition_economy_effect = {
	hidden_effect = {
		remove_ideas = YUN_industrial_economy_idea1
		remove_ideas = YUN_industrial_economy_idea2a
		remove_ideas = YUN_industrial_economy_idea3a
		remove_ideas = YUN_industrial_economy_idea4a
		remove_ideas = YUN_industrial_economy_idea5a
		remove_ideas = YUN_industrial_economy_idea2b
		remove_ideas = YUN_industrial_economy_idea3b
		remove_ideas = YUN_industrial_economy_idea4b
		remove_ideas = YUN_industrial_economy_idea5b
		remove_ideas = YUN_militarised_state_idea1
		remove_ideas = YUN_militarised_state_idea2a
		remove_ideas = YUN_militarised_state_idea3a
		remove_ideas = YUN_militarised_state_idea4a
		remove_ideas = YUN_militarised_state_idea5a
		remove_ideas = YUN_militarised_state_idea2b
		remove_ideas = YUN_militarised_state_idea3b
		remove_ideas = YUN_militarised_state_idea4b
		remove_ideas = YUN_militarised_state_idea5b
		remove_ideas = YUN_agrarian_economy_idea1
		remove_ideas = YUN_agrarian_economy_idea2a
		remove_ideas = YUN_agrarian_economy_idea3a
		remove_ideas = YUN_agrarian_economy_idea4a
		remove_ideas = YUN_agrarian_economy_idea5a
		remove_ideas = YUN_agrarian_economy_idea2b
		remove_ideas = YUN_agrarian_economy_idea3b
		remove_ideas = YUN_agrarian_economy_idea4b
		remove_ideas = YUN_agrarian_economy_idea5b
		remove_ideas = YUN_national_defence_economy_idea
		remove_ideas = YUN_economic_stability_idea
		remove_ideas = YUN_rising_dragon_idea
		remove_ideas = YUN_awaken_tiger_idea
		remove_ideas = YUN_revolutionary_economy_idea
		remove_ideas = YUN_reformed_state_idea
		if = {
			limit = { has_completed_focus = YUN_resurgent_south }
			if = {
				limit = { controls_state = 592 } #Guangzhou
				592 = {
					add_dynamic_modifier = {
						modifier = YUN_phase3_econ_tree_reward_state_modifier
					}
				}
			}
			if = {
				limit = { controls_state = 594 } #Nanning
				594 = {
					add_dynamic_modifier = {
						modifier = YUN_phase3_econ_tree_reward_state_modifier
					}
				}
			}
			if = {
				limit = { controls_state = 325 } #Kunming
				325 = {
					add_dynamic_modifier = {
						modifier = YUN_phase3_econ_tree_reward_state_modifier
					}
				}
			}
			if = {
				limit = { controls_state = 1051 } #Guiyang
				1051 = {
					add_dynamic_modifier = {
						modifier = YUN_phase3_econ_tree_reward_state_modifier
					}
				}
			}
			if = {
				limit = { controls_state = 602 } #Changsha
				602 = {
					add_dynamic_modifier = {
						modifier = YUN_phase3_econ_tree_reward_state_modifier
					}
				}
			}
		}
	}
}

YUN_expand_public_education_effect = {
	if = {
		limit = { has_character = GXC_yu_youren }
		if = {
			limit = {
				GXC_yu_youren = { is_political_advisor = yes }
				OR = {
					YUN_dai_jitao = { is_political_advisor = yes }
					YUN_dai_jitao = { is_second_in_command = yes }
				}
			}
			add_timed_idea = {
				idea = YUN_mass_education_efforts
				days = 250
			}
		}
		else_if = {
			limit = {
				OR = {
					GXC_yu_youren = { is_political_advisor = yes }
					YUN_dai_jitao = { is_political_advisor = yes }
					YUN_dai_jitao = { is_second_in_command = yes }
				}
			}
			add_timed_idea = {
				idea = YUN_mass_education_efforts
				days = 200
			}
		}
		else = {
			add_timed_idea = {
				idea = YUN_mass_education_efforts_poor
				days = 200
			}
		}
	}
	else = {
		add_timed_idea = {
			idea = YUN_mass_education_efforts_poor
			days = 200
		}
	}
}

YUN_civil_war_NPA_effect = {
	if = {
		limit = { has_dlc_lar = yes }
		if = {
			limit = { has_war_with = HNN }
			add_intel = {
				target = HNN
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = SZC }
			add_intel = {
				target = SZC
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = SHD }
			add_intel = {
				target = SHD
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = LEP }
			add_intel = {
				target = LEP
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = SHX }
			add_intel = {
				target = SHX
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = ANQ }
			add_intel = {
				target = ANQ
				army_intel = 30
			}
		}
		else_if = {
			limit = { has_war_with = FNG }
			add_intel = {
				target = FNG
				army_intel = 30
			}
		}
		else = {
			add_intel = {
				target = QIE
				army_intel = 30
			}
		}
	}
	else = {
		if = {
			limit = { has_war_with = HNN }
			add_decryption = {
				target = HNN
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = SZC }
			add_decryption = {
				target = SZC
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = LEP }
			add_decryption = {
				target = LEP
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = SHD }
			add_decryption = {
				target = SHD
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = SHX }
			add_decryption = {
				target = SHX
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = ANQ }
			add_decryption = {
				target = ANQ
				ratio = 0.25
			}
		}
		else_if = {
			limit = { has_war_with = FNG }
			add_decryption = {
				target = FNG
				ratio = 0.25
			}
		}
		else = {
			add_decryption = {
				target = QIE
				ratio = 0.25
			}
		}
	}
}

YUN_expand_the_legislative_yuan_effect = {
	if = {
		limit = {
			YUN_chen_Cheng = { is_political_advisor = yes }
			YUN_chen_lifu = { is_political_advisor = yes }
			YUN_yang_yongtai = { is_political_advisor = yes }
		}
		add_timed_idea = {
			idea = YUN_stimulated_civil_bureaucracy_max
			days = 200
		}
	}
	else_if = {
		limit = {
			OR = {
				AND = {
					YUN_chen_Cheng = { is_political_advisor = yes }
					YUN_chen_lifu = { is_political_advisor = yes }
				}
				AND = {
					YUN_chen_Cheng = { is_political_advisor = yes }
					YUN_yang_yongtai = { is_political_advisor = yes }
				}
				AND = {
					YUN_yang_yongtai = { is_political_advisor = yes }
					YUN_chen_lifu = { is_political_advisor = yes }
				}
			}
		}
		add_timed_idea = {
			idea = YUN_stimulated_civil_bureaucracy_tier_2
			days = 150
		}
	}
	else_if = {
		limit = {
			OR = {
				YUN_chen_Cheng = { is_political_advisor = yes }
				YUN_yang_yongtai = { is_political_advisor = yes }
				YUN_chen_lifu = { is_political_advisor = yes }
			}
		}
		add_timed_idea = {
			idea = YUN_stimulated_civil_bureaucracy
			days = 150
		}
	}
	else = {
		add_timed_idea = {
			idea = YUN_stimulated_civil_bureaucracy_weak
			days = 150
		}
	}
}

YUN_the_new_life_movement_effect = {
	if = {
		limit = {
			YUN_chen_lifu = { is_political_advisor = yes }
			OR = {
				YUN_dai_jitao = { is_political_advisor = yes }
				YUN_dai_jitao = { is_second_in_command = yes }
			}
			OR = {
				YUN_chen_guofu = { is_political_advisor = yes }
				YUN_chen_guofu = { is_second_in_command = yes }
			}
		}
		add_timed_idea = {
			idea = YUN_the_new_life_movement_idea
			days = 720
		}
		add_war_support = 0.10
	}
	else_if = {
		limit = {
			OR = {
				YUN_dai_jitao = { is_political_advisor = yes }
				YUN_dai_jitao = { is_second_in_command = yes }
				YUN_chen_lifu = { is_political_advisor = yes }
				YUN_chen_guofu = { is_political_advisor = yes }
				YUN_chen_guofu = { is_second_in_command = yes }
			}
		}
		add_timed_idea = {
			idea = YUN_the_new_life_movement_idea
			days = 720
		}
		add_war_support = 0.05
	}
	else = {
		add_timed_idea = {
			idea = YUN_the_new_life_movement_idea
			days = 360
		}
	}
}

###- Hu Hanmin Crisis Effects -###
YUN_KMT_hu_hanmin_crisis_part_1_clear_missions_effect = {
	remove_mission = YUN_he_yingqin_autocoup_mission
	remove_mission = YUN_hu_hanmins_outrage_mission
	remove_mission = YUN_position_forces_near_liangguang_mission
	remove_mission = YUN_liangguang_troop_stationing_mission
	remove_mission = YUN_divide_and_conquer_in_hunan_mission
	remove_mission = YUN_Hunan_Divided_and_Conquered_mission
	remove_mission = YUN_Secure_the_Southwest_mission
	remove_mission = YUN_The_Southwest_Submits_mission

	remove_targeted_decision = { target = THIS decision = YUN_Loyalty_Tests_in_the_Bureaucracy_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Increase_Propaganda_Output_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Campaign_of_Intimidation_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Leverage_Whampoa_Connections_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Harness_the_Mass_Movement_decision }
}

YUN_KMT_hu_hanmin_crisis_part_2_clear_missions_effect = {
	#PSC Decisions
	remove_targeted_decision = { target = THIS decision = YUN_Pass_the_Provisional_Constitution_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Loyalty_Tests_in_the_Bureaucracy_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Promise_a_Constitutional_government_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Release_Political_Prisoners_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Bribe_Miliitary_Officers_decision }

	#CCC Decisions
	remove_targeted_decision = { target = THIS decision = YUN_Call_a_Vote_of_No_Confidence_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Increase_Propaganda_Output_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Stoke_Xenophobic_Hysteria_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Orchestrate_a_Walkout_of_the_Bureaucracy_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Mobilise_the_Political_Commissars_decision }

	#WPC/BSS Decisions
	remove_mission = YUN_The_Whampoa_Coup_mission
	remove_targeted_decision = { target = THIS decision = YUN_Leverage_Whampoa_Connections_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Campaign_of_Intimidation_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Remind_about_Foreign_Threats_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Encourage_Military_Disobedience_decision }

	#CEC & Other Decisions
	remove_targeted_decision = { target = THIS decision = YUN_Negotiate_with_the_SCPC_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Handle_the_Leftist_Bloc_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Negotiate_with_the_Dangwai_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Harness_the_Mass_Movement_decision }
	remove_targeted_decision = { target = THIS decision = YUN_Bribe_Miliitary_Officers_decision }
}

YUN_KMT_hu_hanmin_crisis_MCC_zeal_effect = {
	custom_effect_tooltip = YUN_KMT_hu_hanmin_crisis_MCC_tt
	if = {
		limit = { social_conservative < 0.10 }
		RKT_ext_zeal_small_effect = yes
	}
	else_if = {
		limit = { social_conservative < 0.15 }
		RKT_ext_zeal_medium_effect = yes
	}
	else_if = {
		limit = { social_conservative < 0.25 }
		RKT_ext_zeal_large_effect = yes
	}
	else_if = {
		limit = { social_conservative < 0.35 }
		RKT_ext_zeal_mega_effect = yes
	}
	else = {
		RKT_ext_zeal_giga_effect = yes
	}
}

YUN_KMT_hu_hanmin_crisis_PSC_delegates_effect = {
	#Requires an external temp variable (MUST BE A DECIMAL!!!): YUN_PSC_delegate_change_temp_var

	multiply_temp_variable = { YUN_PSC_delegate_change_temp_var = 502 } #Calculates a number of seats equivalent to % out of 502 (range from -502 to 502)
	round_temp_variable = YUN_PSC_delegate_change_temp_var #Makes sure it is a whole number
	custom_effect_tooltip = YUN_KMT_hu_hanmin_crisis_PSC_delegates_tt #NOTE THIS MUST BE AT THE BOTTOM FOR IT TO WORK
	add_to_variable = { YUN_PSC_aligned_delegates_variable = YUN_PSC_delegate_change_temp_var }
	clamp_variable = {
		var = YUN_PSC_aligned_delegates_variable
		min = 0
		max = 502
	}
}

YUN_KMT_hu_hanmin_crisis_CCC_delegates_effect = {
	#Requires an external temp variable (MUST BE A DECIMAL!!!): YUN_CCC_delegate_change_temp_var

	multiply_temp_variable = { YUN_CCC_delegate_change_temp_var = 502 } #Calculates a number of seats equivalent to % out of 502 (range from -502 to 502)
	round_temp_variable = YUN_CCC_delegate_change_temp_var #Makes sure it is a whole number
	custom_effect_tooltip = YUN_KMT_hu_hanmin_crisis_CCC_delegates_tt #NOTE THIS MUST BE AT THE BOTTOM FOR IT TO WORK
	add_to_variable = { YUN_CCC_aligned_delegates_variable = YUN_CCC_delegate_change_temp_var }
	clamp_variable = {
		var = YUN_CCC_aligned_delegates_variable
		min = 0
		max = 502
	}
}

YUN_KMT_hu_hanmin_crisis_PP_penalty_effect = {
	set_temp_variable = { YUN_KMT_hu_hanmin_crisis_PP_penalty_temp_var = YUN_CCC_aligned_delegates_variable } #So from 0-502
	divide_temp_variable = { YUN_KMT_hu_hanmin_crisis_PP_penalty_temp_var = 502 } #Getting a fraction out of 502, so 0 to 1
	multiply_temp_variable = { YUN_KMT_hu_hanmin_crisis_PP_penalty_temp_var = -300 } #Will get you a number between 0 and 0.25. Assuming you had maybe 10%? Seats (so 50), that's 30 PP penalty.
	add_political_power = YUN_KMT_hu_hanmin_crisis_PP_penalty_temp_var
}

YUN_KMT_hu_hanmin_crisis_STB_penalty_effect = {
	set_temp_variable = { YUN_KMT_hu_hanmin_crisis_STB_penalty_temp_var = YUN_PSC_aligned_delegates_variable } #So from 0-502
	divide_temp_variable = { YUN_KMT_hu_hanmin_crisis_STB_penalty_temp_var = 502 } #Getting a fraction out of 502, so 0 to 1
	multiply_temp_variable = { YUN_KMT_hu_hanmin_crisis_STB_penalty_temp_var = -0.50 } #Will get you a number between 0 and 0.25. Assuming you had maybe 10%? Seats (so 50), that's 5% stability penalty.
	add_stability = YUN_KMT_hu_hanmin_crisis_STB_penalty_temp_var
}

YUN_KMT_hu_hanmin_crisis_WS_penalty_effect = {
	set_temp_variable = { YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var = days_mission_timeout@YUN_The_Whampoa_Coup_mission } #So from 0-100ish, theoretically infinite but should be between 0-100
	add_to_temp_variable = { YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var = -100 } #So at 100 days its 0, at 10 days it is -45.
	multiply_temp_variable = { YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var = 0.5 } #So one half of the days remaining (0-50ish).
	round_temp_variable = YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var #Gets you a nice integer.
	multiply_temp_variable = { YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var = 0.01 } #Gives you about decimal -0.50 to 0. So you can lose up to 50% WS.
	add_war_support = YUN_KMT_hu_hanmin_crisis_WS_penalty_temp_var
}

###- Luliang Crisis Effects -###
YUN_YCD_victory_in_satellite_effect = {
	YUN_tang_jiyao = {
		retire = yes
	}
	country_event = { id = YUN.lategame.740 days = 320 random_days = 80 } #The Death of Tang Jiyao
	set_country_flag = YUN_UPC_satellite_election_path_flag
	YUN_cun_shusheng = { CHN_recruit_character_effect = yes }
	YUN_su_honggang = { CHN_recruit_character_effect = yes }
	promote_character = {
		character = YUN_cun_shusheng
		ideology = social_democrat_subtype
	}
	#Swap PGP to Mar Lib
	promote_character = {
		character = YUN_tang_xiaoying
		ideology = authoritarian_democrat_subtype
	}
	promote_character = {
		character = YUN_tang_xiaoying
		ideology = market_liberal_subtype
	}
	set_party_name = {
		ideology = market_liberal
		long_name = UPC_PGP_exiled_party_long
		name = UPC_PGP_exiled_party
	}
	#YCC goes to Soc Con
	promote_character = {
		character = YUN_miao_yuntai
		ideology = social_conservative_subtype
	}
	set_party_name = {
		ideology = social_conservative
		long_name = YUN_chamber_of_commerce_party_long
		name = YUN_chamber_of_commerce_party
	}
}

YUN_TJY_victory_in_satellite_effect = {
	country_event = { id = YUN.lategame.730 days = 320 random_days = 80 } #Tang’s 4 Heavenly Kings
	YUN_tang_jiyao = { CHN_recruit_character_effect = yes }
	promote_character = {
		character = YUN_tang_jiyao
		ideology = social_conservative_subtype
	}
	promote_character = {
		character = YUN_tang_jiyao
		ideology = authoritarian_democrat_subtype
	}
	promote_character = {
		character = YUN_assorted_leaders
		ideology = social_democrat_subtype
	}
	promote_character = {
		character = YUN_assorted_leaders
		ideology = paternal_autocrat_subtype
	}
}

YUN_provincial_economic_committee_effect = {
	if = {
		limit = { has_idea = YUN_the_yunnan_provincial_economic_committee_3 }
		swap_ideas = {
			remove_idea = YUN_the_yunnan_provincial_economic_committee_3
			add_idea = YUN_the_yunnan_provincial_economic_committee_4
		}
	}
	else_if = {
		limit = { has_idea = YUN_the_yunnan_provincial_economic_committee_2 }
		swap_ideas = {
			remove_idea = YUN_the_yunnan_provincial_economic_committee_2
			add_idea = YUN_the_yunnan_provincial_economic_committee_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_the_yunnan_provincial_economic_committee }
		swap_ideas = {
			remove_idea = YUN_the_yunnan_provincial_economic_committee
			add_idea = YUN_the_yunnan_provincial_economic_committee_2
		}
	}
}

########################################
######- Section 05: End Game - #########
########################################
YUN_singular_organ_of_economic_society_effect = {
	if = {
		limit = { has_idea = YUN_woes_of_nationalism_idea }
		swap_ideas = {
			remove_idea = YUN_woes_of_nationalism_idea
			add_idea = YUN_woes_of_nationalism2_idea
		}
	}
	else_if = {
		limit = { has_idea = YUN_woes_of_nationalism2_idea }
		remove_ideas = YUN_woes_of_nationalism2_idea
	}
}
YUN_unruly_opposition_effect = {
	if = {
		limit = { has_idea = YUN_unruly_opposition_idea }
		swap_ideas = {
			remove_idea = YUN_unruly_opposition_idea
			add_idea = YUN_unruly_opposition2_idea
		}
	}
	else_if = {
		limit = { has_idea = YUN_unruly_opposition2_idea }
		remove_ideas = YUN_unruly_opposition2_idea
	}
}
YUN_disgruntled_whampoa_effect = {
	if = {
		limit = { has_idea = YUN_disgruntled_whampoa_idea }
		swap_ideas = {
			remove_idea = YUN_disgruntled_whampoa_idea
			add_idea = YUN_disgruntled_whampoa2_idea
		}
	}
	else_if = {
		limit = { has_idea = YUN_disgruntled_whampoa2_idea }
		remove_ideas = YUN_disgruntled_whampoa2_idea
	}
}

YUN_cardinal_principles_effect = {
	if = {
		limit = {
			has_government = paternal_autocrat
		}
		if = {
			limit = { has_dlc_lar = no }
			hidden_effect = {
				remove_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher
				}
				add_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher_2
				}
			}
			custom_effect_tooltip = tooltip_white_line
			effect_tooltip = {
				add_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher_2
				}
			}
		}
		else = {
			hidden_effect = {
				remove_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher_lar
				}
				add_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher_lar_2
				}
			}
			custom_effect_tooltip = tooltip_white_line
			effect_tooltip = {
				add_trait = {
					character = YUN_chen_lifu
					slot = political_advisor
					trait = YUN_energetic_brainwasher_lar_2
				}
			}
		}
	}
	else = {
		hidden_effect = {
			remove_trait = {
				character = YUN_dai_jitao
				slot = political_advisor
				trait = KR_spiritual_leader
			}
			add_trait = {
				character = YUN_dai_jitao
				slot = political_advisor
				trait = YUN_progenitor_of_the_new_right
			}
		}
		custom_effect_tooltip = tooltip_white_line
		effect_tooltip = {
			add_trait = {
				character = YUN_dai_jitao
				slot = political_advisor
				trait = YUN_progenitor_of_the_new_right
			}
		}
	}
}

YUN_revolutionary_datong_pat_aut_nanjing_effect = {
	613 = { #Nanjing
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_pat_aut_guangzhou_effect = {
	592 = { #Guangzhou
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_pat_aut_wuhan_effect = {
	1048 = { #Wuhan
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_pat_aut_beijing_effect = {
	608 = { #Beijing
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_pat_aut_effect = {
	custom_effect_tooltip = YUN_pat_aut_revolutionary_datong_effect_tt
	set_temp_variable = { YUN_pat_aut_revolutionary_datong_var = party_popularity@paternal_autocrat }
	multiply_temp_variable = { YUN_pat_aut_revolutionary_datong_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_pat_aut_revolutionary_datong_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_pat_aut_revolutionary_datong_var
	if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 2 } }
		613 = { #Nanjing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 3 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 4 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		592 = { #Guangzhou
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 5 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 6 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		1048 = { #Wuhan
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 7 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		YUN_revolutionary_datong_pat_aut_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 8 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		YUN_revolutionary_datong_pat_aut_wuhan_effect = yes
		608 = { #Beijing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 9 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		YUN_revolutionary_datong_pat_aut_wuhan_effect = yes
		YUN_revolutionary_datong_pat_aut_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 10 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		YUN_revolutionary_datong_pat_aut_wuhan_effect = yes
		YUN_revolutionary_datong_pat_aut_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_pat_aut_revolutionary_datong_var < 11 } }
		YUN_revolutionary_datong_pat_aut_nanjing_effect = yes
		YUN_revolutionary_datong_pat_aut_guangzhou_effect = yes
		YUN_revolutionary_datong_pat_aut_wuhan_effect = yes
		YUN_revolutionary_datong_pat_aut_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
}
YUN_revolutionary_datong_aut_dem_nanjing_effect = {
	613 = { #Nanjing
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_aut_dem_guangzhou_effect = {
	592 = { #Guangzhou
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_aut_dem_wuhan_effect = {
	1048 = { #Wuhan
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_aut_dem_beijing_effect = {
	608 = { #Beijing
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}
YUN_revolutionary_datong_aut_dem_effect = {
	custom_effect_tooltip = YUN_aut_dem_revolutionary_datong_effect_tt
	set_temp_variable = { YUN_aut_dem_revolutionary_datong_var = party_popularity@authoritarian_democrat }
	multiply_temp_variable = { YUN_aut_dem_revolutionary_datong_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_aut_dem_revolutionary_datong_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_aut_dem_revolutionary_datong_var
	if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 2 } }
		613 = { #Nanjing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 3 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		592 = { #Guangzhou
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 5 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		1048 = { #Wuhan
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 7 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		608 = { #Beijing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 9 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 10 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_aut_dem_revolutionary_datong_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
}

YUN_broaden_the_social_base_effect = {
	custom_effect_tooltip = YUN_broaden_the_social_base_effect_tt
	set_temp_variable = { YUN_broaden_the_social_base_temp_var = party_popularity@social_democrat }
	add_to_temp_variable = { YUN_broaden_the_social_base_temp_var = party_popularity@radical_socialist }
	add_to_temp_variable = { YUN_broaden_the_social_base_temp_var = party_popularity@syndicalist }
	add_to_temp_variable = { YUN_broaden_the_social_base_temp_var = party_popularity@totalist }
	multiply_temp_variable = { YUN_broaden_the_social_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_broaden_the_social_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_broaden_the_social_base_temp_var
	if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 2 } }
		613 = { #Nanjing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 3 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		592 = { #Guangzhou
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 5 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		1048 = { #Wuhan
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 7 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		608 = { #Beijing
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 9 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 10 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
	else_if = {
		limit = { check_variable = { YUN_broaden_the_social_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_a_mixed_economic_system_effect = {
	custom_effect_tooltip = YUN_a_mixed_economic_system_effect_tt
	set_temp_variable = { YUN_a_mixed_economic_system_base_temp_var = party_popularity@market_liberal }
	multiply_temp_variable = { YUN_a_mixed_economic_system_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_a_mixed_economic_system_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_a_mixed_economic_system_base_temp_var
	if = {
		limit = { check_variable = { YUN_a_mixed_economic_system_base_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_a_mixed_economic_system_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_a_mixed_economic_system_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_a_mixed_economic_system_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_a_mixed_economic_system_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_negotiate_with_shanghai_compradors_effect = {
	custom_effect_tooltip = YUN_negotiate_with_shanghai_compradors_effect_tt
	set_temp_variable = { YUN_negotiate_with_shanghai_compradors_temp_var = party_popularity@national_populist }
	multiply_temp_variable = { YUN_negotiate_with_shanghai_compradors_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_negotiate_with_shanghai_compradors_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_negotiate_with_shanghai_compradors_temp_var
	if = {
		limit = { check_variable = { YUN_negotiate_with_shanghai_compradors_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_negotiate_with_shanghai_compradors_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_negotiate_with_shanghai_compradors_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_negotiate_with_shanghai_compradors_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_negotiate_with_shanghai_compradors_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_political_consultative_conference_effect = {
	custom_effect_tooltip = YUN_political_consultative_conference_effect_tt
	custom_effect_tooltip = tooltip_white_line
	set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
	set_temp_variable = { YUN_national_populist_pop_temp_var = party_popularity@national_populist }
	set_temp_variable = { YUN_radical_influence_var = YUN_social_democrat_pop_temp_var }
	add_to_temp_variable = { YUN_radical_influence_var = YUN_national_populist_pop_temp_var }
	set_temp_variable = { YUN_radical_influence_var_neg_var = YUN_radical_influence_var }
	multiply_temp_variable = { YUN_radical_influence_var_neg_var = -300 }
	multiply_temp_variable = { YUN_social_democrat_pop_temp_var = -1 }
	multiply_temp_variable = { YUN_national_populist_pop_temp_var = -1 }
	add_stability = YUN_radical_influence_var
	add_political_power = YUN_radical_influence_var_neg_var
	add_popularity = { ideology = social_democrat popularity = YUN_social_democrat_pop_temp_var }
	add_popularity = { ideology = national_populist popularity = YUN_national_populist_pop_temp_var }
}

YUN_reinterpret_the_three_principles_effect = {
	custom_effect_tooltip = YUN_reinterpret_the_three_principles_effect_tt
	custom_effect_tooltip = tooltip_white_line
	set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
	set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
	set_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = party_popularity@authoritarian_democrat }
	set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
	set_temp_variable = { YUN_conservative_var = YUN_social_democrat_pop_temp_var }
	add_to_temp_variable = { YUN_conservative_var = YUN_market_liberal_pop_temp_var }
	add_to_temp_variable = { YUN_conservative_var = YUN_authoritarian_democrat_pop_temp_var }
	add_to_temp_variable = { YUN_conservative_var = YUN_social_conservative_pop_temp_var }
	set_temp_variable = { YUN_conservative_var_neg_var = YUN_conservative_var }
	multiply_temp_variable = { YUN_conservative_var = 100 }
	multiply_temp_variable = { YUN_conservative_var_neg_var = -0.5 }
	multiply_temp_variable = { YUN_social_democrat_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_market_liberal_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_social_conservative_pop_temp_var = -0.5 }
	add_stability = YUN_conservative_var_neg_var
	add_political_power = YUN_conservative_var
	add_popularity = { ideology = social_democrat popularity = YUN_social_democrat_pop_temp_var }
	add_popularity = { ideology = market_liberal popularity = YUN_market_liberal_pop_temp_var }
	add_popularity = { ideology = authoritarian_democrat popularity = YUN_authoritarian_democrat_pop_temp_var }
	add_popularity = { ideology = social_conservative popularity = YUN_social_conservative_pop_temp_var }
}

YUN_further_the_blueshirt_revolution_effect = {
	if = {
		limit = { has_idea = YUN_blueshirt_national_revolution }
		swap_ideas = {
			remove_idea = YUN_blueshirt_national_revolution
			add_idea = YUN_blueshirt_national_revolution_2
		}
	}
	else_if = {
		limit = { has_idea = YUN_blueshirt_national_revolution_2 }
		swap_ideas = {
			remove_idea = YUN_blueshirt_national_revolution_2
			add_idea = YUN_blueshirt_national_revolution_3
		}
	}
	else_if = {
		limit = { has_idea = YUN_blueshirt_national_revolution_3 }
		swap_ideas = {
			remove_idea = YUN_blueshirt_national_revolution_3
			add_idea = YUN_blueshirt_national_revolution_4
		}
	}
	else = {
		add_ideas = YUN_blueshirt_national_revolution
	}
}

YUN_an_antidote_for_economic_woes = {
	custom_effect_tooltip = YUN_an_antidote_for_economic_woes_effect_tt
	set_temp_variable = { YUN_an_antidote_for_economic_woes_base_temp_var = party_popularity@social_liberal }
	set_temp_variable = { YUN_radical_socialist_pop_temp_var = party_popularity@radical_socialist }
	set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
	multiply_temp_variable = { YUN_radical_socialist_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_social_conservative_pop_temp_var = 0.5 }
	add_to_temp_variable = { YUN_an_antidote_for_economic_woes_base_temp_var = YUN_radical_socialist_pop_temp_var }
	add_to_temp_variable = { YUN_an_antidote_for_economic_woes_base_temp_var = YUN_social_conservative_pop_temp_var }
	multiply_temp_variable = { YUN_an_antidote_for_economic_woes_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_an_antidote_for_economic_woes_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_an_antidote_for_economic_woes_base_temp_var
	if = {
		limit = { check_variable = { YUN_an_antidote_for_economic_woes_base_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_an_antidote_for_economic_woes_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_an_antidote_for_economic_woes_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_an_antidote_for_economic_woes_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_an_antidote_for_economic_woes_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_draft_a_permanent_constitution_effect = {
	custom_effect_tooltip = YUN_draft_a_permanent_constitution_effect_tt
	custom_effect_tooltip = tooltip_white_line
	set_temp_variable = { YUN_paternal_autocrat_pop_temp_var = party_popularity@paternal_autocrat }
	set_temp_variable = { YUN_national_populist_pop_temp_var = party_popularity@national_populist }
	set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
	set_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = party_popularity@authoritarian_democrat }
	set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
	set_temp_variable = { YUN_authoritarian_influence_var = YUN_paternal_autocrat_pop_temp_var }
	add_to_temp_variable = { YUN_authoritarian_influence_var = YUN_national_populist_pop_temp_var }
	add_to_temp_variable = { YUN_authoritarian_influence_var = YUN_social_conservative_pop_temp_var }
	add_to_temp_variable = { YUN_authoritarian_influence_var = YUN_authoritarian_democrat_pop_temp_var }
	add_to_temp_variable = { YUN_authoritarian_influence_var = YUN_social_democrat_pop_temp_var }
	set_temp_variable = { YUN_authoritarian_influence_var_neg_var = YUN_authoritarian_influence_var }
	multiply_temp_variable = { YUN_authoritarian_influence_var_neg_var = -100 }
	multiply_temp_variable = { YUN_paternal_autocrat_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_national_populist_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_social_democrat_pop_temp_var = -0.5 }
	multiply_temp_variable = { YUN_social_conservative_pop_temp_var = -0.5 }
	set_temp_variable = { YUN_social_liberal_pop_temp_var = party_popularity@social_liberal }
	set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
	set_temp_variable = { YUN_democratic_influence_var = YUN_social_liberal_pop_temp_var }
	add_to_temp_variable = { YUN_democratic_influence_var = YUN_market_liberal_pop_temp_var }
	#multiply_temp_variable = { YUN_democratic_influence_var = 100 }
	add_stability = YUN_democratic_influence_var
	add_political_power = YUN_authoritarian_influence_var_neg_var
	add_popularity = { ideology = paternal_autocrat popularity = YUN_paternal_autocrat_pop_temp_var }
	add_popularity = { ideology = national_populist popularity = YUN_national_populist_pop_temp_var }
	add_popularity = { ideology = social_conservative popularity = YUN_social_conservative_pop_temp_var }
	add_popularity = { ideology = authoritarian_democrat popularity = YUN_authoritarian_democrat_pop_temp_var }
	add_popularity = { ideology = social_democrat popularity = YUN_social_democrat_pop_temp_var }
}

YUN_KMT_satellite_civil_war_winner_effect = {
	set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
	set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
	set_temp_variable = { YUN_third_army_influence_var = YUN_social_conservative_pop_temp_var }
	set_temp_variable = { YUN_rightist_opposition_var = party_popularity@authoritarian_democrat }
	set_temp_variable = { YUN_CEC_influence_Var = party_popularity@social_democrat }
	add_to_temp_variable = { YUN_rightist_opposition_var = YUN_CEC_influence_Var }
	add_to_temp_variable = { YUN_rightist_opposition_var = YUN_third_army_influence_var }
	add_to_temp_variable = { YUN_third_army_influence_var = YUN_market_liberal_pop_temp_var }
	set_temp_variable = { YUN_KMT_influence_var = YUN_CEC_influence_Var }
	add_to_temp_variable = { YUN_KMT_influence_var = YUN_third_army_influence_var }
	#Rig it if you have game rules
	if = {
		limit = {
			has_game_rule = { rule = YUN_KMT_path option = YUN_KMT_PATH_RADSOC }
		}
		country_event = { id = YUN.lategame.510 days = 5 } #Zhu De's Coup
	}
	else_if = {
		limit = {
			has_game_rule = { rule = YUN_KMT_path option = YUN_KMT_PATH_SOCDEM }
		}
		country_event = { id = YUN.lategame.512 days = 5 } #Chen Cheng Seizes Kunming
	}
	else_if = {
		limit = {
			OR = {
				has_game_rule = { rule = YUN_KMT_path option = YUN_KMT_PATH_GENYUAN_MARLIB }
				has_game_rule = { rule = YUN_KMT_path option = YUN_KMT_PATH_SOCCON }
			}
		}
		country_event = { id = YUN.lategame.513 days = 5 } #Zhu and Li Holdout in Kunming
	}
	#Normal Code
	else_if = {
		limit = {
			has_country_flag = YUN_Zhang_Bojun_Arrived_Flag
			radical_socialist > YUN_rightist_opposition_var
		}
		country_event = { id = YUN.lategame.510 days = 5 } #Zhu De's Coup
	}
	else_if = {
		limit = { authoritarian_democrat > YUN_KMT_influence_var }
		country_event = { id = YUN.lategame.511 days = 5 } #Hu Ruoyu Marches on Kunming
	}
	else_if = {
		limit = { social_democrat > YUN_third_army_influence_var }
		country_event = { id = YUN.lategame.512 days = 5 } #Chen Cheng Seizes Kunming
	}
	else = {
		country_event = { id = YUN.lategame.513 days = 5 } #Zhu and Li Holdout in Kunming
	}
}

YUN_UPC_satellite_civil_war_winner_effect = {
	#Hu Ruoyu = Pat Aut + Mar Lib (just so every faction has 2 allies)
	set_temp_variable = { YUN_hu_ruoyu_influence_var = party_popularity@paternal_autocrat }
	add_to_temp_variable = { YUN_hu_ruoyu_influence_var = party_popularity@market_liberal }

	#Tang Jiyao = Auth Dem + Soc Con
	set_temp_variable = { YUN_tang_jiyao_influence_var = party_popularity@authoritarian_democrat }
	add_to_temp_variable = { YUN_tang_jiyao_influence_var = party_popularity@social_conservative }

	#Cun Shusheng = Soc Dem + Soc Lib
	set_temp_variable = { YUN_cun_shusheng_influence_var = party_popularity@social_democrat }
	add_to_temp_variable = { YUN_cun_shusheng_influence_var = party_popularity@social_liberal }

	#Rig it if game rules are set
	if = {
		limit = {
			OR = {
				has_game_rule = { rule = YUN_UPC_path option = YUN_UPC_PATH_SOCDEM }
				has_game_rule = { rule = YUN_UPC_path option = YUN_UPC_PATH_MARLIB }
				has_game_rule = { rule = YUN_UPC_path option = YUN_UPC_XIAOYING_AUTDEM }
			}
		}
		country_event = { id = YUN.lategame.711 days = 5 } #Opposition Putsch in Kunming
	}
	#Normal Code
	else_if = {
		limit = {
			check_variable = { YUN_hu_ruoyu_influence_var > YUN_tang_jiyao_influence_var }
			check_variable = { YUN_hu_ruoyu_influence_var > YUN_cun_shusheng_influence_var }
		}
		country_event = { id = YUN.lategame.710 days = 5 } #Hu Ruoyu seizes Kunming
	}
	else_if = {
		limit = {
			check_variable = { YUN_cun_shusheng_influence_var > YUN_tang_jiyao_influence_var }
		}
		country_event = { id = YUN.lategame.711 days = 5 } #Opposition Putsch in Kunming
	}
	else = {
		country_event = { id = YUN.lategame.712 days = 5 } #Tang Routs His Rivals
	}
}

YUN_the_saviour_of_the_nation_effect = {
	if = {
		limit = { has_country_leader = { character = YUN_tang_xiaoying } }
		custom_effect_tooltip = YUN_saviour_of_the_nation_xiaoying_tt
		set_temp_variable = { YUN_totalist_pop_temp_var = party_popularity@totalist }
		set_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = party_popularity@authoritarian_democrat }
		set_temp_variable = { YUN_radical_socialist_pop_temp_var = party_popularity@radical_socialist }
		set_temp_variable = { YUN_paternal_autocrat_pop_temp_var = party_popularity@paternal_autocrat }
		set_temp_variable = { YUN_stability_loss_temp_var = ROOT.party_popularity@social_conservative }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_totalist_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_conservative_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_radical_socialist_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_syndicalist_pop_temp_var }
		multiply_temp_variable = { YUN_stability_loss_temp_var = -1 }
		multiply_temp_variable = { YUN_stability_loss_temp_var = 0.33 }
		clamp_temp_variable = {
			var = YUN_stability_loss_temp_var
			min = -1
			max = 0
		}
		add_stability = YUN_stability_loss_temp_var
		custom_effect_tooltip = tooltip_white_line
		add_political_power = 50
	}
	else_if = {
		limit = {
			has_country_leader = { character = YUN_tang_jiyao }
			has_government = social_conservative
		}
		custom_effect_tooltip = YUN_saviour_of_the_nation_pgp_tt
		set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
		set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
		set_temp_variable = { YUN_social_liberal_pop_temp_var = party_popularity@social_liberal }
		set_temp_variable = { YUN_paternal_autocrat_pop_temp_var = party_popularity@paternal_autocrat }
		set_temp_variable = { YUN_stability_loss_temp_var = ROOT.party_popularity@radical_socialist }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_democrat_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_market_liberal_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_liberal_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_paternal_autocrat_pop_temp_var }
		multiply_temp_variable = { YUN_stability_loss_temp_var = -1 }
		multiply_temp_variable = { YUN_stability_loss_temp_var = 0.33 }
		clamp_temp_variable = {
			var = YUN_stability_loss_temp_var
			min = -1
			max = 0
		}
		add_stability = YUN_stability_loss_temp_var
		custom_effect_tooltip = tooltip_white_line
		add_political_power = 25
		army_experience = 25
	}
	else = {
		custom_effect_tooltip = YUN_saviour_of_the_nation_tjy_tt
		set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
		set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
		set_temp_variable = { YUN_social_liberal_pop_temp_var = party_popularity@social_liberal }
		set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
		set_temp_variable = { YUN_stability_loss_temp_var = ROOT.party_popularity@radical_socialist }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_democrat_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_market_liberal_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_liberal_pop_temp_var }
		add_to_temp_variable = { YUN_stability_loss_temp_var = YUN_social_conservative_pop_temp_var }
		multiply_temp_variable = { YUN_stability_loss_temp_var = -1 }
		multiply_temp_variable = { YUN_stability_loss_temp_var = 0.33 }
		clamp_temp_variable = {
			var = YUN_stability_loss_temp_var
			min = -1
			max = 0
		}
		add_stability = YUN_stability_loss_temp_var
		custom_effect_tooltip = tooltip_white_line
		army_experience = 50
	}
}

YUN_modernising_china_effect = {
	custom_effect_tooltip = YUN_modernising_china_tt
	set_temp_variable = { YUN_modernising_china_base_temp_var = party_popularity@social_conservative }
	set_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = party_popularity@authoritarian_democrat }
	set_temp_variable = { YUN_market_liberal_pop_temp_var = party_popularity@market_liberal }
	multiply_temp_variable = { YUN_authoritarian_democrat_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_market_liberal_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_modernising_china_base_temp_var = 0.5 }
	add_to_temp_variable = { YUN_modernising_china_base_temp_var = YUN_market_liberal_pop_temp_var }
	add_to_temp_variable = { YUN_modernising_china_base_temp_var = YUN_authoritarian_democrat_pop_temp_var }
	multiply_temp_variable = { YUN_modernising_china_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_modernising_china_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_modernising_china_base_temp_var
	if = {
		limit = { check_variable = { YUN_modernising_china_base_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_modernising_china_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_modernising_china_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_modernising_china_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_modernising_china_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_third_way_economics_effect = {
	custom_effect_tooltip = YUN_third_way_economics_tt
	set_temp_variable = { YUN_third_way_economics_base_temp_var = party_popularity@social_liberal }
	set_temp_variable = { YUN_social_democrat_pop_temp_var = party_popularity@social_democrat }
	set_temp_variable = { YUN_national_populist_pop_temp_var = party_popularity@national_populist }
	multiply_temp_variable = { YUN_social_democrat_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_national_populist_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_third_way_economics_base_temp_var = 0.5 }
	add_to_temp_variable = { YUN_third_way_economics_base_temp_var = YUN_national_populist_pop_temp_var }
	add_to_temp_variable = { YUN_third_way_economics_base_temp_var = YUN_social_democrat_pop_temp_var }
	multiply_temp_variable = { YUN_third_way_economics_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_third_way_economics_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_third_way_economics_base_temp_var
	if = {
		limit = { check_variable = { YUN_third_way_economics_base_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_third_way_economics_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_third_way_economics_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_third_way_economics_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_third_way_economics_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_extending_a_hand_to_the_gentry_effect = {
	custom_effect_tooltip = YUN_extending_a_hand_to_the_gentry_effect_tt
	set_temp_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var = party_popularity@authoritarian_democrat }
	set_temp_variable = { YUN_social_conservative_pop_temp_var = party_popularity@social_conservative }
	set_temp_variable = { YUN_paternal_autocrat_pop_temp_var = party_popularity@paternal_autocrat }
	multiply_temp_variable = { YUN_social_conservative_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_paternal_autocrat_pop_temp_var = 0.5 }
	multiply_temp_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var = 0.5 }
	add_to_temp_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var = YUN_social_conservative_pop_temp_var }
	add_to_temp_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var = YUN_paternal_autocrat_pop_temp_var }
	multiply_temp_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var = 10 } #Party Pop ranges from 0-1. Multiply it by ten so range is 0-10
	clamp_temp_variable = {
		var = YUN_extending_a_hand_to_the_gentry_base_temp_var
		min = 0
		max = 10
	}
	round_temp_variable = YUN_extending_a_hand_to_the_gentry_base_temp_var
	if = {
		limit = { check_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var < 2 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes #To save code repetition I am reusing the CCC effects
	}
	else_if = {
		limit = { check_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var < 4 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var < 6 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var < 8 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
	}
	else_if = {
		limit = { check_variable = { YUN_extending_a_hand_to_the_gentry_base_temp_var < 11 } }
		YUN_revolutionary_datong_aut_dem_nanjing_effect = yes
		YUN_revolutionary_datong_aut_dem_guangzhou_effect = yes
		YUN_revolutionary_datong_aut_dem_wuhan_effect = yes
		YUN_revolutionary_datong_aut_dem_beijing_effect = yes
		602 = { #Changsha
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

YUN_clear_popular_support_ideas = {
	remove_ideas = {
		YUN_UPC_popular_support_1
		YUN_UPC_popular_support_2
		YUN_UPC_popular_support_3
		YUN_UPC_popular_support_4
		YUN_UPC_popular_support_5

		YUN_UPC_popular_support_rule_of_the_expertocracy
		YUN_UPC_popular_support_anathema_to_popular_revolt
		YUN_UPC_popular_support_grand_republican_statesman
		YUN_UPC_popular_support_arbiters_of_the_nation
		YUN_UPC_popular_support_masters_of_the_eastern_continent
		YUN_UPC_popular_support_bearers_of_our_fathers_torches

		YUN_KMT_popular_support_1
		YUN_KMT_popular_support_2
		YUN_KMT_popular_support_3
		YUN_KMT_popular_support_4
		YUN_KMT_popular_support_5

		YUN_KMT_popular_support_ccc_idea
		YUN_KMT_popular_support_dai_jitao_idea
		YUN_KMT_popular_support_socialist_chen_cheng_idea
		YUN_KMT_popular_support_chen_cheng_idea
		YUN_KMT_popular_support_peoples_generalissimo_idea
		YUN_KMT_popular_support_revolutionary_generalissimo_idea
		YUN_KMT_popular_support_lucky_generalissimo_idea
		YUN_KMT_popular_support_liberal_generalissimo_idea
		YUN_KMT_popular_support_blueshirt_generalissimo_idea
		YUN_KMT_popular_support_blueshirt_revolution_idea
		YUN_KMT_popular_support_correspondence_of_the_liberals_idea
		YUN_KMT_popular_support_heirs_to_the_orthodox_idea
		YUN_KMT_popular_support_reform_through_hardship_idea
		YUN_KMT_popular_support_solidarity_of_the_people_and_nation_idea

		YUN_NPA_popular_support_1
		YUN_NPA_popular_support_2
		YUN_NPA_popular_support_3
		YUN_NPA_popular_support_4
		YUN_NPA_popular_support_5

		YUN_NPA_popular_support_the_democratic_fortress
		YUN_NPA_popular_support_the_guided_revolution
		YUN_NPA_popular_support_all_under_the_great_commander
		YUN_NPA_popular_support_the_new_age_of_export_militarism
	}
}
