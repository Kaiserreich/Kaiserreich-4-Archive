
USA_release_CSA = {
	hidden_effect = {
		CSA = {
			add_state_core = 395
			add_state_core = 394
			add_state_core = 393
			add_state_core = 396
			add_state_core = 261
			add_state_core = 360
			add_state_core = 929
			set_cosmetic_tag = CSA_ACW

			set_equipment_fraction = 0.35
			add_ideas = extensive_conscription
		}

		USA = {
			CSA = { transfer_technology = yes }
			if = {
				limit = { country_exists = TEX }
				load_oob = "USA_civil_war_reenforcments"
				set_cosmetic_tag = USA_ACW
				country_event = kr.political.208

				# pre-war events
				country_event = { id = amcivwar.311 hours = 8 } #MacArthur's Warning
				country_event = { id = amcivwar.300 days = 2 } #New England riots
				country_event = { id = amcivwar.301 days = 5 } #Minnesota
				country_event = { id = amcivwar.302 days = 7 } #North Carolina
				country_event = { id = amcivwar.303 days = 9 } #Tennessee
				country_event = { id = amcivwar.304 days = 12 } #New York/New Jersey
				country_event = { id = amcivwar.305 days = 12 } #New York/New Jersey
				country_event = { id = amcivwar.310 days = 15 } #Nevada
				country_event = { id = amcivwar.306 days = 18 } #Southern Texas
				country_event = { id = amcivwar.307 days = 20 } #Iowa
				country_event = { id = amcivwar.312 days = 25 } #Deadline Running Out

				# idea changes
				if = {
					limit = { has_idea = USA_black_monday }
					remove_ideas = USA_black_monday
				}
				if = {
					limit = { has_idea = USA_new_year_strike_idea }
					remove_ideas = USA_new_year_strike_idea
				}
				if = {
					limit = { has_idea = USA_political_crisis }
					remove_ideas = USA_political_crisis
				}
			}
			if = {
				limit = { has_country_flag = USA_reed_was_president }
				country_event = { id = amcivwar.2 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_long_was_president }
				country_event = { id = amcivwar.8 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_olson_was_president }
				news_event = { id = amcivwar.13 hours = 8 }
				country_event = { id = amcivwar.20 days = 30 }
			}
			else_if = {
				limit = { has_country_flag = USA_garner_was_president }
				news_event = { id = amcivwar.16 hours = 8 }
				country_event = { id = amcivwar.20 days = 30 }
			}
			else_if = {
				limit = { has_country_flag = USA_landon_was_president }
				news_event = { id = amcivwar.19 hours = 8 }
				country_event = { id = amcivwar.20 days = 30 }
			}
		}

		every_owned_state = {
			limit = { is_core_of = CSA }
			CSA = { transfer_state = PREV }
		}

		every_state = {
			limit = {
				is_core_of = USA
				NOT = { is_core_of = CSA }
				NOT = { is_claimed_by = CSA }
			}
			add_claim_by = CSA
		}

		set_country_flag = Jack_Reed_dead
		set_country_flag = Eugene_Dennis_dead
		set_country_flag = Paul_Mattick_dead
		set_country_flag = John_Abt_dead

		remove_unit_leader = 60 #Smedley Butler
		remove_unit_leader = 61 #Herbert Holdridge

		CSA = {
			load_oob = "USA_civil_war_csa_army"
			add_ideas = CSA_militia_idea
			if = {
				limit = { ACW_strengthen_CSA = no }
				add_timed_idea = {
					idea = CSA_initial_troubles
					days = 60
				}
			}
			add_stability = -0.25
			hidden_effect = {
				country_event = { id = csa.150 days = 6 } # Initialization event
				country_event = { id = amcivwar.43 days = 14 } # Revolutionary Staff Leader
				country_event = { id = amcivwar.44 days = 21 } # Revolutionary Staff Leader
				country_event = { id = amcivwar.45 days = 28 } # Leader of the People's Air Force
				country_event = { id = amcivwar.30 days = 40 random = 10 } # Dealing with the Rich
				country_event = { id = amcivwar.38 days = 70 random = 20 } # Revolutionary Propaganda
				country_event = { id = amcivwar.36 days = 100 random = 20 } # Internal Conflicts
				country_event = { id = amcivwar.40 days = 130 random = 20 } # Protecting against Saboteurs
				country_event = { id = amcivwar.41 days = 160 random = 20 } # Red Terror
			}
		}
	}
}

USA_release_TEX = {
	hidden_effect = {
		TEX = {
			add_state_core = 371
			add_state_core = 372
			add_state_core = 374
			add_state_core = 375
			add_state_core = 370
			add_state_core = 367
			add_state_core = 365
			add_state_core = 364
			add_state_core = 366
			add_state_core = 833
			add_state_core = 832
			set_cosmetic_tag = TEX_ACW
			set_equipment_fraction = 0.35
			add_ideas = extensive_conscription
		}

		USA = {
			TEX = { transfer_technology = yes }
			if = {
				limit = { country_exists = CSA }
				load_oob = "USA_civil_war_reenforcments"
				set_cosmetic_tag = USA_ACW
				country_event = kr.political.208

				# pre-war events
				country_event = { id = amcivwar.311 hours = 8 } #MacArthur's Warning
				country_event = { id = amcivwar.300 days = 2 } #New England riots
				country_event = { id = amcivwar.301 days = 5 } #Minnesota
				country_event = { id = amcivwar.302 days = 7 } #North Carolina
				country_event = { id = amcivwar.303 days = 9 } #Tennessee
				country_event = { id = amcivwar.304 days = 12 } #New York/New Jersey
				country_event = { id = amcivwar.305 days = 12 } #New York/New Jersey
				country_event = { id = amcivwar.310 days = 15 } #Nevada
				country_event = { id = amcivwar.306 days = 18 } #Southern Texas
				country_event = { id = amcivwar.307 days = 20 } #Iowa
				country_event = { id = amcivwar.312 days = 25 } #Deadline Running Out

				# idea changes
				if = {
					limit = { has_idea = USA_black_monday }
					remove_ideas = USA_black_monday
				}
				if = {
					limit = { has_idea = USA_new_year_strike_idea }
					remove_ideas = USA_new_year_strike_idea
				}
				if = {
					limit = { has_idea = USA_political_crisis }
					remove_ideas = USA_political_crisis
				}
			}
			if = {
				limit = { has_country_flag = USA_reed_was_president }
				country_event = { id = amcivwar.3 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_long_was_president }
				country_event = { id = amcivwar.7 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_olson_was_president }
				country_event = { id = amcivwar.12 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_garner_was_president }
				country_event = { id = amcivwar.15 hours = 8 }
			}
			else_if = {
				limit = { has_country_flag = USA_landon_was_president }
				country_event = { id = amcivwar.18 hours = 8 }
			}
		}

		every_owned_state = {
			limit = { is_core_of = TEX }
			TEX = { transfer_state = PREV }
		}

		every_state = {
			limit = {
				is_core_of = USA
				NOT = { is_core_of = TEX }
				NOT = { is_claimed_by = TEX }
			}
			add_claim_by = TEX
		}

		remove_unit_leader = 57 #George S. Patton
		remove_unit_leader = 59 #George Van Horn Moseley

		every_navy_leader = {
			limit = { has_id = 63 } #William Halsey Jr.
			set_nationality = TEX
		}

		set_country_flag = Huey_Long_dead
		set_country_flag = Charles_Coughlin_dead
		set_country_flag = Henry_Ford_dead
		set_country_flag = Gerald_K_Smith_dead

		TEX = {
			load_oob = "USA_civil_war_aus_army"
			if = {
				limit = { USA = { has_country_flag = USA_long_was_president } }
				add_timed_idea = {
					idea = TEX_righteous_nation
					days = 90
				}
			}
			hidden_effect = {
				country_event = { id = unionstate.150 days = 7 } #Initial Events
				country_event = { id = amcivwar.54 days = 7 } # Longist Navy
				country_event = { id = amcivwar.50 days = 14 } # Chief of Staff
				country_event = { id = amcivwar.51 days = 21 } # Chief of Army
				country_event = { id = amcivwar.53 days = 28 } # Chief of Air Force
				country_event = { id = amcivwar.52 days = 35 } # Chief of Navy
				country_event = { id = amcivwar.46 days = 40 random = 10 } # Appeal to Reason
				country_event = { id = amcivwar.48 days = 60 random = 20 } # Pledge of Alliegence
			}
		}
	}
}

USA_release_CAL = {
	hidden_effect = {
		set_global_flag = ACW_pacific_states_revolted

		CAL = {
			add_state_core = 829
			add_state_core = 798
			add_state_core = 797
			add_state_core = 378
			add_state_core = 385
			add_state_core = 386
			set_cosmetic_tag = CAL_ACW
			set_equipment_fraction = 0.35
			add_ideas = extensive_conscription
		}

		USA = {
			CAL = { transfer_technology = yes }
			destroy_ships = {
				type = destroyer
				count = all
			}
			destroy_ships = {
				type = light_cruiser
				count = all
			}
			destroy_ships = {
				type = heavy_cruiser
				count = all
			}
			destroy_ships = {
				type = battleship
				count = all
			}
			destroy_ships = {
				type = SH_battleship
				count = all
			}
			destroy_ships = {
				type = heavy_carrier
				count = all
			}
			destroy_ships = {
				type = carrier
				count = all
			}
			destroy_ships = {
				type = submarine
				count = all
			}
			load_oob = "USA_civil_war_reenforcments2"
			load_oob = "USA_civil_war_psa_exist_navy"
			if = {
				limit = { has_country_flag = USA_reed_was_president }
				news_event = { id = amcivwar.4 hours = 8 }
				country_event = { id = amcivwar.5 days = 30 }
			}
			else_if = {
				limit = { has_country_flag = USA_long_was_president }
				news_event = { id = amcivwar.9 hours = 8 }
				country_event = { id = amcivwar.10 days = 30 }
			}
		}

		every_owned_state = {
			limit = { is_core_of = CAL }
			CAL = { transfer_state = PREV }
		}

		every_state = {
			limit = {
				is_core_of = USA
				NOT = { is_core_of = CAL }
				NOT = { is_claimed_by = CAL }
			}
			add_claim_by = CAL
		}

		remove_unit_leader = 58 #Henry H. Arnold
		remove_unit_leader = 62 #Chester W. Nimitz
		remove_unit_leader = 64 #George Marshall

		set_country_flag = Glen_H_Taylor_dead
		set_country_flag = Henry_Wallace_dead
		set_country_flag = Philip_La_Follette_dead
		set_country_flag = Adolf_Augustus_Berle_Jr_dead
		set_country_flag = Alger_Hiss_dead
		set_country_flag = George_Catlett_Marshall_Jr_dead
		set_country_flag = Hugh_Simons_Gibson_dead
		set_country_flag = Ralph_Johnson_Bunche_dead
		set_country_flag = Ellard_A_Walsh_dead
		set_country_flag = George_Henry_Dern_dead
		set_country_flag = Harry_Lloyd_Hopkins_dead
		set_country_flag = Hjalmar_Petersen_dead
		set_country_flag = Jesse_Holman_Jones_dead
		set_country_flag = Konrad_Knute_Solberg_dead
		set_country_flag = Harold_LeClair_Ickes_dead
		set_country_flag = Francis_Beverley_Biddle_dead
		set_country_flag = Elmer_Austin_Benson_dead
		set_country_flag = Bronson_Murray_Cutting_dead
		set_country_flag = Henry_Martin_Arens_dead
		set_country_flag = Magnus_Johnson_dead
		set_country_flag = Charles_L_McNary_dead
		set_country_flag = Earl_Warren_dead
		set_country_flag = John_Foster_Dulles_dead
		set_country_flag = Charles_Evans_Hughes_Sr_dead
		set_country_flag = Chester_William_Nimitz_Sr_dead

		CAL = {
			load_oob = "USA_civil_war_psa_army"
			country_event = { id = pacificstates.150 days = 1 } #Initial Events
			country_event = { id = amcivwar.77 days = 7 } #Chief of Staff
			country_event = { id = amcivwar.78 days = 14 } #Chief of Army
			country_event = { id = amcivwar.80 days = 21 } #Chief of Air Force
			country_event = { id = amcivwar.79 days = 28 } #Chief of Navy
		}

		JAP = { country_event = { id = japfor.225 days = 30 } }
	}
}

USA_civil_war_begins = {
	hidden_effect = {
		set_global_flag = USA_civil_war_begun_flag

		every_state = {
			limit = {
				owner = { is_american_tag = yes }
				OR = {
					state = 364
					state = 365
					state = 369
					state = 370
					state = 377
					state = 382
					state = 383
					state = 391
					state = 833
				}
			}
			remove_building = { type = industrial_complex level = 1 }
			add_building_construction = { type = arms_factory level = 1 instant_build = yes }
		}
		every_state = {
			limit = {
				owner = { is_american_tag = yes }
				OR = {
					state = 359
					state = 361
					state = 362
					state = 363
					state = 366
					state = 371
					state = 372
					state = 374
					state = 392
					state = 393
				}
			}
			remove_building = { type = industrial_complex level = 2 }
			add_building_construction = { type = arms_factory level = 2 instant_build = yes }
		}
		every_state = {
			limit = {
				owner = { is_american_tag = yes }
				OR = {
					state = 367
					state = 368
					state = 395
					state = 798
				}
			}
			remove_building = { type = industrial_complex level = 3 }
			add_building_construction = { type = arms_factory level = 3 instant_build = yes }
		}
		every_state = {
			limit = {
				owner = { is_american_tag = yes }
				OR = {
					state = 360
					state = 373
					state = 797
					state = 929
					state = 930
				}
			}
			remove_building = { type = industrial_complex level = 4 }
			add_building_construction = { type = arms_factory level = 4 instant_build = yes }
		}
		every_state = {
			limit = {
				owner = { is_american_tag = yes }
				OR = {
					state = 261
					state = 375
					state = 394
					state = 396
				}
			}
			remove_building = { type = industrial_complex level = 5 }
			add_building_construction = { type = arms_factory level = 5 instant_build = yes }
		}
		378 = {
			if = {
				limit = { owner = { is_american_tag = yes } }
				remove_building = { type = industrial_complex level = 6 }
				add_building_construction = { type = arms_factory level = 6 instant_build = yes }
			}
		}
		829 = {
			if = {
				limit = { owner = { is_american_tag = yes } }
				remove_building = { type = industrial_complex level = 7 }
				add_building_construction = { type = arms_factory level = 7 instant_build = yes }
			}
		}

		#declarations of war
		CSA = { declare_war_on = { target = TEX type = annex_everything	} }
		CSA = { declare_war_on = { target = USA type = annex_everything	} }
		TEX = { declare_war_on = { target = USA type = annex_everything	} }
		if = {
			limit = { country_exists = CAL }
			CSA = { declare_war_on = { target = CAL type = annex_everything	} }
			TEX = { declare_war_on = { target = CAL type = annex_everything	} }
			CAL = { declare_war_on = { target = USA type = annex_everything	} }
		}

		CSA = {
			country_event = { id = amcivwar.91 days = 90 }
			add_ideas = {
				war_economy
				amcivwar_idea
			}
		}
		TEX = {
			country_event = { id = amcivwar.92 days = 90 }
			add_ideas = {
				war_economy
				amcivwar_idea
			}
		}
		if = {
			limit = { country_exists = CAL }
			CAL = {
				country_event = { id = amcivwar.90 days = 90 }
				add_ideas = {
					war_economy
					amcivwar_idea
				}
			}
		}

		# remove USA cores in uncontrolled territory
		every_state = {
			limit = { is_core_of = USA }
			if = {
				limit = {
					OR = {
						is_controlled_by = CSA
						is_controlled_by = TEX
						is_controlled_by = CAL
					}
				}
				remove_core_of = USA
				add_claim_by = USA
			}
		}

		USA = {
			country_event = { id = amcivwar.93 days = 90 }
			add_ideas = {
				war_economy
				amcivwar_idea
			}
		}

		# remove guarantees
		if = {
			limit = { GUA = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = GUA relation = guarantee active = no }
		}
		if = {
			limit = { ELS = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = ELS relation = guarantee active = no }
		}
		if = {
			limit = { HON = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = HON relation = guarantee active = no }
		}
		if = {
			limit = { COS = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = COS relation = guarantee active = no }
		}
		if = {
			limit = { "PAN" = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = "PAN" relation = guarantee active = no }
		}
		if = {
			limit = { LEC = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = LEC relation = guarantee active = no }
		}
		if = {
			limit = { HAI = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = HAI relation = guarantee active = no }
		}
		if = {
			limit = { DOM = { is_guaranteed_by = USA } }
			diplomatic_relation = { country = DOM relation = guarantee active = no }
		}
		if = {
			limit = { HAI = { gives_military_access_to = USA } }
			diplomatic_relation = { country = HAI relation = military_access active = no }
		}
		if = {
			limit = { DOM = { gives_military_access_to = USA } }
			diplomatic_relation = { country = DOM relation = military_access active = no }
		}

		# Canada receives notification
		CAN = {
			if = {
				limit = {
					is_subject = no
					is_faction_leader = yes
					NOT = { has_war_with = USA }
				}
				country_event = { id = amcivwar.150 hours = 8 }
			}
		}

		# USA colony events
		"LIB" = { country_event = { id = amcivwar.212 hours = 8 } }
		"PHI" = { country_event = { id = amcivwar.226 hours = 8 } }

		USA = {
			country_event = { id = amcivwar.71 days = 7 } #Chief of Staff
			country_event = { id = amcivwar.72 days = 14 } #Chief of Army
			country_event = { id = amcivwar.74 days = 21 } #Chief of Air Force
			country_event = { id = amcivwar.73 days = 28 } #Chief of Navy
			country_event = { id = amcivwar.65 days = 40 random = 10 } # Martial Law?
			country_event = { id = amcivwar.64 days = 90 random = 10 } # Hardship of the civil war
			country_event = { id = amcivwar.66 days = 120 random = 20 } # Loyalist Terror
			country_event = { id = amcivwar.67 days = 150 random = 20 } # Native American Code talkers
			country_event = { id = amcivwar.69 days = 180 random = 20 } # Double V Campaign
			country_event = { id = amcivwar.70 days = 200 random = 20 } # Militarize the WASPs?

			news_event = { id = worldnews.1 hours = 4 } #main news event
		}

		# ACW related events for non-US nations
		BOL = {
			country_event = {
				id = bol.21
				days = 10
				random = 100
			}
		}
	}
}

USA_civil_war_ends = {
	hidden_effect = {
		if = {
			limit = { NOT = { has_global_flag = USA_civil_war_over_flag } }
			USA = {
				if = {
					limit = { exists = no }
					add_ideas = {
						civilian_economy
						volunteer_only
						USA_civil_war_aftermath_idea
						USA_civil_war_depression_idea
					}
				}
			}
			TEX = {
				if = {
					limit = { exists = no }
					add_ideas = {
						civilian_economy
						volunteer_only
						USA_civil_war_aftermath_idea
						USA_civil_war_depression_idea
					}
				}
			}
			CSA = {
				if = {
					limit = { exists = no }
					add_ideas = {
						civilian_economy
						volunteer_only
						USA_civil_war_aftermath_idea
						USA_civil_war_depression_idea
					}
				}
			}
			CAL = {
				if = {
					limit = { exists = no }
					add_ideas = {
						civilian_economy
						volunteer_only
						USA_civil_war_aftermath_idea
						USA_civil_war_depression_idea
					}
				}
			}

			every_state = {
				limit = {
					owner = { is_american_tag = yes }
					OR = {
						state = 364
						state = 365
						state = 369
						state = 370
						state = 377
						state = 382
						state = 383
						state = 391
						state = 833
					}
				}
				remove_building = { type = arms_factory level = 1 }
			}
			every_state = {
				limit = {
					owner = { is_american_tag = yes }
					OR = {
						state = 359
						state = 361
						state = 362
						state = 363
						state = 366
						state = 371
						state = 372
						state = 374
						state = 392
						state = 393
					}
				}
				remove_building = { type = arms_factory level = 2 }
				add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
			}
			every_state = {
				limit = {
					owner = { is_american_tag = yes }
					OR = {
						state = 367
						state = 368
						state = 395
						state = 798
					}
				}
				remove_building = { type = arms_factory level = 3 }
				add_building_construction = { type = industrial_complex level = 2 instant_build = yes }
			}
			every_state = {
				limit = {
					owner = { is_american_tag = yes }
					OR = {
						state = 360
						state = 373
						state = 797
						state = 929
						state = 930
					}
				}
				remove_building = { type = arms_factory level = 4 }
				add_building_construction = { type = industrial_complex level = 3 instant_build = yes }
			}
			every_state = {
				limit = {
					owner = { is_american_tag = yes }
					OR = {
						state = 261
						state = 375
						state = 394
						state = 396
					}
				}
				remove_building = { type = arms_factory level = 5 }
				add_building_construction = { type = industrial_complex level = 4 instant_build = yes }
			}
			378 = {
				if = {
					limit = { owner = { is_american_tag = yes } }
					remove_building = { type = arms_factory level = 6 }
					add_building_construction = { type = industrial_complex level = 5 instant_build = yes }
				}
			}
			829 = {
				if = {
					limit = { owner = { is_american_tag = yes } }
					remove_building = { type = arms_factory level = 7 }
					add_building_construction = { type = industrial_complex level = 6 instant_build = yes }
				}
			}
		}
		set_global_flag = USA_civil_war_over_flag
	}
}

USA_demobilize_forces = {
	CSA = {
		if = {
			limit = { has_template = "Revolutionary Union Militia" }
			delete_unit_template_and_units = { division_template = "Revolutionary Union Militia" }
		}
		if = {
			limit = { has_template = "Revolutionary Militia" }
			delete_unit_template_and_units = { division_template = "Revolutionary Militia" }
		}
		if = {
			limit = { has_template = "Revolutionary Garrison" }
			delete_unit_template_and_units = { division_template = "Revolutionary Garrison" }
		}
		if = {
			limit = { has_template = "Mounted Revolutionary Militia" }
			delete_unit_template_and_units = { division_template = "Mounted Revolutionary Militia" }
		}
		if = {
			limit = { has_template = "Amerikavrijwilligers" }
			delete_unit_template_and_units = { division_template = "Amerikavrijwilligers" }
		}
		if = {
			limit = { has_template = "German Militia Division" }
			delete_unit_template_and_units = { division_template = "German Militia Division" }
		}
		if = {
			limit = { has_template = "CSA Resistance" }
			delete_unit_template_and_units = { division_template = "CSA Resistance" }
		}
	}
	TEX = {
		if = {
			limit = { has_template = "AUS Militia" }
			delete_unit_template_and_units = { division_template = "AUS Militia" }
		}
		if = {
			limit = { has_template = "Mounted AUS Militia" }
			delete_unit_template_and_units = { division_template = "Mounted AUS Militia" }
		}
		if = {
			limit = { has_template = "AUS Garrison" }
			delete_unit_template_and_units = { division_template = "AUS Garrison" }
		}
		if = {
			limit = { has_template = "AUS Resistance" }
			delete_unit_template_and_units = { division_template = "AUS Resistance" }
		}
	}
	USA = {
		if = {
			limit = { has_template = "Loyalist Cavalry Guard" }
			delete_unit_template_and_units = { division_template = "Loyalist Cavalry Guard" }
		}
		if = {
			limit = { has_template = "Loyalist Militia" }
			delete_unit_template_and_units = { division_template = "Loyalist Militia" }
		}
		if = {
			limit = { has_template = "Mounted Loyalists" }
			delete_unit_template_and_units = { division_template = "Mounted Loyalists" }
		}
		if = {
			limit = { has_template = "Loyalist Motorized Guard" }
			delete_unit_template_and_units = { division_template = "Loyalist Motorized Guard" }
		}
		if = {
			limit = { has_template = "USA Resistance" }
			delete_unit_template_and_units = { division_template = "USA Resistance" }
		}
	}
	CAL = {
		if = {
			limit = { has_template = "Loyalist Volunteer" }
			delete_unit_template_and_units = { division_template = "Loyalist Volunteer" }
		}
		if = {
			limit = { has_template = "Mounted PSA Militia" }
			delete_unit_template_and_units = { division_template = "Mounted PSA Militia" }
		}
		if = {
			limit = { has_template = "PSA Militia" }
			delete_unit_template_and_units = { division_template = "PSA Militia" }
		}
		if = {
			limit = { has_template = "PSA Garrison" }
			delete_unit_template_and_units = { division_template = "PSA Garrison" }
		}
		if = {
			limit = { has_template = "PSA Resistance" }
			delete_unit_template_and_units = { division_template = "PSA Resistance" }
		}
	}
}

ACW_surrender_effect = {
	custom_effect_tooltip = amcivwar_surrender_tooltip
	hidden_effect = {
		# transfer states occupied by other ACW countries
		every_owned_state = {
			limit = {
				NOT = { state = event_target:last_state }
				NOT = { is_controlled_by = ROOT }
				OR = {
					is_controlled_by = CSA
					is_controlled_by = TEX
					is_controlled_by = CAL
					is_controlled_by = USA
					is_controlled_by = NEE
				}
			}
			controller = { transfer_state = PREV }
		}
		# then return controlled states to their owners
		every_state = {
			limit = {
				is_controlled_by = ROOT
				NOT = { is_owned_by = ROOT }
			}
			owner = { set_state_controller = PREV }
		}
		# then give occupied states to Canada, if they're neighboring
		if = {
			limit = { has_war_with = CAN }
			every_owned_state = {
				limit = {
					any_neighbor_state = { is_owned_by = CAN }
					controller = { is_in_faction_with = CAN }
				}
				CAN = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = {
					any_neighbor_state = { is_owned_by = CAN }
					controller = { is_in_faction_with = CAN }
				}
				CAN = { transfer_state = PREV }
			}
			every_owned_state = {
				limit = {
					any_neighbor_state = { is_owned_by = CAN }
					controller = { is_in_faction_with = CAN }
				}
				CAN = { transfer_state = PREV }
			}
		}
		# then give occupied claimed states to Mexico
		if = {
			limit = { has_war_with = MEX }
			every_owned_state = {
				limit = {
					any_neighbor_state = { is_controlled_by = MEX }
					is_controlled_by = MEX
					OR = {
						is_core_of = MEX
						is_claimed_by = MEX
					}
				}
				MEX = { transfer_state = PREV }
			}
		}
	}
	if = {
		limit = {
			OR = {
				is_ai = no
				any_owned_state = {
					NOT = { state = event_target:last_state }
					NOT = { is_controlled_by = ROOT }
				}
			}
		}
		add_ideas = amcviwar_ready_to_surrender
		else = {
			event_target:annex_to = {
				annex_country = { target = ROOT }
				hidden_effect = {
					country_event = { id = amcivwar.606 days = 1 } #cleanup
				}
			}
		}
	}
}

USA_increase_recovery = {
	if = {
		limit = { has_idea = USA_civil_war_aftermath_idea }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea
			add_idea = USA_civil_war_aftermath_idea2
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea2 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea2
			add_idea = USA_civil_war_aftermath_idea3
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea3 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea3
			add_idea = USA_civil_war_aftermath_idea4
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea4 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea4
			add_idea = USA_civil_war_aftermath_idea5
		}
	}
}

TEX_increase_recovery = {
	if = {
		limit = { has_idea = TEX_national_recovery_idea1 }
		swap_ideas = {
			remove_idea = TEX_national_recovery_idea1
			add_idea = TEX_national_recovery_idea2
		}
	}
	else_if = {
		limit = { has_idea = TEX_national_recovery_idea2 }
		swap_ideas = {
			remove_idea = TEX_national_recovery_idea2
			add_idea = TEX_national_recovery_idea3
		}
	}
	else_if = {
		limit = { has_idea = TEX_national_recovery_idea3 }
		swap_ideas = {
			remove_idea = TEX_national_recovery_idea3
			add_idea = TEX_national_recovery_idea4
		}
	}
	else_if = {
		limit = { has_idea = TEX_national_recovery_idea4 }
		swap_ideas = {
			remove_idea = TEX_national_recovery_idea4
			add_idea = TEX_national_recovery_idea5
		}
	}
}

TEX_increase_military_complex = {
	if = {
		limit = { has_idea = TEX_military_industrial_complex_idea1 }
		swap_ideas = {
			remove_idea = TEX_military_industrial_complex_idea1
			add_idea = TEX_military_industrial_complex_idea2
		}
	}
	else_if = {
		limit = { has_idea = TEX_military_industrial_complex_idea2 }
		swap_ideas = {
			remove_idea = TEX_military_industrial_complex_idea2
			add_idea = TEX_military_industrial_complex_idea3
		}
	}
	else_if = {
		limit = { has_idea = TEX_military_industrial_complex_idea3 }
		swap_ideas = {
			remove_idea = TEX_military_industrial_complex_idea3
			add_idea = TEX_military_industrial_complex_idea4
		}
	}
	else_if = {
		limit = { has_idea = TEX_military_industrial_complex_idea4 }
		swap_ideas = {
			remove_idea = TEX_military_industrial_complex_idea4
			add_idea = TEX_military_industrial_complex_idea5
		}
	}
}

CSA_increase_recovery = {
	if = {
		limit = { has_idea = USA_civil_war_aftermath_idea }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea
			add_idea = USA_civil_war_aftermath_idea2
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea2 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea2
			add_idea = USA_civil_war_aftermath_idea3
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea3 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea3
			add_idea = USA_civil_war_aftermath_idea4
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea4 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea4
			add_idea = USA_civil_war_aftermath_idea5
		}
	}
	else_if = {
		limit = { has_idea = USA_civil_war_aftermath_idea5 }
		swap_ideas = {
			remove_idea = USA_civil_war_aftermath_idea5
			add_idea = CSA_social_revolution1
		}
	}
	else_if = {
		limit = { has_idea = CSA_social_revolution1 }
		swap_ideas = {
			remove_idea = CSA_social_revolution1
			add_idea = CSA_social_revolution2
		}
	}
	else_if = {
		limit = { has_idea = CSA_social_revolution2 }
		swap_ideas = {
			remove_idea = CSA_social_revolution2
			add_idea = CSA_social_revolution3
		}
	}
	else_if = {
		limit = { has_idea = CSA_social_revolution3 }
		swap_ideas = {
			remove_idea = CSA_social_revolution3
			add_idea = CSA_social_revolution4
		}
	}
	else_if = {
		limit = { has_idea = CSA_social_revolution4 }
		swap_ideas = {
			remove_idea = CSA_social_revolution4
			add_idea = CSA_social_revolution5
		}
	}
	else_if = {
		limit = { has_idea = CSA_social_revolution5 }
		swap_ideas = {
			remove_idea = CSA_social_revolution5
			add_idea = CSA_social_revolution6
		}
	}
}

remove_ACW_cores = {
	if = {
		limit = {
			is_core_of = USA
			ROOT = { NOT = { tag = USA } }
		}
		remove_core_of = USA
	}
	if = {
		limit = {
			is_claimed_by = USA
			ROOT = { NOT = { tag = USA } }
		}
		remove_claim_by = USA
	}
	if = {
		limit = {
			is_core_of = CAL
			ROOT = { NOT = { tag = CAL } }
		}
		remove_core_of = CAL
	}
	if = {
		limit = {
			is_claimed_by = CAL
			ROOT = { NOT = { tag = CAL } }
		}
		remove_claim_by = CAL
	}
	if = {
		limit = {
			is_core_of = TEX
			ROOT = { NOT = { tag = TEX } }
		}
		remove_core_of = TEX
	}
	if = {
		limit = {
			is_claimed_by = TEX
			ROOT = { NOT = { tag = TEX } }
		}
		remove_claim_by = TEX
	}
	if = {
		limit = {
			is_core_of = CSA
			ROOT = { NOT = { tag = CSA } }
		}
		remove_core_of = CSA
	}
	if = {
		limit = {
			is_claimed_by = CSA
			ROOT = { NOT = { tag = CSA } }
		}
		remove_claim_by = CSA
	}
	if = {
		limit = {
			is_core_of = NEE
			ROOT = { NOT = { tag = NEE } }
		}
		remove_core_of = NEE
	}
	if = {
		limit = {
			is_claimed_by = NEE
			ROOT = { NOT = { tag = NEE } }
		}
		remove_claim_by = NEE
	}
}

