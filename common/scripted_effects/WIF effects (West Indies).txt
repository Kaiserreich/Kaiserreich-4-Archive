
###################
#
# West Indies
#
###################

#
# (British) Empire's Anger
#

### Add
WIF_empire_add_one = {
	add_to_variable = {
		var = WIF_british_anger
		value = 1
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_two = {
	add_to_variable = {
		var = WIF_british_anger
		value = 2
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_three = {
	add_to_variable = {
		var = WIF_british_anger
		value = 3
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_four = {
	add_to_variable = {
		var = WIF_british_anger
		value = 4
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_five = {
	add_to_variable = {
		var = WIF_british_anger
		value = 5
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_six = {
	add_to_variable = {
		var = WIF_british_anger
		value = 6
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_seven = {
	add_to_variable = {
		var = WIF_british_anger
		value = 7
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_eight = {
	add_to_variable = {
		var = WIF_british_anger
		value = 8
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_ten = {
	add_to_variable = {
		var = WIF_british_anger
		value = 10
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_add_fifteen = {
	add_to_variable = {
		var = WIF_british_anger
		value = 15
		tooltip = WIF_increase_empire_tensions
	}
	WIF_evaluate_anger = yes
}

### Sub
WIF_empire_sub_one = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 1
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_two = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 2
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_three = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 3
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_four = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 4
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_five = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 5
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_six = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 6
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_eight = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 8
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_empire_sub_ten = {
	subtract_from_variable = {
		var = WIF_british_anger
		value = 10
		tooltip = WIF_lower_empire_tensions
	}
	WIF_evaluate_anger = yes
}

#
# Socialist's Anger
#

### Add
WIF_socialist_add_one = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 1
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_two = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 2
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_three = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 3
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_four = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 4
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_five = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 5
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_six = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 6
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_seven = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 7
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_eight = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 8
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_ten = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 10
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_add_twentyfive = {
	add_to_variable = {
		var = WIF_socialist_anger
		value = 25
		tooltip = WIF_increase_socialist_tensions
	}
	WIF_evaluate_anger = yes
}

### Subtract
WIF_socialist_sub_one = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 1
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_two = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 2
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_three = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 3
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_four = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 4
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_five = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 5
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_six = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 6
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}
WIF_socialist_sub_eight = {
	subtract_from_variable = {
		var = WIF_socialist_anger
		value = 8
		tooltip = WIF_lower_socialist_tensions
	}
	WIF_evaluate_anger = yes
}

#
# West Indies Federation Integration
#

### Add
WIF_wifint_add_one = {
	add_to_variable = {
		var = wifint
		value = 1
		tooltip = WIF_increase_consolidation
	}
}
WIF_wifint_add_two = {
	add_to_variable = {
		var = wifint
		value = 2
		tooltip = WIF_increase_consolidation
	}
}
WIF_wifint_add_three = {
	add_to_variable = {
		var = wifint
		value = 3
		tooltip = WIF_increase_consolidation
	}
}
WIF_wifint_add_five = {
	add_to_variable = {
		var = wifint
		value = 5
		tooltip = WIF_increase_consolidation
	}
}
WIF_wifint_add_ten = {
	add_to_variable = {
		var = wifint
		value = 10
		tooltip = WIF_increase_consolidation
	}
}

### Subtract
WIF_wifint_sub_five = {
	subtract_from_variable = {
		var = wifint
		value = 5
		tooltip = WIF_lower_consolidation
	}
}
WIF_wifint_sub_ten = {
	subtract_from_variable = {
		var = wifint
		value = 10
		tooltip = WIF_lower_consolidation
	}
}

### Other WIF Scripted Effects

WIF_remove_entente_commanders = { #Perhaps these commanders can be move to CAN if this happens?
	WIF = {
		if = {
			limit = { has_character = WIF_thomas_cubitt }
			WIF_thomas_cubitt = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_thomas_cubitt = { set_nationality = CAN }
			}
			else = {
				WIF_thomas_cubitt = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_reginald_hildyard }
			WIF_reginald_hildyard = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_reginald_hildyard = { set_nationality = CAN }
			}
			else = {
				WIF_reginald_hildyard = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_geoffrey_archer }
			WIF_geoffrey_archer = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_geoffrey_archer = { set_nationality = CAN }
			}
			else = {
				WIF_geoffrey_archer = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_bede_clifford }
			WIF_bede_clifford = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_bede_clifford = { set_nationality = CAN }
			}
			else = {
				WIF_bede_clifford = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_felix_eboue }
			WIF_felix_eboue = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_felix_eboue = { set_nationality = CAN }
			}
			else = {
				WIF_felix_eboue = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_ralph_leatham }
			WIF_ralph_leatham = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_ralph_leatham = { set_nationality = CAN }
			}
			else = {
				WIF_ralph_leatham = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = WIF_andrew_cunningham }
			WIF_andrew_cunningham = {
				set_character_flag = GBR_character
				add_unit_leader_trait = GBR_british_exile_trait
			}
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				WIF_andrew_cunningham = { set_nationality = CAN }
			}
			else = {
				WIF_andrew_cunningham = { set_nationality = GBR }
			}
		}
		if = {
			limit = { has_character = GBR_philip_neame }
			if = {
				limit = { CAN = { is_faction_leader = yes } }
				GBR_philip_neame = { set_nationality = CAN }
			}
			else = {
				GBR_philip_neame = { set_nationality = GBR }
			}
		}
	}
}

WIF_add_entente_commanders = {
	WIF = {
		if = {
			limit = {
				WIF_reginald_hildyard = { is_unit_leader = no } #replaces Cubitt via event
				NOT = { has_character = WIF_thomas_cubitt }
			}
			WIF_thomas_cubitt = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_reginald_hildyard } }
			WIF_reginald_hildyard = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_geoffrey_archer } }
			WIF_geoffrey_archer = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_bede_clifford } }
			WIF_bede_clifford = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_felix_eboue } }
			WIF_felix_eboue = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_ralph_leatham } }
			WIF_ralph_leatham = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
		if = {
			limit = { NOT = { has_character = WIF_andrew_cunningham } }
			WIF_andrew_cunningham = {
				set_nationality = WIF
				clr_character_flag = GBR_character
				remove_unit_leader_trait = GBR_british_exile_trait
			}
		}
	}
	if = {
		limit = {
			country_exists = GBR
		}
		GBR = {
			country_event = { id = wifpol.3101 }
		}
	}
	else = {
		CAN = {
			country_event = { id = wifpol.3101 }
		}
	}
}

WIF_add_caribbean_commanders = {
	if = {
		limit = { NOT = { has_character = WIF_arthur_andrew_cipriani } }
		TRI = {
			WIF_arthur_andrew_cipriani = {
				remove_all_country_leader_roles = yes
				set_nationality = WIF
			}
		}
	}
}

WIF_remove_caribbean_commanders = {
	if = {
		limit = { has_character = WIF_arthur_andrew_cipriani }
		WIF_arthur_andrew_cipriani = { set_nationality = TRI }
		TRI = {
			add_country_leader_role = {
				character = WIF_arthur_andrew_cipriani
				country_leader = { ideology = totalist_subtype }
				promote_leader = yes
			}
			add_country_leader_role = {
				character = WIF_arthur_andrew_cipriani
				country_leader = { ideology = syndicalist_subtype }
				promote_leader = yes
			}
			add_country_leader_role = {
				character = WIF_arthur_andrew_cipriani
				country_leader = { ideology = radical_socialist_subtype }
				promote_leader = yes
			}
		}
	}
}

WIF_evaluate_anger = {
	WIF = {
		set_variable = { WIF.var_wif_stability = 0 }
		set_variable = { WIF.var_wif_war_support = 0 }
		set_variable = { WIF.var_wif_pol_power = 0 }
		hidden_effect = {
			#Socialist baseline
			if = {
				limit = {
					check_variable = { WIF_socialist_anger > 80 }
				}
				add_to_variable = { WIF.var_wif_stability = -0.2 }
				add_to_variable = { WIF.var_wif_war_support = -0.15 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_socialist_anger > 60 }
				}
				add_to_variable = { WIF.var_wif_stability = -0.15 }
				add_to_variable = { WIF.var_wif_war_support = -0.1 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_socialist_anger > 40 }
				}
				add_to_variable = { WIF.var_wif_stability = -0.1 }
				add_to_variable = { WIF.var_wif_war_support = -0.05 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_socialist_anger > 20 }
				}
				add_to_variable = { WIF.var_wif_stability = -0.05 }
			}

			#Imperial baseline
			if = {
				limit = {
					check_variable = { WIF_british_anger > 80 }
				}
				add_to_variable = { WIF.var_wif_pol_power = -0.2 }
				add_to_variable = { WIF.var_wif_war_support = -0.15 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_british_anger > 60 }
				}
				add_to_variable = { WIF.var_wif_pol_power = -0.15 }
				add_to_variable = { WIF.var_wif_war_support = -0.1 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_british_anger > 40 }
				}
				add_to_variable = { WIF.var_wif_pol_power = -0.1 }
				add_to_variable = { WIF.var_wif_war_support = -0.05 }
			}
			else_if = {
				limit = {
					check_variable = { WIF_british_anger > 20 }
				}
				set_variable = { WIF.var_wif_pol_power = -0.05 }
			}

			if = {
				limit = {
					has_authoritarian_government = yes
				}
				multiply_variable = { WIF.var_wif_pol_power = 0 }
				multiply_variable = { WIF.var_wif_stability = 1.5 } #not two in order to make up for initial hit after a soc/imp coup
			}
			else = {
				multiply_variable = { WIF.var_wif_pol_power = 1.5 } #not two in order to make up for initial hit after a soc/imp coup
				multiply_variable = { WIF.var_wif_stability = 0 }
			}
		}
		force_update_dynamic_modifier = yes
	}
}

WIF_puppet_setup = {
	hidden_effect = {
		if = {
			limit = { has_socialist_government = yes }
			var:tag_to_release = {
				set_politics = { ruling_party = syndicalist }
				set_popularities = {
					totalist = 4
					syndicalist = 33
					radical_socialist = 24
					social_democrat = 27
					social_liberal = 0
					market_liberal = 5
					social_conservative = 4
					authoritarian_democrat = 0
					paternal_autocrat = 3
					national_populist = 0
				}
				remove_ideas = {
					WIF_french_conscription_ncp
					WIF_consolidation_effect1
					WIF_consolidation_effect2
					WIF_consolidation_effect3
					WIF_consolidation_effect4
				}
				complete_national_focus = WIF_syndicalist_revolution
				set_party_name = {
					ideology = social_democrat
					long_name = WIF_social_democrat_party_syndie_long
					name = WIF_social_democrat_party_syndie
				}
				set_party_name = {
					ideology = syndicalist
					long_name = WIF_syndicalist_party_after_revolt_long
					name = WIF_syndicalist_party_after_revolt
				}
				set_party_name = {
					ideology = radical_socialist
					long_name = WIF_radical_socialist_party_after_revolt_long
					name = WIF_radical_socialist_party_after_revolt
				}
				WIF_grantley_herbert_adams = { promote_character = yes }
				WIF_norman_manley = { promote_character = yes }
				WIF_victor_severe = { promote_character = yes }
				WIF_joseph_trounsell_gilbert = { promote_character = yes }
				WIF_solomon_hochoy = { promote_character = yes }
				WIF_georges_robert = { promote_character = yes }
			}
		}
		else = {
			hidden_effect = {
				var:tag_to_release = {
					set_party_name = {
						ideology = social_democrat
						long_name = WIF_social_democrat_party_long
						name = WIF_social_democrat_party
					}
					set_party_name = {
						ideology = syndicalist
						long_name = WIF_syndicalist_party_long
						name = WIF_syndicalist_party
					}
					set_party_name = {
						ideology = radical_socialist
						long_name = WIF_radical_socialist_party_long
						name = WIF_radical_socialist_party
					}
				}
			}
			if = {
				limit = {
					OR = {
						original_tag = IMP
						is_commonwealth_tag = yes
					}
				}
				set_autonomy = {
					target = var:tag_to_release
					autonomy_state = federated_colony
					end_wars = no
				}
				var:tag_to_release = {
					set_cosmetic_tag = WIF_entente
					set_politics = { ruling_party = authoritarian_democrat }
					set_political_party = { ideology = authoritarian_democrat popularity = 60 }
					unlock_national_focus = WIF_governor_push
					if = {
						limit = { has_character = WIF_eustace_fiennes }
						WIF_eustace_fiennes = {
							hidden_effect = { remove_all_country_leader_roles = yes }
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_democrat_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_liberal_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = market_liberal_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_conservative_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = authoritarian_democrat_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = paternal_autocrat_subtype
								}
								promote_leader = yes
							}
						}
					}
					else = {
						WIF_gordon_james_lethem = {
							hidden_effect = {
								set_nationality = PREV
								remove_all_country_leader_roles = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_democrat_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_liberal_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = market_liberal_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = social_conservative_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = authoritarian_democrat_subtype
								}
								promote_leader = yes
							}
							add_country_leader_role = {
								country_leader = {
									desc = WIF_eustace_fiennes_leader_desc
									ideology = paternal_autocrat_subtype
								}
								promote_leader = yes
							}
						}
					}
				}
			}
			else = {
				hidden_effect = {
					var:tag_to_release = {
						if = {
							limit = { has_character = WIF_eustace_fiennes }
							WIF_eustace_fiennes = { remove_all_country_leader_roles = yes }
						}
						if = {
							limit = { has_character = WIF_gordon_james_lethem }
							WIF_gordon_james_lethem = { remove_all_country_leader_roles = yes }
						}
					}
				}
			}
		}
	}
}

WIF_teardown_integration_process_NCP = {
	hidden_effect = {
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_royal_assistance }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_guyana_trails }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_french_conscription }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_universal_rights }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_meetings }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_flyer }
		remove_targeted_decision = { target = THIS decision = WIF_integration_process_NCP_francophonie }
	}
}
