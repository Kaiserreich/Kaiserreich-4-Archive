on_actions = {
	on_startup = {
		effect = {
			for_each_scope_loop = {
				array = RUS.owned_states
				add_to_array = { RUS.RUS_starting_states_array = THIS }
			}

			# Russia target (for use in targeted modifiers)
			set_variable = { global.russia = RUS }

			#Central Asian integration
			every_state = {
				limit = { is_central_asia = yes }
				KAZ = { PREV = { enable_state_integration_50_compliance = yes } }
				TRK = { PREV = { enable_state_integration_50_compliance = yes } }
				BUK = { PREV = { enable_state_integration_50_compliance = yes } }
				KHI = { PREV = { enable_state_integration_50_compliance = yes } }
				ETS = { PREV = { enable_state_integration_80_compliance = yes } }
			}
			every_state = {
				limit = { is_xinjiang = yes }
				KAZ = { PREV = { enable_state_integration_80_compliance = yes } }
				TRK = { PREV = { enable_state_integration_80_compliance = yes } }
				BUK = { PREV = { enable_state_integration_80_compliance = yes } }
				KHI = { PREV = { enable_state_integration_80_compliance = yes } }
			}

			RUS = {
				set_temp_variable = { coalition_partner_var = token:authoritarian_democrat }
				add_to_coalition = yes
				activate_mission = RUS_land_reform_in_progress
				hidden_effect = { country_event = { id = russia.251 days = 95 } } #Land Reform
			}

			# Federal System
			402 = {
				set_state_flag = alash_state
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}
			404 = {
				set_state_flag = alash_state
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}
			587 = {
				set_state_flag = alash_state
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}
			590 = {
				set_state_flag = alash_state
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}
			810 = {
				set_state_flag = alash_state
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}
			880 = {
				set_state_flag = dvinsk_state
			}

			# Cossack Hosts
			218 = {
				set_state_flag = don_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			238 = {
				set_state_flag = don_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			245 = {
				set_state_flag = don_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			234 = {
				set_state_flag = kuban_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			1006 = {
				set_state_flag = kuban_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			236 = {
				set_state_flag = astrakhan_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			237 = {
				set_state_flag = astrakhan_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			581 = {
				set_state_flag = ural_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			406 = {
				set_state_flag = orenburg_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			652 = {
				set_state_flag = orenburg_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			583 = {
				set_state_flag = siberian_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			560 = {
				set_state_flag = amur_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			561 = {
				set_state_flag = amur_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			657 = {
				set_state_flag = amur_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
			}
			589 = {
				set_state_flag = semirechye_state
				add_dynamic_modifier = { modifier = RUS_cossack_host_modifier }
				add_dynamic_modifier = { modifier = RUS_CA_modifier }
			}

			# North Caucasus
			233 = {
				set_state_flag = oskab_state
				add_dynamic_modifier = { modifier = RUS_oskab_modifier }
			}
			787 = {
				set_state_flag = oskab_state
				add_dynamic_modifier = { modifier = RUS_oskab_modifier }
			}
			961 = {
				set_state_flag = oskab_state
				add_dynamic_modifier = { modifier = RUS_oskab_modifier }
			}

			###GER/JAP Resource ownership
			RUS = {
				give_resource_rights = { state = 232 receiver = GER } #Dagestan
				give_resource_rights = { state = 961 receiver = GER } #Chechenya
				give_resource_rights = { state = 577 receiver = JAP } #South Sakhalin
			}
		}
	}

	on_new_term_election = {
		effect = {
			### RUSSIA ###
			if = {
				limit = { original_tag = RUS }
				country_event = ruselections.51 #second elections for the republic
				country_event = ruselections.52 #second elections for the empire
				country_event = ruselections.53 #postponed elections
			}
		}
	}

	#FROM is country getting invited.
	on_offer_join_faction = {
		effect = {
			if = {
				limit = {
					is_russian_tag = yes
					FROM = { any_core_state = { has_variable = can_integrate_@ROOT } }
				}
				set_variable = { FROM.RUS_alliance_disabled_integration = ROOT }
				FROM = { disable_country_integration = yes }
				if = {
					limit = { FROM = { original_tag = UKR } }
					73 = { disable_state_integration = yes } #Transcarpathia
					73 = { disable_state_integration = yes } #Bessarabia
					80 = { disable_state_integration = yes } #Cernauti
					89 = { disable_state_integration = yes } #Stanislawow
					91 = { disable_state_integration = yes } #Lwow
					1088 = { disable_state_integration = yes } #Chelm

					if = {
						limit = { owns_state = 243 } #Krichev
						241 = { enable_state_integration_80_compliance = yes } #Gomel
					}
				}
				else_if = {
					limit = { FROM = { original_tag = LIT } }
					188 = { disable_state_integration = yes } #Memel
				}
				else_if = {
					limit = { FROM = { original_tag = POL } }
					if = {
						limit = { NOT = { owns_state = 97 } }
						97 = { disable_state_integration = yes } #Bialystok
					}
				}
				else_if = {
					limit = { FROM = { original_tag = GEO } }
					585 = { disable_state_integration = yes } #Batumi
				}
				else_if = {
					limit = { FROM = { original_tag = ARM } }
					1000 = { disable_state_integration = yes } #Kars
				}
				else_if = {
					limit = { FROM = { is_subject = no } }
					else_if = {
						limit = { FROM = { original_tag = JAP } }
						if = {
							limit = { NOT = { owns_state = 537 } }
							537 = { disable_state_integration = yes } #South Sakhalin
						}
						if = {
							limit = { NOT = { owns_state = 555 } }
							555 = { disable_state_integration = yes } #Kuril Islands
						}
						if = {
							limit = { NOT = { owns_state = 577 } }
							577 = { disable_state_integration = yes } #North Sakhalin
						}
					}
					else_if = {
						limit = { FROM = { original_tag = ROM } }
						if = {
							limit = { NOT = { owns_state = 78 } }
							78 = { disable_state_integration = yes } #Bessarabia
						}
					}
					else_if = {
						limit = { FROM = { original_tag = FIN } }
						if = {
							limit = { NOT = { owns_state = 146 } }
							146 = { disable_state_integration = yes } #Karelia
						}
					}
					if = {
						limit = { FROM = { original_tag = PER } }
						if = {
							limit = { NOT = { owns_state = 418 } }
							418 = { disable_state_integration = yes } #Ashkhabad
						}
					}
				}
			}
		}
	}

	on_leave_faction = {
		effect = {
			if = {
				limit = { has_variable = RUS_alliance_disabled_integration }
				var:RUS_alliance_disabled_integration = {
					PREV = { enable_country_integration_80_compliance = yes }
					if = {
						limit = { PREV = { original_tag = UKR } }
						73 = { enable_state_integration_80_compliance = yes } #Transcarpathia
						78 = { enable_state_integration_80_compliance = yes } #Bessarabia
						80 = { enable_state_integration_80_compliance = yes } #Cernauti
						89 = { enable_state_integration_80_compliance = yes } #Stanislawow
						91 = { enable_state_integration_80_compliance = yes } #Lwow
						1088 = { enable_state_integration_80_compliance = yes } #Chelm

						241 = { disable_state_integration = yes } #Gomel
					}
					else_if = {
						limit = { PREV = { original_tag = JAP } }
						537 = { enable_state_integration_80_compliance = yes } #South Sakhalin
						555 = { enable_state_integration_80_compliance = yes } #Kuril Islands
						577 = { enable_state_integration_80_compliance = yes } #North Sakhalin
					}
					else_if = {
						limit = { PREV = { original_tag = LIT } }
						188 = { enable_state_integration_80_compliance = yes } #Memel
					}
					else_if = {
						limit = { PREV = { original_tag = POL } }
						97 = { enable_state_integration_80_compliance = yes } #Bialystok
					}
					else_if = {
						limit = { PREV = { original_tag = FIN } }
						146 = { enable_state_integration_50_compliance = yes } #Karelia
					}
					else_if = {
						limit = { PREV = { original_tag = ROM } }
						78 = { enable_state_integration_80_compliance = yes } #Bessarabia
					}
					else_if = {
						limit = { PREV = { original_tag = GEO } }
						585 = { enable_state_integration_80_compliance = yes } #Batumi
					}
					else_if = {
						limit = { PREV = { original_tag = ARM } }
						1000 = { enable_state_integration_80_compliance = yes } #Kars
					}
					else_if = {
						limit = { PREV = { original_tag = PER } }
						418 = { enable_state_integration_80_compliance = yes } #Ashkhabad
					}
				}
				clear_variable = RUS_alliance_disabled_integration
			}
		}
	}

	on_weekly_RSA = {
		effect = {
			if = { ### Russian MIO weekly updates
				limit = { has_dlc_aat = yes }
				RUS_Update_MIO_Research_Speeds = yes
				RUS_Update_MIO_XP_Gains = yes
				RUS_Update_Sokol = yes
				RUS_Update_Decaying_Funds_Bonus = yes
			}
		}
	}

	on_weekly_FER = {
		effect = {
			if = { ### Russian MIO weekly updates
				limit = { has_dlc_aat = yes }
				RUS_Update_MIO_Research_Speeds = yes
				RUS_Update_MIO_XP_Gains = yes
				RUS_Update_Sokol = yes
				RUS_Update_Decaying_Funds_Bonus = yes
			}
		}
	}

	on_weekly_RUS = {
		effect = {
			if = {
				limit = {
					has_democratic_government = yes
					is_monarchy = no
					var:country_leader = {
						has_character_flag = RUS_traits_assigned
						NOT = { has_character_flag = RUS_agendas_complete }
					}
				}
				### Titov
				if = {
					limit = { RUS_titov = yes }
					if = {
						limit = {
							RUS_aleksandr_titov = { has_trait = RUS_titov_1_off }
							OR = {
								has_idea = volunteer_only
								has_idea = limited_conscription
							}
						}
						remove_country_leader_trait = RUS_titov_1_off
						add_country_leader_trait = RUS_titov_1_on
					}
					else_if = {
						limit = {
							RUS_aleksandr_titov = { has_trait = RUS_titov_1_on }
							NOT = {
								has_idea = volunteer_only
								has_idea = limited_conscription
							}
						}
						remove_country_leader_trait = RUS_titov_1_on
						add_country_leader_trait = RUS_titov_1_off
					}
					if = {
						limit = {
							RUS_aleksandr_titov = { has_trait = RUS_titov_2_off }
							has_equipment = { train_equipment > 400 }
							has_equipment = { convoy > 500 }
							has_equipment = { motorized_equipment > 8000 }
						}
						remove_country_leader_trait = RUS_titov_2_off
						add_country_leader_trait = RUS_titov_2_on
					}
					if = {
						limit = {
							RUS_aleksandr_titov = { has_trait = RUS_titov_3_off }
							RUS = { has_non_aggression_pact_with = INT }
							NOT = {
								any_other_country = {
									is_in_europe = yes
									is_in_faction = no
									is_subject = no
									NOT = { is_guaranteed_by = RUS }
								}
							}
						}
						remove_country_leader_trait = RUS_titov_3_off
						add_country_leader_trait = RUS_titov_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_titov_1_on
								has_trait = RUS_titov_2_on
								has_trait = RUS_titov_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Rikhter
				if = {
					limit = { RUS_rikhter = yes }
					if = {
						limit = {
							RUS_vladimir_rikhter = { has_trait = RUS_rikhter_1_off }
							NOT = {
								has_idea = RUS_republic_under_watch
								has_idea = RUS_republic_under_watch_2
							}
							has_completed_focus = RUS_republicanisation_of_army
						}
						remove_country_leader_trait = RUS_rikhter_1_off
						add_country_leader_trait = RUS_rikhter_1_on
					}
					if = {
						limit = {
							RUS_vladimir_rikhter = { has_trait = RUS_rikhter_2_off }
							is_in_coalition_with_radical_socialist = yes
							OR = {
								has_idea = RUS_strenghtening_democracy
								has_idea = RUS_strong_democracy
								has_idea = RUS_genuine_democracy
							}
						}
						remove_country_leader_trait = RUS_rikhter_2_off
						add_country_leader_trait = RUS_rikhter_2_on
					}
					if = {
						limit = {
							RUS_vladimir_rikhter = { has_trait = RUS_rikhter_3_off }
							NOT = {
								any_other_country = {
									is_in_europe = yes
									is_monarchy = yes
									is_major = yes
								}
							}
						}
						remove_country_leader_trait = RUS_rikhter_3_off
						add_country_leader_trait = RUS_rikhter_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_rikhter_1_on
								has_trait = RUS_rikhter_2_on
								has_trait = RUS_rikhter_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Fondaminsky
				if = {
					limit = { RUS_fondaminsky = yes }
					if = {
						limit = {
							RUS_ilya_fondaminsky = { has_trait = RUS_fondaminsky_1_off }
							RUS_patriarch = { is_hired_as_advisor = yes }
							has_country_flag = RUS_imperial_family_martyrs
						}
						remove_country_leader_trait = RUS_fondaminsky_1_off
						add_country_leader_trait = RUS_fondaminsky_1_on
					}
					if = {
						limit = {
							RUS_ilya_fondaminsky = { has_trait = RUS_fondaminsky_2_off }
							has_stability > 0.99
						}
						remove_country_leader_trait = RUS_fondaminsky_2_off
						add_country_leader_trait = RUS_fondaminsky_2_on
					}
					if = {
						limit = {
							RUS_ilya_fondaminsky = { has_trait = RUS_fondaminsky_3_off }
							NOT = {
								any_other_country = {
									has_socialist_government = yes
									strength_ratio = { tag = ROOT ratio > 1 }
								}
							}
						}
						remove_country_leader_trait = RUS_fondaminsky_3_off
						add_country_leader_trait = RUS_fondaminsky_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_fondaminsky_1_on
								has_trait = RUS_fondaminsky_2_on
								has_trait = RUS_fondaminsky_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Sorokin
				if = {
					limit = { RUS_sorokin = yes }
					if = {
						limit = {
							RUS_pitirim_sorokin = { has_trait = RUS_sorokin_1_off }
							NOT = { has_completed_focus = RUS_press_controls }
							has_idea = RUS_genuine_democracy
							check_variable = { RUS_sorokin_var = 4 }
						}
						remove_country_leader_trait = RUS_sorokin_1_off
						add_country_leader_trait = RUS_sorokin_1_on
					}
					if = {
						limit = {
							RUS_pitirim_sorokin = { has_trait = RUS_sorokin_2_off }
							NOT = {
								any_owned_state = {
									impassable = no
									infrastructure < 3
								}
							}
						}
						remove_country_leader_trait = RUS_sorokin_2_off
						add_country_leader_trait = RUS_sorokin_2_on
					}
					if = {
						limit = {
							RUS_pitirim_sorokin = { has_trait = RUS_sorokin_3_off }
							if = {
								limit = { UKR = { exists = no } }
								has_country_flag = RUS_full_UKR_autonomy
							}
							if = {
								limit = { BLR = { exists = no } }
								206 = { has_state_flag = belarus_state }
							}
							651 = { has_state_flag = bashkir_state }
							574 = { has_state_flag = yakut_state }
							216 = { has_state_flag = karelian_state }
							255 = { has_state_flag = mordva_state }
							232 = { has_state_flag = dagestan_state }
							589 = { has_state_flag = alash_state }
						}
						remove_country_leader_trait = RUS_sorokin_3_off
						add_country_leader_trait = RUS_sorokin_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_sorokin_1_on
								has_trait = RUS_sorokin_2_on
								has_trait = RUS_sorokin_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Maklakov
				if = {
					limit = { RUS_maklakov = yes }
					# Checking for var:country_leader as these are used for both Maklakov and Nekrasov
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_maklakov_1_off }
							is_in_coalition_with_social_liberal = yes
							OR = {
								NOT = { has_idea = RUS_military_anger_dem }
								AND = {
									check_variable = { RUS_right_anger < 3 }
									check_variable = { RUS_left_anger < 3 }
									check_variable = { RUS_military_anger < 3 }
								}
							}
						}
						remove_country_leader_trait = RUS_maklakov_1_off
						add_country_leader_trait = RUS_maklakov_1_on
					}
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_maklakov_2_off }
							amount_taken_ideas = {
								amount > 5
								slots = {
									political_advisor
									high_command
								}
							}
						}
						remove_country_leader_trait = RUS_maklakov_2_off
						add_country_leader_trait = RUS_maklakov_2_on
					}
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_maklakov_3_off }
							OR = {
								AND = {
									has_war = yes
									any_enemy_country = { has_elected_government = no }
								}
								any_other_country = {
									has_war = yes
									ROOT = { is_lend_leasing = PREV }
									any_enemy_country = { has_elected_government = no }
								}
							}
						}
						remove_country_leader_trait = RUS_maklakov_3_off
						add_country_leader_trait = RUS_maklakov_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_maklakov_1_on
								has_trait = RUS_maklakov_2_on
								has_trait = RUS_maklakov_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Kartashyov
				if = {
					limit = { RUS_kartashyov = yes }
					if = {
						limit = {
							RUS_anton_kartashyov = { has_trait = RUS_kartashyov_1_off }
							NOT = {
								any_of_scopes = {
									array = RUS_kartashyov_targets
									exists = yes
									NOT = { is_in_faction_with = ROOT }
								}
							}
						}
						remove_country_leader_trait = RUS_kartashyov_1_off
						add_country_leader_trait = RUS_kartashyov_1_on
					}
					if = {
						limit = {
							RUS_anton_kartashyov = { has_trait = RUS_kartashyov_2_off }
							totalist < 0.04
							syndicalist < 0.04
							radical_socialist < 0.04
							social_democrat < 0.04
						}
						remove_country_leader_trait = RUS_kartashyov_2_off
						add_country_leader_trait = RUS_kartashyov_2_on
					}
					if = {
						limit = {
							RUS_anton_kartashyov = { has_trait = RUS_kartashyov_3_off }
							num_faction_members > 29
						}
						remove_country_leader_trait = RUS_kartashyov_3_off
						add_country_leader_trait = RUS_kartashyov_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_kartashyov_1_on
								has_trait = RUS_kartashyov_2_on
								has_trait = RUS_kartashyov_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Dolgorukov
				if = {
					limit = { RUS_dolgorukov = yes }
					if = {
						limit = {
							RUS_pyotr_dolgorukov = { has_trait = RUS_dolgorukov_1_off }
							market_liberal > 0.59
						}
						remove_country_leader_trait = RUS_dolgorukov_1_off
						add_country_leader_trait = RUS_dolgorukov_1_on
					}
					if = {
						limit = {
							RUS_pyotr_dolgorukov = { has_trait = RUS_dolgorukov_2_off }
							NOT = {
								any_owned_state = {
									impassable = no
									is_one_state_island = no
									industrial_complex < 1
								}
							}
						}
						remove_country_leader_trait = RUS_dolgorukov_2_off
						add_country_leader_trait = RUS_dolgorukov_2_on
					}
					if = {
						limit = {
							RUS_pyotr_dolgorukov = { has_trait = RUS_dolgorukov_3_off }
							has_completed_focus = RUS_ally_army
							has_country_flag = RUS_business_deal
							check_variable = { RUS_left_anger < 3 }
						}
						remove_country_leader_trait = RUS_dolgorukov_3_off
						add_country_leader_trait = RUS_dolgorukov_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_dolgorukov_1_on
								has_trait = RUS_dolgorukov_2_on
								has_trait = RUS_dolgorukov_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Golitsyn & Romanov
				if = {
					limit = { RUS_golitsyn = yes }
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_golitsyn_1_off }
							OR = {
								RUS_dmitry_romanov = { is_country_leader = yes }
								RUS_dmitry_romanov = { is_hired_as_advisor = yes }
								RUS_vladimir_romanov = { is_hired_as_advisor = yes }
							}
						}
						remove_country_leader_trait = RUS_golitsyn_1_off
						add_country_leader_trait = RUS_golitsyn_1_on
					}
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_golitsyn_2_off }
							has_stability > 0.79
						}
						remove_country_leader_trait = RUS_golitsyn_2_off
						add_country_leader_trait = RUS_golitsyn_2_on
					}
					if = {
						limit = {
							var:country_leader = { has_trait = RUS_golitsyn_3_off }
							has_army_manpower = { size > 999999 }
						}
						remove_country_leader_trait = RUS_golitsyn_3_off
						add_country_leader_trait = RUS_golitsyn_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_golitsyn_1_on
								has_trait = RUS_golitsyn_2_on
								has_trait = RUS_golitsyn_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
				### Solonevich
				if = {
					limit = {
						RUS_solonevich = yes
						NOT = { has_completed_focus = RUS_return_to_tradition }
					}
					if = {
						limit = {
							RUS_ivan_solonevich = { has_trait = RUS_solonevich_1_off }
							count_triggers = {
								amount = 3
								RUS_boris_suvorin = { is_hired_as_advisor = yes }
								RUS_patriarch = { is_hired_as_advisor = yes }
								RUS_nikolay_trubetskoy = { is_hired_as_advisor = yes }
								RUS_aleksandr_trushnovich = { is_hired_as_advisor = yes }
								RUS_sergey_l_voytsekhovsky = { is_hired_as_advisor = yes }
								RUS_vasily_shulgin = { is_hired_as_advisor = yes }
								RUS_ivan_ilyin = { is_hired_as_advisor = yes }
								RUS_dmitry_romanov = { is_hired_as_advisor = yes }
								RUS_pavel_shatilov = { is_hired_as_advisor = yes }
								RUS_vladimir_romanov = { is_hired_as_advisor = yes }
								RUS_dmitry_romanov = { is_hired_as_advisor = yes }
								RUS_igor_sikorsky = { is_hired_as_advisor = yes }
								RUS_maria_zakharchenko = { is_hired_as_advisor = yes }
							}
							any_army_leader = {
								is_field_marshal = yes
								OR = {
									is_character = RUS_mikhail_drozdovsky
									is_character = RUS_mikhail_diterikhs
									is_character = RUS_pavel_shatilov
									is_character = RUS_vladimir_kappel
									is_character = RUS_anton_turkul
									is_character = RUS_yevgeny_miller
								}
							}
						}
						remove_country_leader_trait = RUS_solonevich_1_off
						add_country_leader_trait = RUS_solonevich_1_on
					}
					if = {
						limit = {
							RUS_ivan_solonevich = { has_trait = RUS_solonevich_2_off }
							has_stability > 0.49
							social_conservative > 0.49
							has_country_flag = RUS_solonevich_re-elected
						}
						remove_country_leader_trait = RUS_solonevich_2_off
						add_country_leader_trait = RUS_solonevich_2_on
					}
					if = {
						limit = {
							RUS_ivan_solonevich = { has_trait = RUS_solonevich_3_off }
							NOT = {
								any_of_scopes = {
									array = RUS_solonevich_targets
									exists = yes
									NOT = { is_in_faction_with = ROOT }
								}
							}
						}
						remove_country_leader_trait = RUS_solonevich_3_off
						add_country_leader_trait = RUS_solonevich_3_on
					}
					var:country_leader = {
						if = {
							limit = {
								has_trait = RUS_solonevich_1_on
								has_trait = RUS_solonevich_2_on
								has_trait = RUS_solonevich_3_on
							}
							set_character_flag = RUS_agendas_complete
						}
					}
				}
			}
			if = { ### Russian MIO weekly updates
				limit = { has_dlc_aat = yes }
				RUS_Update_MIO_Research_Speeds = yes
				RUS_Update_MIO_XP_Gains = yes
				RUS_Update_Sokol = yes
				RUS_Update_Decaying_Funds_Bonus = yes
			}
			if = {
				limit = {
					NOT = { has_country_flag = RUS_report_done }
					date > 1940.1.1
				}
				RUS_Balance_Report = yes
				set_country_flag = RUS_report_done
			}
		}
	}

	#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			FROM = {
				if = {
					limit = { tag = var:global.russia }
					if = {
						limit = { var:219.owner = { is_russian_tag = yes } }
						set_variable = { global.russia = 219.owner }
					}
					else = {
						set_variable = { global.russia = RUS }
					}
				}
				if = {
					limit = { original_tag = RSA }
					RUS = { country_event = { id = freerus.4 days = 7 } }
				}
				else_if = {
					limit = { original_tag = FER }
					RUS = { clr_country_flag = RUS_semyonov_uprising }
					ROOT = {
						if = {
							limit = { original_tag = RUS }
							country_event = russia.616 #Semyonov's Trial
							FER_remove_japanese_resources = yes
						}
					}
				}
				else_if = {
					limit = { original_tag = RUS }
					clr_global_flag = RUS_war_for_bessarabia
					FER = {
						if = {
							limit = { owns_state = 219 } #Moscow
							set_cosmetic_tag = FER_RUS_state
						}
					}
				}
				else_if = {
					limit = { original_tag = ROM }
					clr_global_flag = RUS_war_for_bessarabia
				}
				else_if = {
					limit = { original_tag = GER }
					RUS = {
						mark_focus_tree_layout_dirty = yes
						country_event = { id = rusfla.134 days = 1 }
						country_event = { id = rusfla.26 days = 180 } # Churchill's Iron Curtain Speech
						country_event = { id = demrus.167 days = 120 } #From Men of War to Men of Peace
						country_event = { id = demrus.171 days = 280 } #Spread of the Revolutionary Cells
					}
					FER = { country_event = { id = fer.90 days = 1 } }
				}

				if = {
					limit = { has_country_flag = CA_alliance_leader }
					clr_country_flag = CA_alliance_leader
					clr_global_flag = CA_central_asian_alliance_created
				}

				### Econ Sphere Handling ###
				if = {
					limit = { tag = MEC }
					RUS_dismantle_economic_treaty = yes
					if = {
						limit = { is_in_tech_sharing_group = russian_research }
						every_country = {
							limit = {
								NOT = { tag = MEC }
								is_in_tech_sharing_group = russian_research
							}
							remove_from_tech_sharing_group = russian_research
						}
					}
				}
				else = {
					RUS_remove_from_economic_treaty = yes
					if = {
						limit = { is_in_tech_sharing_group = russian_research }
						remove_from_tech_sharing_group = russian_research
					}
				}

				if = {
					limit = { has_variable = RUS_alliance_disabled_integration }
					var:RUS_alliance_disabled_integration = {
						PREV = { enable_country_integration_80_compliance = yes }
						if = {
							limit = { PREV = { original_tag = UKR } }
							73 = { enable_state_integration_80_compliance = yes } #Transcarpathia
							78 = { enable_state_integration_80_compliance = yes } #Bessarabia
							80 = { enable_state_integration_80_compliance = yes } #Cernauti
							89 = { enable_state_integration_80_compliance = yes } #Stanislawow
							91 = { enable_state_integration_80_compliance = yes } #Lwow
							1088 = { enable_state_integration_80_compliance = yes } #Chelm

							241 = { disable_state_integration = yes } #Gomel
						}
						else_if = {
							limit = { PREV = { original_tag = JAP } }
							537 = { enable_state_integration_80_compliance = yes } #South Sakhalin
							555 = { enable_state_integration_80_compliance = yes } #Kuril Islands
							577 = { enable_state_integration_80_compliance = yes } #North Sakhalin
						}
						else_if = {
							limit = { PREV = { original_tag = LIT } }
							188 = { enable_state_integration_80_compliance = yes } #Memel
						}
						else_if = {
							limit = { PREV = { original_tag = POL } }
							97 = { enable_state_integration_80_compliance = yes } #Bialystok
						}
						else_if = {
							limit = { PREV = { original_tag = FIN } }
							146 = { enable_state_integration_80_compliance = yes } #Karelia
						}
						else_if = {
							limit = { PREV = { original_tag = ROM } }
							78 = { enable_state_integration_80_compliance = yes } #Bessarabia
						}
						else_if = {
							limit = { PREV = { original_tag = GEO } }
							585 = { enable_state_integration_80_compliance = yes } #Batumi
						}
						else_if = {
							limit = { PREV = { original_tag = ARM } }
							1000 = { enable_state_integration_80_compliance = yes } #Kars
						}
						else_if = {
							limit = { PREV = { original_tag = PER } }
							418 = { enable_state_integration_80_compliance = yes } #Ashkhabad
						}
					}
					clear_variable = RUS_alliance_disabled_integration
				}
			}
		}
	}

	#ROOT is winner, FROM is loser (called for all winners against all losers)
	on_before_peace_conference_start = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = { tag = RUS }
				}
				RUS_set_up_peace_conference_with_germany = yes
			}
		}
	}

	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			### RSA post-defeat setup
			if = {
				limit = {
					tag = RSA
					is_subject_of = GER
					FROM = { tag = RUS }
				}
				RUS_setup_demrus_postwar = yes
				remove_puppet_and_leave_faction = yes
				separate_peace_all_wars = yes
				if = {
					limit = {
						GER = {
							OR = {
								has_completed_focus = GER_clash_of_civilisations
								has_country_leader = { character = GER_max_bauer }
							}
						}
					}
					add_ideas = RUS_treaty_of_moscow_2
				}
				else = {
					add_ideas = RUS_treaty_of_moscow
				}
				if = {
					limit = { owns_state = 961 } #Chechnya
					give_resource_rights = {
						receiver = ROOT
						state = 961
						resources = { oil }
					}
				}
				if = {
					limit = { owns_state = 232 } #Dagestan
					give_resource_rights = {
						receiver = ROOT
						state = 232
						resources = { oil }
					}
				}

				#If FER agreed to join Boldyrev, annex them into RSA
				if = {
					limit = { NOT = { has_global_flag = RUS_boldyrev_semyonov_pact } }
					FER = { country_event = { id = fer.52 days = 7 } }
				}
				else = {
					FER = { country_event = { id = rsa.20 days = 7 } }
				}
			}

			### MON events
			if = {
				limit = {
					tag = MON
					FROM = { tag = RUS }
					has_government = paternal_autocrat
				}
				country_event = { id = mon.2 days = 5 random_days = 5 }
			}
		}
	}

	on_peace = {
		effect = {
			if = {
				limit = {
					has_idea = RUS_anti_internationale_pact
					NOT = { country_exists = INT }
				}
				every_country = {
					limit = { has_idea = RUS_anti_internationale_pact }
					remove_ideas = RUS_anti_internationale_pact
				}
				mark_focus_tree_layout_dirty = yes
			}
			if = {
				limit = { original_tag = RUS }
				if = {
					limit = { NOT = { has_war_with = GER } }
					if = {
						limit = { has_idea = RUS_surrender_limit_idea }
						remove_ideas = RUS_surrender_limit_idea
					}
					if = {
						limit = { has_idea = RUS_patriotic_war_3 }
						remove_ideas = RUS_patriotic_war_3
					}
					if = {
						limit = { has_idea = RUS_long_war }
						remove_ideas = RUS_long_war
					}
					if = {
						limit = { has_idea = RUS_total_war }
						remove_ideas = RUS_total_war
					}
					if = {
						limit = {
							has_idea = RUS_sacred_war
							NOT = { country_exists = GER }
						}
						remove_ideas = RUS_sacred_war
					}
				}
				if = {
					limit = {
						has_idea = RUS_invade_britain
						NOT = { has_war_with = ENG }
					}
					remove_ideas = RUS_invade_britain
				}
				if = {
					limit = {
						has_idea = RUS_invade_japan
						NOT = { has_war_with = JAP }
					}
					remove_ideas = RUS_invade_japan
				}
			}
		}
	}

	on_capitulation_immediate = {
		effect = {
			if = {
				limit = { has_idea = RUS_patriotic_war_3 }
				remove_ideas = RUS_patriotic_war_3
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							AND = {
								tag = BLR
								UKR = { has_capitulated = yes }
							}
							AND = {
								tag = UKR
								BLR = { has_capitulated = yes }
							}
						}
					}
					FROM = {
						tag = RUS
						has_country_flag = RUS_national_committee
					}
				}
				if = {
					limit = {
						POL = {
							NOT = {
								has_socialist_government = yes
								has_government = national_populist
								has_government = paternal_autocrat
							}
						}
					}
					POL = { country_event = poland.410 }
				}
			}
		}
	}

	#ROOT is new controller
	#FROM is old controller
	#FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					ROOT = { tag = RUS }
					FROM = { tag = GER }
				}
				country_event = rusfla.172 #Germans Beg for Peace
			}

			if = {
				limit = { FROM = { tag = RUS } }
				FROM = { country_event = { id = russia.962 days = 1 } } #Stavka's Suspicions
			}

			if = {
				limit = {
					ROOT = { tag = RUS }
					FROM = { tag = JAP }
				}
				country_event = { id = rusfor.1312 days = 4 } #Northeast Anti-Japanese Allied Forces Teaching Brigade
			}

			# Tracking state control for Russia taking Armenia
			if = {
				limit = { original_tag = RUS }
				if = {
					limit = {
						FROM.FROM = {
							OR = {
								is_core_of = GEO
								is_core_of = ARM
								is_core_of = AZR
							}
						}
						OR = {
							GEO = { any_core_state = { has_dynamic_modifier = { modifier = RUS_georgia_modifier_autonomy } } }
							ARM = { any_core_state = { has_dynamic_modifier = { modifier = RUS_armenia_modifier_autonomy } } }
							AZR = { any_core_state = { has_dynamic_modifier = { modifier = RUS_azerbaijan_modifier_autonomy } } }
						}
					}
					FROM.FROM = {
						if = {
							limit = {
								OR = {
									is_core_of = GEO
									state = 1001 #Lazistan
								}
							}
							set_state_flag = georgian_state
							add_dynamic_modifier = { modifier = RUS_georgia_modifier_autonomy }
						}
						else_if = {
							limit = { is_core_of = ARM }
							set_state_flag = armenian_state
							add_dynamic_modifier = { modifier = RUS_armenia_modifier_autonomy }
						}
						else_if = {
							limit = { is_core_of = AZR }
							set_state_flag = azeri_state
							add_dynamic_modifier = { modifier = RUS_azerbaijan_modifier_autonomy }
						}
					}
				}
			}

			# Turn FER into SIB
			if = {
				limit = {
					original_tag = FER
					is_subject = yes
					owns_state = 566 #Irkutsk
					NOT = { owns_state = 219 } #Moscow
				}
				set_cosmetic_tag = FER_SIB
			}
		}
	}

	#ROOT is attacker
	#FROM is defender
	#fired when two countries end up at war with each other (on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first)
	on_war_relation_added = {
		effect = {
			if = { #If Russia goes to war against any Chinese tags
				limit = {
					ROOT = {
						OR = {
							original_tag = RUS
							is_chinese_tag = yes
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							is_chinese_tag = yes
						}
					}
				}
				if = {
					limit = {
						OR = {
							ROOT = { has_idea = RUS_chinese_military_mission_idea }
							FROM = { has_idea = RUS_chinese_military_mission_idea }
						}
					}
					ROOT = { remove_ideas = RUS_chinese_military_mission_idea }
					FROM = { remove_ideas = RUS_chinese_military_mission_idea }
				}
				if = {
					limit = {
						OR = {
							ROOT = {
								OR = {
									has_idea = RUS_china_trade_deal
									has_idea = RUS_china_trade_deal_2
								}
							}
							FROM = {
								OR = {
									has_idea = RUS_china_trade_deal
									has_idea = RUS_china_trade_deal_2
								}
							}
						}
					}
					ROOT = { remove_ideas = { RUS_china_trade_deal RUS_china_trade_deal_2 } }
					FROM = { remove_ideas = { RUS_china_trade_deal RUS_china_trade_deal_2 } }
				}
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = RUS
							tag = INT
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							tag = INT
						}
					}
				}
				every_country = {
					limit = {
						has_idea = RUS_anti_internationale_pact
						can_declare_war_on = INT
					}
					declare_war_on = {
						target = INT
						type = topple_government
					}
				}
				every_country = {
					limit = { has_idea = RUS_army_limits }
					remove_ideas = RUS_army_limits
				}
				RUS = {
					if = {
						limit = { has_idea = RUS_cold_war }
						remove_ideas = { RUS_cold_war }
					}
					else_if = {
						limit = { has_idea = RUS_cold_war_2 }
						remove_ideas = { RUS_cold_war_2 }
					}
					country_event = { id = russia.50 days = 10 random_days = 10 } #Great Patriotic War
					country_event = { id = russia.1120 days = 40 } #Uprising in ukraine
					if = {
						limit = { has_democratic_government = yes }
						country_event = { id = demrus.172 days = 30 } #Strikes Against the War!
					}
					if = {
						limit = { has_country_leader = { character = RUS_aleksey_ustinov } }
						country_event = socrus.200 #The Maximalist Manifesto
					}
				}
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = RUS
							original_tag = GER
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							original_tag = GER
						}
					}
				}
				RUS = {
					add_ideas = RUS_surrender_limit_idea
					if = {
						limit = {
							has_socialist_government = no
							NOT = { has_completed_focus = RUS_preemptive_war }
						}
						complete_national_focus = RUS_preemptive_war
					}
					if = {
						limit = {
							has_socialist_government = yes
						}
						country_event = { id = rusfla.39 days = 60 random_days = 60 } #Wave of White Sabotage
						if = {
							limit = { NOT = { has_completed_focus = RUS_anti_capitalist_warfare } }
							complete_national_focus = RUS_anti_capitalist_warfare
						}
					}
					if = {
						limit = { has_idea = RUS_national_defence_preparation_law }
						remove_ideas = { RUS_national_defence_preparation_law }
					}
					country_event = { id = russia.50 days = 10 random_days = 10 } #Great Patriotic War
					country_event = { id = russia.615 days = 25 random_days = 10 } #Semyonov's Return
					country_event = { id = freerus.10 days = 30 random_days = 20 } #The Free Russian Army Rises!
				}
				every_country = {
					limit = {
						is_ai = no
						OR = {
							has_country_flag = MIE_member
							AND = {
								OR = {
									original_tag = POL
									original_tag = UKR
								}
								is_in_faction_with = AUS
								AUS = { is_faction_leader = yes }
							}
						}
					}
					country_event = mie.19 # MIE hard mode
				}
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = RUS
							original_tag = UKR
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							original_tag = UKR
						}
					}
				}
				if = {
					limit = { RUS = { RUS_can_integrate = yes } }
					for_each_scope_loop = {
						array = 202.annexation_extra_states #Kyiv
						if = {
							limit = {
								NOT = { is_core_of = RUS }
								NOT = { state = 93 } #Brest
							}
							add_claim_by = RUS
						}
					}
				}
				UKR = {
					if = {
						limit = { has_government = national_populist }
						RUS = { set_country_flag = RUS_lun_kharkov }
					}
					else_if = {
						limit = { has_country_leader = { character = UKR_pavlo_skoropadskyi } }
						RUS = { set_country_flag = RUS_hetman_kharkov }
					}
					else_if = {
						limit = { has_government = syndicalist }
						RUS = { set_country_flag = RUS_borot_kharkov }
					}
					else_if = {
						limit = {
							is_monarchy = no
							OR = {
								has_left_democratic_government = yes
								has_government = radical_socialist
							}
						}
						RUS = { set_country_flag = RUS_upr_kharkov }
					}
				}
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = RUS
							original_tag = BLR
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							original_tag = BLR
						}
					}
				}
				if = {
					limit = { RUS = { RUS_can_integrate = yes } }
					for_each_scope_loop = {
						array = 206.annexation_extra_states #Minsk
						if = {
							limit = {
								NOT = { is_core_of = RUS }
								NOT = { state = 93 } #Brest
							}
							add_claim_by = RUS
						}
					}
				}
			}

			if = {
				limit = {
					POL = { is_monarchy = yes }
					ROOT = {
						OR = {
							original_tag = RUS
							original_tag = POL
						}
					}
					FROM = {
						OR = {
							original_tag = RUS
							original_tag = POL
						}
					}
				}
				RUS = { set_country_flag = RUS_POL_had_monarchy }
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = FER
							original_tag = RSA
						}
					}
					FROM = {
						OR = {
							original_tag = FER
							original_tag = RSA
						}
					}
				}
				FER = {
					country_event = { id = fer.93 days = 1 } #In Defence of Siberia
					country_event = { id = fer.101 days = 1 } #The War of National Reclamation
				}
			}

			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = FER
							original_tag = JAP
						}
					}
					FROM = {
						OR = {
							original_tag = FER
							original_tag = JAP
						}
					}
				}
				FER = { FER_banish_japanese = yes }
			}

			if = {
				limit = { has_idea = RUS_moscow_eco_treaty_RUS }
				FROM = { RUS_remove_from_economic_treaty = yes }
			}
			else_if = {
				limit = { FROM = { has_idea = RUS_moscow_eco_treaty_RUS } }
				RUS_remove_from_economic_treaty = yes
			}
			else_if = {
				limit = { is_ally_with = MEC }
				FROM = { RUS_remove_from_economic_treaty = yes }
			}
			else_if = {
				limit = { FROM = { is_ally_with = MEC } }
				RUS_remove_from_economic_treaty = yes
			}
		}
	}

	#FROM is war target
	on_declare_war = {
		#RUS declares war on CA for the first time
		effect = {
			if = {
				limit = {
					tag = RUS
					FROM = { tag = TRK }
					has_socialist_government = no
					NOT = { has_global_flag = CA_turkestan_victorious }
				}
				every_state = {
					limit = {
						OR = {
							is_core_of = KAZ
							is_core_of = TRK
							is_core_of = BUK
							is_core_of = KHI
						}
					}
					add_claim_by = ROOT
				}
			}
		}
	}

	on_send_volunteers = {
		effect = {
			if = {
				limit = { original_tag = RUS }
				if = { #Support Belgrade Pact potential Power Projection
					limit = {
						country_exists = BPL
						BPL = { has_war_with = BUL }
						FROM = { has_war_with = BUL }
					}
					set_country_flag = RUS_belgrade_support_volunteers
				}
				if = { #Support Anti-Ottoman Desert War Participants for Power Projection
					limit = {
						OR = {
							EGY = {
								has_war_with = OTT
								is_subject = no
							}
							PER = {
								has_war_with = OTT
								is_subject = no
							}
						}
						FROM = {
							has_war_with = OTT
							OR = {
								is_ally_with = EGY
								is_ally_with = PER
								has_war_together_with = EGY
								has_war_together_with = PER
							}
						}
					}
					set_country_flag = RUS_cairo_pact_support_volunteers
				}
				if = { #Supporting Anti-CSA factions in ACW for Power Projection
					limit = {
						NOT = { has_global_flag = USA_civil_war_over_flag }
						FROM = {
							is_american_tag = yes
							has_socialist_government = no
						}
					}
					set_country_flag = RUS_USA_support_volunteers
				}
				if = { #Supporting Carlists for Power Projection
					limit = {
						FROM = {
							original_tag = SPA
							has_socialist_government = no
							has_civil_war = yes
						}
					}
					set_country_flag = RUS_Spain_support_volunteers
				}
				if = { #Supporting East Turkestan for Power Projection
					limit = {
						FROM = { original_tag = ETS }
						OR = {
							country_exists = SIK
							country_exists = KUM
						}
					}
					set_country_flag = RUS_Turkestan_support_volunteers
				}
				if = { #Supporting Mongolia for Power Projection
					limit = {
						NOT = { has_global_flag = northwest_conflict_ended }
						FROM = { original_tag = MON }
					}
					set_country_flag = RUS_Mongolia_support_volunteers
				}
				if = { #Supporting Chinese claimant for Power Projection
					limit = { FROM = { has_idea = RUS_chinese_military_mission_idea } }
					set_country_flag = RUS_China_support_volunteers
				}
			}
		}
	}

	on_ruling_party_change = {
		# temp var old_ideology_token is available for effects
		effect = {
			### MIO Handling ###
			if = {
				limit = {
					is_russian_tag = yes
					mio:RUS_bz_organisation = {
						has_mio_policy_active = RUS_mio_policy_political_interference_bz
					}
				}
				meta_effect = {
					text = {
						remove_ideas = RUS_bz_political_interference_[OLD_IDEOLOGY_TOKEN]
					}
					OLD_IDEOLOGY_TOKEN = "[?old_ideology_token.GetTokenKey]"
				}
				RUS_bz_add_political_interference = yes
			}
		}
	}
}
