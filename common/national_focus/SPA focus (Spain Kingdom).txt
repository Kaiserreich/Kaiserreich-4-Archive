###########################
# Spain-Kingdom Focus Tree
# By Rylock
# Revamped by SuperGreenBeans, Cazadorian and Klyntar King
###########################

focus_tree = {

	id = SPA_focus
	country = {
		factor = 0
		modifier = {
			add = 10
			tag = SPA
		}
	}
	default = no
	continuous_focus_position = { x = 3000 y = 1400 }

	### PRE-CIVIL WAR FOCUSES

	focus = {
		id = SPA_strengthen_kingdom
		icon = GFX_focus_generic_home_defense
		cost = 5

		x = 20
		y = 6

		allow_branch = {
			NOT = { has_country_flag = pre_civil_war_over }
		}
		mutually_exclusive = {
			focus = SPA_destabilise_kingdom
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 50 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_strengthen_kingdom"
			add_stability = 0.05
			add_political_power = 30
			custom_effect_tooltip = SPA_picking_our_route_tt
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = SPA_focus_economy
		icon = GFX_goal_generic_construction2
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -3
		y = 1

		prerequisite = {
			focus = SPA_strengthen_kingdom
		}
		mutually_exclusive = {
			focus = SPA_focus_military
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 50 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_focus_economy"
			if = {
				limit = { NOT = { has_idea = SPA_black_monday } }
				add_ideas = SPA_future_investment
			}
			else = {
				custom_effect_tooltip = SPA_fake_economy_promises_tt
				swap_ideas = {
					remove_idea = SPA_black_monday
					add_idea = SPA_black_monday_2
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = SPA_construction_focus
		icon = GFX_goal_generic_construction
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -2
		y = 2

		prerequisite = {
			focus = SPA_focus_economy
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_construction_focus"
			add_timed_idea = {
				idea = SPA_infra_projects
				days = 200
			}
			41 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = infrastructure level = 1 instant_build = yes }
			}
			167 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = infrastructure level = 1 instant_build = yes }
			}
			793 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = infrastructure level = 1 instant_build = yes }
			}

			build_railway = {
				path = { 3794 3820 13557 11809 9870 885 }
			}
			build_railway = {
				path = { 758 3761 6764 9719 13066 11707 }
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = SPA_civ_production
		icon = GFX_goal_generic_construct_civ_factory
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -4
		y = 2

		prerequisite = {
			focus = SPA_focus_economy
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_civ_production"
			random_owned_controlled_state = {
				prioritize = { 41 } #Madrid
				limit = {
					free_building_slots = { building = industrial_complex size > 1 include_locked = yes }
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
			}
			random_owned_controlled_state = {
				prioritize = { 176 } #Castille
				limit = {
					free_building_slots = { building = industrial_complex size > 1 include_locked = yes }
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
			}
			random_owned_controlled_state = {
				prioritize = { 165 } #Catalonia
				limit = {
					free_building_slots = { building = industrial_complex size > 1 include_locked = yes }
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = SPA_new_jobs
		icon = GFX_goal_generic_positive_trade_relations
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -4
		y = 4

		prerequisite = {
			focus = SPA_civ_production
		}
		prerequisite = {
			focus = SPA_construction_focus
		}

		ai_will_do = { factor = 1 }

		bypass = {
			has_global_flag = spanish_civil_war
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_new_jobs"
			add_timed_idea = {
				idea = SPA_growing_support
				days = 180
			}
			add_tech_bonus = {
				name = SPA_new_jobs
				bonus = 1
				uses = 1
				category = industry
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = { # Repurpose Steel Mills
		id = SPA_repurpose_steel_mills
		icon = GFX_focus_DEN_limited_regulations
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -3
		y = 3

		prerequisite = {
			focus = SPA_construction_focus
		}
		mutually_exclusive = {
			focus = SPA_relocate_factories_seville
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_repurpose_steel_mills"
			173 = {
				add_resource = {
					type = steel
					amount = -4
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = { #Relocate Industry to the South
		id = SPA_relocate_factories_seville
		icon = GFX_goal_generic_industry_reallocation
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = -1
		y = 3

		prerequisite = {
			focus = SPA_construction_focus
		}
		mutually_exclusive = {
			focus = SPA_repurpose_steel_mills
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_relocate_factories_seville"
			169 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			170 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			166 = {
				remove_building = {
					type = industrial_complex
					level = 1
				}
			}
			1070 = {
				remove_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {
		id = SPA_focus_military
		icon = GFX_goal_generic_allies_build_infantry
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 2
		y = 1

		prerequisite = {
			focus = SPA_strengthen_kingdom
		}
		mutually_exclusive = {
			focus = SPA_focus_economy
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 50 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_focus_military"
			add_timed_idea = {
				idea = SPA_military_focus
				days = 200
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {
		id = SPA_mil_production
		icon = GFX_goal_generic_construct_mil_factory
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_focus_military
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_mil_production"
			41 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = arms_factory level = 1 instant_build = yes }
			}
			169 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = arms_factory level = 1 instant_build = yes }
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = SPA_mil_planning
		icon = GFX_goal_generic_army_doctrines
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 2
		y = 3

		prerequisite = {
			focus = SPA_focus_military
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_mil_planning"
			add_doctrine_cost_reduction = {
				name = SPA_mil_planning
				cost_reduction = 0.5
				uses = 2
				category = land_doctrine
			}
			country_event = { id = spanish_civil_war_events.2 days = 2 }
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {
		id = SPA_fortify_madrid
		icon = GFX_goal_generic_fortify_city
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 3
		y = 2

		prerequisite = {
			focus = SPA_focus_military
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_fortify_madrid"
			41 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = 3938
						level = 4
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = bunker
						NUMBER = 4
						VP = 3938
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = SPA_army_of_africa
		icon = GFX_goal_conquistador_legacy
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 1
		y = 4

		prerequisite = {
			focus = SPA_mil_planning
		}
		mutually_exclusive = {
			focus = SPA_german_assistance
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_army_of_africa"
			custom_effect_tooltip = SPA_on_civil_war_start
			effect_tooltip = {
				SPA_army_of_africa_template = yes
			}
		}

		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {
		id = SPA_german_assistance
		icon = GFX_goal_COS_German_Bailout
		cost = 8

		relative_position_id = SPA_strengthen_kingdom
		x = 3
		y = 4

		prerequisite = {
			focus = SPA_mil_planning
		}
		mutually_exclusive = {
			focus = SPA_army_of_africa
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_german_assistance"
			custom_effect_tooltip = SPA_on_civil_war_start
			effect_tooltip = {
				SPA_german_light_tank_template = yes
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Destabilise the Kingdom
		id = SPA_destabilise_kingdom
		icon = GFX_focus_rom_handle_king
		cost = 5

		x = 9
		y = 6

		allow_branch = {
			NOT = { has_country_flag = pre_civil_war_over }
		}
		mutually_exclusive = {
			focus = SPA_strengthen_kingdom
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 0 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_destabilise_kingdom"
			add_stability = -0.05
			add_political_power = -30
			custom_effect_tooltip = SPA_destabilise_kingdom_tt
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Shatter Iberia's Chains
		id = SPA_focus_cnt
		icon = GFX_goal_cntfai
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = -1
		y = 1

		prerequisite = {
			focus = SPA_destabilise_kingdom
		}
		mutually_exclusive = {
			focus = SPA_focus_carlist
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 0 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_focus_cnt"
			add_timed_idea = {
				idea = SPA_cnt_destabilise
				days = 200
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# The Roads of War
		id = SPA_roads_of_war
		icon = GFX_goal_generic_road_construction
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_focus_cnt
		}

		ai_will_do = { factor = 1 }

		bypass = {
			has_global_flag = spanish_civil_war
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_roads_of_war"
			add_timed_idea = {
				idea = SPA_cnt_roads
				days = 200
			}
			940 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = infrastructure level = 1 instant_build = yes }
			}
			167 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = infrastructure level = 1 instant_build = yes }
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
	}

	focus = {# Comissió d'Indústries de Guerra
		id = SPA_cig
		icon = GFX_goal_munitions_factories
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = -3
		y = 2

		prerequisite = {
			focus = SPA_focus_cnt
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_cig"
			165 = {
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Raid Guardia Civil's Armouries
		id = SPA_raid_police
		icon = GFX_goal_generic_police_state
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_focus_cnt
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_raid_police"
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -500
			}
			SWF = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 500
					producer = SPA
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Sabotage Madrid's Factories
		id = SPA_factory_sabotage
		icon = GFX_focus_DEN_limited_regulations
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 0
		y = 3

		prerequisite = {
			focus = SPA_raid_police
		}
		prerequisite = {
			focus = SPA_roads_of_war
		}
		mutually_exclusive = {
			focus = SPA_zaragozan_steelworks
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_factory_sabotage"
			41 = {
				damage_building = {
					type = arms_factory
					damage = 0.5
				}
				damage_building = {
					type = industrial_complex
					damage = 0.5
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Expanding Zaragozan Steelworks
		id = SPA_zaragozan_steelworks
		icon = GFX_focus_generic_steel
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = -2
		y = 3

		prerequisite = {
			focus = SPA_cig
		}
		prerequisite = {
			focus = SPA_roads_of_war
		}
		mutually_exclusive = {
			focus = SPA_factory_sabotage
		}

		ai_will_do = { factor = 1 }

		bypass = {
			has_global_flag = spanish_civil_war
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_zaragozan_steelworks"
			add_resource = {
				type = steel
				amount = 4
				state = 166
			}
			166 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# The Righteous Cause of the Carlists
		id = SPA_focus_carlist
		icon = GFX_goal_carlist
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 4
		y = 1

		prerequisite = {
			focus = SPA_destabilise_kingdom
		}
		mutually_exclusive = {
			focus = SPA_focus_cnt
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 50 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_focus_carlist"
			add_timed_idea = {
				idea = SPA_carlist_destabilise
				days = 200
			}
			SPR = {
				add_timed_idea = { # This exists for flavour reasons, manpower doesn't actually get added to a non-existent tag.
					idea = SPA_carlist_manpower_transfer
					days = 200
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Invest in Galicia
		id = SPA_galician_tungsten
		icon = GFX_focus_generic_tungsten
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 5
		y = 2

		prerequisite = {
			focus = SPA_focus_carlist
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_galician_tungsten"
			add_resource = {
				type = tungsten
				amount = 4
				state = 171
			}
			171 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Industrial Expansions in Northern Spain
		id = SPA_northern_industry
		icon = GFX_goal_factory_complex
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 3
		y = 2

		prerequisite = {
			focus = SPA_focus_carlist
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_northern_industry"
			1070 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
			1081 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# The Stronghold of Burgos
		id = SPA_defend_burgos
		icon = GFX_goal_generic_castle
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 4
		y = 3

		prerequisite = {
			focus = SPA_galician_tungsten
		}
		prerequisite = {
			focus = SPA_northern_industry
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_defend_burgos"
			176 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = 885
						level = 2
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = bunker
						NUMBER = 2
						VP = 885
					}
				}
				add_building_construction = {
					type = anti_air_building
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# The Proclamation of the True King
		id = SPA_kings_proclamation
		icon = GFX_focus_spa_no_compromise_on_carlist_ideals
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 3
		y = 4

		prerequisite = {
			focus = SPA_defend_burgos
		}
		mutually_exclusive = {
			focus = SPA_portuguese_aid
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_kings_proclamation"
			add_timed_idea = {
				idea = SPA_carlist_proclaimation
				days = 150
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Aid From Our Iberian Brothers
		id = SPA_portuguese_aid
		icon = GFX_goal_POR_Kingdom_Emblem
		cost = 8

		relative_position_id = SPA_destabilise_kingdom
		x = 5
		y = 4

		prerequisite = {
			focus = SPA_defend_burgos
		}
		mutually_exclusive = {
			focus = SPA_kings_proclamation
		}

		bypass = {
			has_global_flag = spanish_civil_war
		}

		ai_will_do = { factor = 1 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_portuguese_aid"
			SPR = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 500
					producer = POR
				}
				add_equipment_to_stockpile = {
					type = support_equipment
					amount = 200
					producer = POR
				}
				add_equipment_to_stockpile = {
					type = artillery_equipment
					amount = 50
					producer = POR
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	### POST-CIVIL WAR FOCUSES

	focus = {
		id = SPA_consolidate_spain
		icon = GFX_goal_spain
		cost = 5

		x = 5
		y = 0

		available = {
			has_country_flag = SPA_aftermath_of_the_civil_war
		}

		bypass = {
			is_subject = yes
		}

		ai_will_do = { factor = 100 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_consolidate_spain"
			SPA_societal_recovery = yes
			if = {
				limit = { has_template = "Ejército de África" }
				set_division_template_lock = {
					division_template = "Ejército de África"
					is_locked = no
				}
			}
			if = {
				limit = { has_template = "División Blindada" }
				set_division_template_lock = {
					division_template = "División Blindada"
					is_locked = no
				}
			}
		}
		search_filters = { FOCUS_FILTER_ANNEXATION }
	}

	focus = { #Future of the Nation
		id = SPA_replace_alfonso
		icon = GFX_goal_monarchism
		cost = 5

		relative_position_id = SPA_consolidate_spain
		x = -2
		y = 1

		prerequisite = {
			focus = SPA_consolidate_spain
		}
		available = { is_subject = no }
		bypass_if_unavailable = yes

		ai_will_do = { factor = 1000 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_replace_alfonso"
			hidden_effect = {
				country_event = { id = spain_domestic_events.27 days = 2 }
			}
			SPA_societal_recovery = yes
		}
	}

	focus = {
		id = SPA_rights_spanish
		icon = GFX_goal_generic_stable_government
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = -3
		y = 1

		available = { has_democratic_government = yes }
		prerequisite = {
			focus = SPA_replace_alfonso
		}
		mutually_exclusive = { focus = SPA_falange }

		ai_will_do = { factor = 110 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_rights_spanish"
			SPA_societal_recovery = yes
			add_ideas = SPA_social_catholicism
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = SPA_jan
		icon = GFX_goal_generic_paramilitary
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = -3
		y = 3

		prerequisite = {
			focus = SPA_rights_spanish
		}

		ai_will_do = { factor = 110 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_jan"
			if = {
				limit = { has_idea = SPA_social_catholicism2 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism2
					add_idea = SPA_social_catholicism5
				}
			}
			else_if = {
				limit = { has_idea = SPA_social_catholicism3 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism3
					add_idea = SPA_social_catholicism6
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_social_catholicism
					add_idea = SPA_social_catholicism4
				}
			}
			add_war_support = 0.05
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_spanish_man
		icon = GFX_focus_generic_population_growth
		cost = 5

		relative_position_id = SPA_jan
		x = 0
		y = 1

		prerequisite = { focus = SPA_jan }
		prerequisite = { focus = SPA_corporate_state }

		ai_will_do = { factor = 110 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_spanish_man"
			if = {
				limit = { has_idea = SPA_social_catholicism6 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism6
					add_idea = SPA_social_catholicism7
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_social_catholicism8
					add_idea = SPA_social_catholicism9
				}
			}
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_organic_democracy
		icon = GFX_focus_generic_improve_the_administration
		cost = 5

		relative_position_id = SPA_spanish_man
		x = 1
		y = 1

		prerequisite = { focus = SPA_spanish_man }
		prerequisite = { focus = SPA_municipal_reorg }

		ai_will_do = { factor = 1000 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_organic_democracy"
			swap_ideas = {
				remove_idea = SPA_social_catholicism9
				add_idea = SPA_social_catholicism10
			}
			if = {
				limit = { is_subject = no }
				country_event = spanish_civil_war_events.603
			}
			else = {
				set_temp_variable = { ideology_change_var = 0.1 }
				change_ruling_party_popularity = yes
			}
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_arrest_leaders
		icon = GFX_goal_generic_police_state
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = -2
		y = 2

		prerequisite = { focus = SPA_falange focus = SPA_rights_spanish }

		ai_will_do = { factor = 110 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_arrest_leaders"
			remove_ideas = SPR_syndicalist_resistance
			add_popularity = { ideology = totalist popularity = -0.1 }
			add_popularity = { ideology = syndicalist popularity = -0.1 }
			add_popularity = { ideology = radical_socialist popularity = -0.1 }
		}
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = SPA_new_constitution
		icon = GFX_focus_spa_supremacy_of_the_communion
		cost = 5

		relative_position_id = SPA_arrest_leaders
		x = 4
		y = 0

		prerequisite = { focus = SPA_falange focus = SPA_rights_spanish }

		ai_will_do = { factor = 110 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_new_constitution"
			add_stability = 0.05
			SPR = {
				SPR_miguel_cabanellas_ferrer = { set_nationality = ROOT }
				SPR_rafael_garcia_valino_y_marcen = { set_nationality = ROOT }
				SPR_jose_enrique_varela_iglesias = { set_nationality = ROOT }
				SPR_alejandro_goicoechea_omar = { set_nationality = ROOT }
				SPR_pedro_segura_y_saenz = { set_nationality = ROOT }
				SPR_ricardo_de_rada_y_peral = {
					set_nationality = ROOT
					set_portraits = {
						army = {
							large = GFX_portrait_SPA_ricardo_de_rada_y_peral_legitimist_army_large
							small = GFX_portrait_SPA_ricardo_de_rada_y_peral_legitimist_army_small
						}
					}
				}
			}
			add_popularity = { ideology = national_populist popularity = 0.12 }
		}
		on_uncomplete = {
			SPK = {
				SPR_miguel_cabanellas_ferrer = { set_nationality = SPR }
				SPR_rafael_garcia_valino_y_marcen = { set_nationality = SPR }
				SPR_jose_enrique_varela_iglesias = { set_nationality = SPR }
				SPR_alejandro_goicoechea_omar = { set_nationality = SPR }
				SPR_pedro_segura_y_saenz = { set_nationality = SPR }
				SPR_ricardo_de_rada_y_peral = {
					set_nationality = SPR
					set_portraits = {
						army = {
							large = GFX_portrait_SPA_ricardo_de_rada_y_peral_carlist_army_large
							small = GFX_portrait_SPA_ricardo_de_rada_y_peral_carlist_army_small
						}
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = SPA_national_catholicism
		icon = GFX_focus_generic_catholic_dominion
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = 0
		y = 2

		prerequisite = { focus = SPA_falange focus = SPA_rights_spanish }

		ai_will_do = { factor = 110 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_national_catholicism"
			if = {
				limit = { has_idea = SPA_social_catholicism4 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism4
					add_idea = SPA_social_catholicism5
				}
			}
			else_if = {
				limit = { has_idea = SPA_falangism }
				swap_ideas = {
					remove_idea = SPA_falangism
					add_idea = SPA_falangism2
				}
			}
			else_if = {
				limit = { has_idea = SPA_falangism4 }
				swap_ideas = {
					remove_idea = SPA_falangism4
					add_idea = SPA_falangism5
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_social_catholicism
					add_idea = SPA_social_catholicism2
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
	}

	focus = {
		id = SPA_unity_at_last
		icon = GFX_focus_spa_unify_the_nationalist_front
		cost = 5

		relative_position_id = SPA_arrest_leaders
		x = 1
		y = 1

		prerequisite = { focus = SPA_arrest_leaders }
		prerequisite = { focus = SPA_new_constitution }
		prerequisite = { focus = SPA_national_catholicism }

		ai_will_do = { factor = 110 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_unity_at_last"
			if = {
				limit = { has_idea = SPA_memories_of_the_republic }
				remove_ideas = SPA_memories_of_the_republic
			}
			else = { remove_ideas = SPA_illegitimate_republic }
			SPA_societal_recovery = yes
			add_popularity = {
				ideology = social_conservative
				popularity = 0.06
			}
			set_temp_variable = { coalition_partner_var = token:social_conservative }
			add_to_coalition = yes
			if = {
				limit = { has_government = paternal_autocrat }
				add_popularity = {
					ideology = authoritarian_democrat
					popularity = 0.09
				}
				set_temp_variable = { coalition_partner_var = token:authoritarian_democrat }
				add_to_coalition = yes
			}
			else = {
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.09
				}
				set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
				add_to_coalition = yes
			}
		}
	}

	focus = {
		id = SPA_corporate_state
		icon = GFX_goal_generic_corporatism
		cost = 5

		relative_position_id = SPA_arrest_leaders
		x = 3
		y = 1

		prerequisite = { focus = SPA_arrest_leaders }
		prerequisite = { focus = SPA_new_constitution }
		prerequisite = { focus = SPA_national_catholicism }

		ai_will_do = { factor = 110 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_corporate_state"
			if = {
				limit = { has_idea = SPA_social_catholicism5 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism5
					add_idea = SPA_social_catholicism6
				}
			}
			else_if = {
				limit = { has_idea = SPA_falangism5 }
				swap_ideas = {
					remove_idea = SPA_falangism5
					add_idea = SPA_falangism6
				}
			}
			else_if = {
				limit = { has_idea = SPA_falangism2 }
				swap_ideas = {
					remove_idea = SPA_falangism2
					add_idea = SPA_falangism3
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_social_catholicism2
					add_idea = SPA_social_catholicism3
				}
			}
			add_political_power = 50
		}
	}

	focus = {
		id = SPA_charter_of_labour
		icon = GFX_focus_ITA_generic_fascist_workers
		cost = 5

		relative_position_id = SPA_corporate_state
		x = 0
		y = 1

		prerequisite = { focus = SPA_corporate_state }
		prerequisite = { focus = SPA_unity_at_last }
		prerequisite = { focus = SPA_ally_jon }
		mutually_exclusive = { focus = SPA_municipal_reorg }
		available = { has_completed_focus = SPA_falange }

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_charter_of_labour"
			if = {
				limit = { has_idea = SPA_falangism6 }
				swap_ideas = {
					remove_idea = SPA_falangism6
					add_idea = SPA_falangism7
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_falangism8
					add_idea = SPA_falangism9
				}
			}
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_municipal_reorg
		icon = GFX_goal_social_reforms
		cost = 5

		relative_position_id = SPA_corporate_state
		x = -2
		y = 1

		prerequisite = { focus = SPA_corporate_state }
		prerequisite = { focus = SPA_jan }
		prerequisite = { focus = SPA_unity_at_last }
		mutually_exclusive = { focus = SPA_charter_of_labour }
		available = { has_completed_focus = SPA_rights_spanish }

		ai_will_do = { factor = 110 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_municipal_reorg"
			if = {
				limit = { has_idea = SPA_social_catholicism6 }
				swap_ideas = {
					remove_idea = SPA_social_catholicism6
					add_idea = SPA_social_catholicism8
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_social_catholicism7
					add_idea = SPA_social_catholicism9
				}
			}
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_falange
		icon = GFX_goal_national_populism
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = 3
		y = 1

		available = { has_dictatorship_government = yes }
		prerequisite = { focus = SPA_replace_alfonso }
		mutually_exclusive = { focus = SPA_rights_spanish }

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_falange"
			SPA_societal_recovery = yes
			add_ideas = SPA_falangism
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = SPA_ally_jon
		icon = GFX_focus_spa_fuse_the_parties
		cost = 5

		relative_position_id = SPA_replace_alfonso
		x = 3
		y = 3

		prerequisite = {
			focus = SPA_falange
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_ally_jon"
			if = {
				limit = { has_idea = SPA_falangism2 }
				swap_ideas = {
					remove_idea = SPA_falangism2
					add_idea = SPA_falangism5
				}
			}
			else_if = {
				limit = { has_idea = SPA_falangism3 }
				swap_ideas = {
					remove_idea = SPA_falangism3
					add_idea = SPA_falangism6
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_falangism
					add_idea = SPA_falangism4
				}
			}
			add_popularity = {
				ideology = national_populist
				popularity = 0.06
			}
			set_temp_variable = { coalition_partner_var = token:national_populist }
			add_to_coalition = yes
			set_party_name = {
				ideology = national_populist
				name = SPA_paternal_autocrat_party
				long_name = SPA_paternal_autocrat_party_long
			}
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_abolish_parties
		icon = GFX_focus_generic_authoritarian_government
		cost = 5

		relative_position_id = SPA_ally_jon
		x = 0
		y = 1

		prerequisite = { focus = SPA_ally_jon }
		prerequisite = { focus = SPA_corporate_state }

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_abolish_parties"
			if = {
				limit = { has_idea = SPA_falangism6 }
				swap_ideas = {
					remove_idea = SPA_falangism6
					add_idea = SPA_falangism8
				}
			}
			else = {
				swap_ideas = {
					remove_idea = SPA_falangism7
					add_idea = SPA_falangism9
				}
			}
			add_popularity = { ideology = social_conservative popularity = -0.05 }
			add_popularity = { ideology = authoritarian_democrat popularity = -0.05 }
			add_popularity = { ideology = market_liberal popularity = -0.05 }
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {
		id = SPA_national_revolution
		icon = GFX_focus_spa_strengthen_the_supreme_reality_of_spain
		cost = 5

		relative_position_id = SPA_abolish_parties
		x = -1
		y = 1

		prerequisite = { focus = SPA_abolish_parties }
		prerequisite = { focus = SPA_charter_of_labour }

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_national_revolution"
			swap_ideas = {
				remove_idea = SPA_falangism9
				add_idea = SPA_falangism10
			}
			set_temp_variable = { ideology_change_var = 0.1 }
			change_ruling_party_popularity = yes
		}
		search_filters = { FOCUS_FILTER_WAR_SUPPORT }
	}

	focus = {# Rebuilding the Economy
		id = SPA_rebuilding_the_economy
		icon = GFX_goal_generic_production2
		cost = 7

		relative_position_id = SPA_consolidate_spain
		x = 7
		y = 1

		prerequisite = {
			focus = SPA_consolidate_spain
		}

		ai_will_do = { factor = 150 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_rebuilding_the_economy"
			add_ideas = SPA_rebuilding_spain_idea
			SPA_economic_recovery = yes
			add_tech_bonus = {
				name = SPA_rebuilding_the_economy
				bonus = 1
				uses = 1
				category = industry
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
	}

	focus = {# Expand the Railroads
		id = SPA_expand_railroads
		icon = GFX_goal_generic_construct_infrastructure
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -4
		y = 1

		prerequisite = {
			focus = SPA_rebuilding_the_economy
		}
		available = {
			41 = { is_fully_controlled_by = ROOT }
			1081 = { is_fully_controlled_by = ROOT }
			174 = { is_fully_controlled_by = ROOT }
			176 = { is_fully_controlled_by = ROOT }
			1070 = { is_fully_controlled_by = ROOT }
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_expand_railroads"
			1070 = {
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			if = {
				limit = {
					171 = { is_fully_controlled_by = ROOT }
				}
				171 = {
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				build_railway = {
					path = { 3938 3794 9800 9846 11825 918 3918 3727 3725 11840 11677 11692 6955 758 }
				}
			}
			build_railway = {
				path = { 11825 6936 903 885 11852 13563 740 }
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Extract Natural Resources
		id = SPA_resource_extraction
		icon = GFX_goal_generic_coal_mining
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -4
		y = 3

		prerequisite = {
			focus = SPA_expand_railroads
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_resource_extraction"
			custom_effect_tooltip = SPA_resource_extraction_tt
			effect_tooltip = {
				add_resource = {
					type = tungsten
					amount = 12
					state = 171
				}
			}
			if = {
				limit = { 171 = { is_controlled_by = ROOT } }
				hidden_effect = {
					add_resource = {
						type = tungsten
						amount = 12
						state = 171
					}
				}
			}
			custom_effect_tooltip = tooltip_white_line
			activate_targeted_decision = { target = ROOT decision = SPA_tungsten_mines }
			activate_targeted_decision = { target = ROOT decision = SPA_tungsten_mines_2 }
			activate_targeted_decision = { target = ROOT decision = SPA_aluminium_mines }
			activate_targeted_decision = { target = ROOT decision = SPA_steel_mines }
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Provincial Rebuilding
		id = SPA_provincial_rebuilding
		icon = GFX_goal_production
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -2
		y = 1

		prerequisite = {
			focus = SPA_rebuilding_the_economy
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_provincial_rebuilding"
			add_tech_bonus = {
				name = SPA_provincial_rebuilding
				bonus = 1
				uses = 2
				category = industry
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Military Investments
		id = SPA_military_investments
		icon = GFX_goal_national_arsenal
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -3
		y = 2

		prerequisite = {
			focus = SPA_provincial_rebuilding
		}
		mutually_exclusive = {
			focus = SPA_comercial_investment
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_military_investments"
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Commercial Investment
		id = SPA_comercial_investment
		icon = GFX_goal_construction_engineering
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_provincial_rebuilding
		}
		mutually_exclusive = {
			focus = SPA_military_investments
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_comercial_investment"
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Electrification Program
		id = SPA_electrification_program
		icon = GFX_goal_Schelle
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = -2
		y = 3

		prerequisite = {
			focus = SPA_military_investments
			focus = SPA_comercial_investment
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_electrification_program"
			SPA_economic_recovery = yes
			add_tech_bonus = {
				name = SPA_electrification_program
				bonus = 1
				uses = 2
				category = electronics
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Ley General de Educación
		id = SPA_ley_general_educacion
		icon = GFX_goal_BRA_catholic_education
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 0
		y = 1

		prerequisite = {
			focus = SPA_rebuilding_the_economy
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_ley_general_educacion"
			add_research_slot_until_five = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Expand Real Academia
		id = SPA_expand_real_academia
		icon = GFX_goal_KTG_Bookstack
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 0
		y = 3

		prerequisite = {
			focus = SPA_ley_general_educacion
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_expand_real_academia"
			add_ideas = SPA_real_academia_idea
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Instituto Nacional de Industria
		id = SPA_create_ini
		icon = GFX_generic_heavy_industry
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 2
		y = 1

		prerequisite = {
			focus = SPA_rebuilding_the_economy
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_create_ini"
			add_ideas = SPA_ini_idea
		}
	}

	focus = {# Industrial Nationalisation
		id = SPA_industrial_nationalisation
		icon = GFX_goal_economic_control
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_create_ini
		}
		mutually_exclusive = {
			focus = SPA_military_factories
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_industrial_nationalisation"
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Military Factories
		id = SPA_military_factories
		icon = GFX_goal_generic_construct_mil_factory
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 3
		y = 2

		prerequisite = {
			focus = SPA_create_ini
		}
		mutually_exclusive = {
			focus = SPA_industrial_nationalisation
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_military_factories"
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			random_owned_controlled_state = {
				limit = { is_core_of = ROOT is_in_home_area = yes }
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Modern Agriculture
		id = SPA_modern_agriculture
		icon = GFX_focus_AUS_agriculture
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 2
		y = 3

		prerequisite = {
			focus = SPA_industrial_nationalisation
			focus = SPA_military_factories
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_modern_agriculture"
			add_ideas = SPA_modern_agriculture_idea
			SPA_economic_recovery = yes
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_MANPOWER }
	}

	focus = {# Labour Charter
		id = SPA_labour_charter
		icon = GFX_goal_state_economy
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 4
		y = 1

		prerequisite = {
			focus = SPA_rebuilding_the_economy
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_labour_charter"
			add_stability = 0.05
			add_tech_bonus = {
				name = SPA_labour_charter
				bonus = 1
				uses = 1
				category = industry
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Catholic Trade Unions
		id = SPA_catholic_trade_unions
		icon = GFX_goal_generic_union_agreement
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 4
		y = 3

		prerequisite = {
			focus = SPA_labour_charter
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_catholic_trade_unions"
			add_ideas = SPA_catholic_trade_unions_idea
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Spanish Miracle
		id = SPA_spanish_miracle
		icon = GFX_focus_spa_the_spanish_miracle
		cost = 7

		relative_position_id = SPA_rebuilding_the_economy
		x = 0
		y = 4

		prerequisite = {
			focus = SPA_resource_extraction
		}
		prerequisite = {
			focus = SPA_electrification_program
		}
		prerequisite = {
			focus = SPA_expand_real_academia
		}
		prerequisite = {
			focus = SPA_modern_agriculture
		}
		prerequisite = {
			focus = SPA_catholic_trade_unions
		}

		ai_will_do = { factor = 200 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_spanish_miracle"
			if = {
				limit = { has_idea = SPA_rebuilding_spain_idea }
				remove_ideas = SPA_rebuilding_spain_idea
			}

			hidden_effect = {
				remove_ideas = {
					SPA_real_academia_idea
					SPA_ini_idea
					SPA_modern_agriculture_idea
					SPA_catholic_trade_unions_idea
					SPA_recovering_economy_3
				}
			}
			custom_effect_tooltip = SPA_economic_miracle_tt
			add_ideas = SPA_spanish_economic_miracle
			add_research_slot_until_five = yes
		}
	}

	### MILITARY FOCUSES

	focus = {# Rebuild National Command
		id = SPA_rebuild_command
		icon = GFX_goal_SPA_Army
		cost = 5

		x = 35
		y = 0

		ai_will_do = { factor = 30 }
		available = {
			has_global_flag = spanish_civil_war
		}
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_rebuild_command"
			army_experience = 25
			air_experience = 25
			navy_experience = 25
		}
		search_filters = { FOCUS_FILTER_ARMY_XP FOCUS_FILTER_NAVY_XP FOCUS_FILTER_AIR_XP }
	}

	focus = {# Reorganise the Infantry
		id = SPA_modern_terrico
		icon = GFX_goal_mass_concentration_of_army
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -3
		y = 1

		prerequisite = {
			focus = SPA_rebuild_command
		}
		mutually_exclusive = {
			focus = SPA_army_of_maneuver
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_modern_terrico"
			add_doctrine_cost_reduction = {
				name = SPA_modern_terrico
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Preservation of Order
		id = SPA_preservation_of_order
		icon = GFX_goal_focus_chain_army
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -4
		y = 2

		prerequisite = {
			focus = SPA_modern_terrico
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_preservation_of_order"
			add_ideas = SPA_preservation_of_order_idea
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Modern Guns for Modern Soldiers
		id = SPA_artillery_effort
		icon = GFX_focus_generic_military_equipment
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -2
		y = 2

		prerequisite = {
			focus = SPA_modern_terrico
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_artillery_effort"
			add_tech_bonus = {
				name = SPA_artillery_effort
				bonus = 0.5
				uses = 2
				category = infantry_weapons
				category = artillery
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Civil Guard
		id = SPA_guardia_civil
		icon = GFX_goal_enlist_the_police
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -3
		y = 3

		prerequisite = {
			focus = SPA_preservation_of_order
		}
		prerequisite = {
			focus = SPA_artillery_effort
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_guardia_civil"
			add_ideas = SPA_guardia_civil_idea
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Emergency Armament Production
		id = SPA_emergency_factories
		icon = GFX_goal_industry_air
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -2
		y = 4

		prerequisite = {
			focus = SPA_guardia_civil
			focus = SPA_adaptive_fortifications
		}
		available = {
			has_war = yes
		}

		ai_will_do = { factor = 30 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_emergency_factories"
			random_owned_controlled_state = {
				limit = {
					is_core_of = ROOT
					is_in_home_area = yes
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = arms_factory level = 1 instant_build = yes }
			}
			random_owned_controlled_state = {
				limit = {
					is_core_of = ROOT
					is_in_home_area = yes
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = arms_factory level = 1 instant_build = yes }
			}
			add_stability = -0.05
			add_manpower = -500
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Defenders of the Realm
		id = SPA_defenders_of_realm
		icon = GFX_focus_spa_unify_the_nationalist_front
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 0
		y = 2

		prerequisite = {
			focus = SPA_modern_terrico
			focus = SPA_army_of_maneuver
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_defenders_of_realm"
			enable_tech_urban_warfare = yes
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_MANPOWER }
	}

	focus = {# Adaptive Fortifications
		id = SPA_adaptive_fortifications
		icon = GFX_goal_generic_barricades
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = -1
		y = 3

		prerequisite = {
			focus = SPA_defenders_of_realm
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_adaptive_fortifications"
			add_ideas = SPA_adaptive_fortifications_idea
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Militarise the Railways
		id = SPA_militarise_the_railways
		icon = GFX_goal_generic_seize_railway
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 1
		y = 3

		prerequisite = {
			focus = SPA_defenders_of_realm
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_militarise_the_railways"
			add_tech_bonus = {
				name = SPA_militarise_the_railways
				bonus = 1
				uses = 1
				category = support_tech
			}
			add_ideas = SPA_military_railways
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Army of Maneuver
		id = SPA_army_of_maneuver
		icon = GFX_goal_generic_army_mobile_warfare
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 3
		y = 1

		prerequisite = {
			focus = SPA_rebuild_command
		}
		mutually_exclusive = {
			focus = SPA_modern_terrico
		}

		ai_will_do = { factor = 0 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_army_of_maneuver"
			add_doctrine_cost_reduction = {
				name = SPA_army_of_maneuver
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Spanish Auto Industry
		id = SPA_mechanized_effort
		icon = GFX_goal_generic_army_motorized
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 2
		y = 2

		prerequisite = {
			focus = SPA_army_of_maneuver
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_mechanized_effort"
			add_ideas = SPA_spanish_auto_industry
			if = {
				limit = { NOT = { has_tech = motorised_infantry } }
				set_technology = { motorised_infantry = 1 }
			}
			else = {
				add_tech_bonus = {
					name = SPA_mechanized_effort
					bonus = 1
					uses = 1
					category = cat_mechanized_equipment
				}
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Armoured Warfare Tactics
		id = SPA_weltrieg_lessons
		icon = GFX_EGY_Operation_Abu
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 4
		y = 2

		prerequisite = {
			focus = SPA_army_of_maneuver
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_weltrieg_lessons"
			add_ideas = SPA_the_new_doctrine_idea
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS }
	}

	focus = {# Navarran Lancers
		id = SPA_navarran_lancers
		icon = GFX_goal_generic_army_tanks
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 3
		y = 3

		prerequisite = {
			focus = SPA_mechanized_effort
		}
		prerequisite = {
			focus = SPA_weltrieg_lessons
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_navarran_lancers"
			add_tech_bonus = {
				name = SPA_navarran_lancers
				bonus = 1
				uses = 2
				category = armor
			}
			hidden_effect = {
				remove_ideas = {
					SPA_the_new_doctrine_idea
					SPA_spanish_auto_industry
				}
			}
			custom_effect_tooltip = SPA_army_idea_tt
			add_ideas = SPA_mechanised_army_idea
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# German Tank Shipments
		id = SPA_tank_shipments
		icon = GFX_goal_light_tanks
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 2
		y = 4

		prerequisite = {
			focus = SPA_militarise_the_railways
			focus = SPA_navarran_lancers
		}
		available = {
			has_war = yes
		}
		bypass = {
			OR = {
				NOT = { country_exists = GER }
				has_war_with = GER
			}
		}
		ai_will_do = { factor = 30 }

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_tank_shipments"
			add_equipment_to_stockpile = {
				type = light_tank_chassis
				amount = 100
				producer = GER
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# A Modern Army
		id = SPA_a_modern_army
		icon = GFX_goal_generic_army_training
		cost = 7

		relative_position_id = SPA_rebuild_command
		x = 0
		y = 4

		prerequisite = {
			focus = SPA_guardia_civil
			focus = SPA_navarran_lancers
		}
		prerequisite = {
			focus = SPA_adaptive_fortifications
		}
		prerequisite = {
			focus = SPA_militarise_the_railways
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_a_modern_army"
			army_experience = 25
			add_doctrine_cost_reduction = {
				name = SPA_a_modern_army
				cost_reduction = 0.5
				uses = 1
				category = land_doctrine
			}
			if = {
				limit = { has_global_flag = spanish_civil_war }
				add_timed_idea = {
					idea = SPA_the_final_push
					days = 365
				}
			}
		}
		search_filters = { FOCUS_FILTER_ARMY_XP FOCUS_FILTER_RESEARCH }
	}

### Navy ###
	focus = {# Armada Española
		id = SPA_armada_espanola
		icon = GFX_goal_SPA_Navy
		cost = 7

		x = 30
		y = 4

		prerequisite = {
			focus = SPA_rebuild_command
		}

		ai_will_do = {
			factor = 5
			modifier = {
				factor = 0
				has_civil_war = yes
				NOT = { has_completed_focus = SPA_a_modern_army }
			}
		}
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_armada_espanola"
			random_owned_controlled_state = {
				limit = {
					is_coastal = yes
					is_core_of = ROOT
					is_in_home_area = yes
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = dockyard
					level = 2
					instant_build = yes
				}
			}
			navy_experience = 10
			add_doctrine_cost_reduction = {
				name = SPA_armada_espanola
				cost_reduction = 0.5
				uses = 2
				category = naval_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_NAVY_XP FOCUS_FILTER_NAVY_BONUS FOCUS_FILTER_RESEARCH }
	}

	focus = {# Merchant Marine
		id = SPA_upgrade_dockyards
		icon = GFX_goal_generic_buy_ships
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = -1
		y = 1

		prerequisite = {
			focus = SPA_armada_espanola
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_upgrade_dockyards"
			add_ideas = SPA_merchant_marine_idea
		}
	}

	focus = {# Training a New Generation of Admirals
		id = SPA_new_generation_of_admirals
		icon = GFX_goal_navy_hat_ships
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 1
		y = 1

		prerequisite = {
			focus = SPA_armada_espanola
		}

		ai_will_do = { factor = 30 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_new_generation_of_admirals"
			every_navy_leader = {
				add_skill_level = 1
				add_maneuver = 1
			}
		}
		search_filters = { FOCUS_FILTER_NAVY_XP }
	}

	focus = {# Infantería de marina
		id = SPA_infanteria_de_marina
		icon = GFX_goal_generic_marines2
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = -5
		y = 3

		prerequisite = {
			focus = SPA_grand_navy
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_infanteria_de_marina"
			add_tech_bonus = {
				name = SPA_infanteria_de_marina
				bonus = 1
				uses = 1
				category = marine_tech
			}
			custom_effect_tooltip = tooltip_white_line
			enable_tech_marine_bonus = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Grand Navy
		id = SPA_grand_navy
		icon = GFX_goal_generic_sea_focused_navy
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = -3
		y = 2

		prerequisite = {
			focus = SPA_upgrade_dockyards
		}
		prerequisite = {
			focus = SPA_new_generation_of_admirals
		}
		mutually_exclusive = {
			focus = SPA_defend_the_coast
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_grand_navy"
			add_ideas = SPA_grand_navy_idea
			custom_effect_tooltip = tooltip_white_line
			add_mastery_bonus = {
				name = SPA_grand_navy
				bonus = 0.1
				days = 365
				track = capital_ships
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Modern Galleons
		id = SPA_modern_galleons
		icon = GFX_goal_generic_sea_focused_navy2
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = -1
		y = 3

		prerequisite = {
			focus = SPA_grand_navy
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_modern_galleons"
			add_tech_bonus = {
				name = SPA_modern_galleons
				bonus = 1
				uses = 1
				category = bc_tech
				category = bb_tech
			}
			add_tech_bonus = {
				name = SPA_modern_galleons
				bonus = 1
				uses = 1
				category = ship_modules_tech
			}
			custom_effect_tooltip = tooltip_white_line
			add_one_random_dockyard = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Battle Cruiser Support
		id = SPA_battle_cruisers_support
		icon = GFX_goal_generic_navy_cruiser
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = -3
		y = 3

		prerequisite = {
			focus = SPA_grand_navy
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_battle_cruisers_support"
			add_tech_bonus = {
				name = SPA_battle_cruisers_support
				bonus = 1
				uses = 1
				category = ca_tech
			}
			add_tech_bonus = {
				name = SPA_battle_cruisers_support
				bonus = 1
				uses = 1
				category = ship_modules_tech
			}
			custom_effect_tooltip = tooltip_white_line
			add_one_random_dockyard = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Defend the Coast
		id = SPA_defend_the_coast
		icon = GFX_goal_generic_coastal_navy
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 3
		y = 2

		prerequisite = {
			focus = SPA_new_generation_of_admirals
		}
		prerequisite = {
			focus = SPA_upgrade_dockyards
		}
		mutually_exclusive = {
			focus = SPA_grand_navy
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_defend_the_coast"
			add_ideas = SPA_coastal_defence
			custom_effect_tooltip = tooltip_white_line
			add_mastery_bonus = {
				name = SPA_defend_the_coast
				bonus = 0.1
				days = 365
				track = screens
			}
		}
		search_filters = { FOCUS_FILTER_NAVY_XP FOCUS_FILTER_NAVY_BONUS FOCUS_FILTER_RESEARCH }
	}

	focus = {# Coast Guard
		id = SPA_coast_guard
		icon = GFX_goal_generic_coastal_navy2
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 1
		y = 3

		prerequisite = {
			focus = SPA_defend_the_coast
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_coast_guard"
			add_tech_bonus = {
				name = SPA_coast_guard
				bonus = 1
				uses = 1
				category = dd_tech
			}
			add_tech_bonus = {
				name = SPA_coast_guard
				bonus = 1
				uses = 1
				category = ship_modules_tech
			}
			custom_effect_tooltip = tooltip_white_line
			add_one_random_dockyard = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Cruiser Support
		id = SPA_cruiser_support
		icon = GFX_goal_EGY_sultan_fleet
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 3
		y = 3

		prerequisite = {
			focus = SPA_defend_the_coast
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_cruiser_support"
			add_tech_bonus = {
				name = SPA_cruiser_support
				bonus = 1
				uses = 1
				category = ca_tech
			}
			add_tech_bonus = {
				name = SPA_cruiser_support
				bonus = 1
				uses = 1
				category = ship_modules_tech
			}
			custom_effect_tooltip = tooltip_white_line
			add_one_random_dockyard = yes
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Protect our Colonies
		id = SPA_protect_our_colonies
		icon = GFX_focus_generic_africa_naval
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 5
		y = 3

		prerequisite = {
			focus = SPA_defend_the_coast
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_protect_our_colonies"
			290 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = coastal_bunker
						level = 3
						province = 9945
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = coastal_bunker
						NUMBER = 3
						VP = 9945
					}
				}
				custom_override_tooltip = {
					add_building_construction = {
						type = coastal_bunker
						level = 3
						province = 13873
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = coastal_bunker
						NUMBER = 3
						VP = 13873
					}
				}
			}
			297 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = coastal_bunker
						level = 3
						province = 1903
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = coastal_bunker
						NUMBER = 3
						VP = 1903
					}
				}
				add_building_construction = {
					type = bunker
					level = 2
					province = 8244
					instant_build = yes
				}
			}
			968 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						level = 2
						province = 12857
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_victory_point
						BUILDING = bunker
						NUMBER = 2
						VP = 12857
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Masters of the Sea
		id = SPA_masters_of_the_sea
		icon = GFX_goal_generic_naval_academy
		cost = 7

		relative_position_id = SPA_armada_espanola
		x = 0
		y = 4

		prerequisite = {
			focus = SPA_battle_cruisers_support
			focus = SPA_cruiser_support
		}
		prerequisite = {
			focus = SPA_modern_galleons
			focus = SPA_coast_guard
		}

		ai_will_do = { factor = 30 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_masters_of_the_sea"
			add_mastery = {
				amount = 50
				folder = naval
			}
			if = {
				limit = { has_idea = SPA_coastal_defence }
				swap_ideas = {
					remove_idea = SPA_coastal_defence
					add_idea = SPA_navy_focus_idea_coast
				}
			}
			else_if = {
				limit = { has_idea = SPA_grand_navy_idea }
				swap_ideas = {
					remove_idea = SPA_grand_navy_idea
					add_idea = SPA_navy_focus_idea_grand
				}
			}
			else = {
				custom_effect_tooltip = SPA_naval_idea_effect
			}
		}
		search_filters = { FOCUS_FILTER_NAVY_XP FOCUS_FILTER_NAVY_BONUS FOCUS_FILTER_RESEARCH }
	}

### Air Force

	focus = {# Academia Básica del Aire
		id = SPA_academia_basica_del_aire
		icon = GFX_goal_SPA_Airforce
		cost = 7

		x = 40
		y = 4

		prerequisite = {
			focus = SPA_rebuild_command
		}

		ai_will_do = {
			factor = 5
			modifier = {
				factor = 0
				has_civil_war = yes
				NOT = { has_completed_focus = SPA_a_modern_army }
			}
		}
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_academia_basica_del_aire"
			air_experience = 10
			add_doctrine_cost_reduction = {
				name = SPA_academia_basica_del_aire
				cost_reduction = 0.5
				uses = 2
				category = air_doctrine
			}
		}
		search_filters = { FOCUS_FILTER_AIR_XP FOCUS_FILTER_RESEARCH FOCUS_FILTER_AIRFORCE_BONUS }
	}

	focus = {# Upgrade Airports
		id = SPA_upgrade_air_ports
		icon = GFX_goal_generic_build_airforce
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = -3
		y = 1

		prerequisite = {
			focus = SPA_academia_basica_del_aire
		}
		available = {
			175 = { is_owned_and_controlled_by = ROOT }
			169 = { is_owned_and_controlled_by = ROOT }
			165 = { is_owned_and_controlled_by = ROOT }
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_upgrade_air_ports"
			175 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
			169 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
			165 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# New Pilots
		id = SPA_new_pilots
		icon = GFX_goal_new_airforce
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 4
		y = 2

		prerequisite = {
			focus = SPA_academia_basica_del_aire
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_new_pilots"
			air_experience = 50
		}
		search_filters = { FOCUS_FILTER_AIR_XP }
	}

	focus = {# Aviation Industry
		id = SPA_aviation_industry
		icon = GFX_focus_generic_aircraft_production
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 1
		y = 3

		prerequisite = {
			focus = SPA_fighters
			focus = SPA_bombers
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_aviation_industry"
			add_ideas = SPA_aviation_industry_idea
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Air Supremacy
		id = SPA_air_supremacy
		icon = GFX_goal_generic_air_fighter_new
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = -1
		y = 1

		prerequisite = {
			focus = SPA_academia_basica_del_aire
		}
		mutually_exclusive = {
			focus = SPA_army_air_support
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_air_supremacy"
			add_ideas = SPA_air_supremacy_idea
			custom_effect_tooltip = tooltip_white_line
			add_mastery_bonus = {
				name = SPA_air_supremacy
				bonus = 0.1
				days = 365
				track = fighter_aircraft
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Fighter efforts
		id = SPA_fighters
		icon = GFX_goal_generic_air_jet_2
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = -2
		y = 2

		prerequisite = {
			focus = SPA_air_supremacy
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_fighters"
			add_tech_bonus = {
				name = SPA_fighters
				bonus = 0.5
				uses = 2
				category = light_fighter
				category = cat_heavy_fighter
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Army Air Support
		id = SPA_army_air_support
		icon = GFX_goal_generic_air_CAS_new
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 1
		y = 1

		prerequisite = {
			focus = SPA_academia_basica_del_aire
		}
		mutually_exclusive = {
			focus = SPA_air_supremacy
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_army_air_support"
			add_ideas = SPA_army_air_support_idea
			custom_effect_tooltip = tooltip_white_line
			add_mastery_bonus = {
				name = SPA_army_air_support
				bonus = 0.1
				days = 365
				track = strike_aircraft
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Bomber Effort
		id = SPA_bombers
		icon = GFX_goal_generic_air_tactical_bomber_new
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 2
		y = 2

		prerequisite = {
			focus = SPA_army_air_support
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_bombers"
			add_tech_bonus = {
				name = SPA_bombers
				bonus = 0.5
				uses = 2
				category = cas_bomber
				category = tactical_bomber
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = { #Request Foreign Planes
		id = SPA_foreign_airplanes
		icon = GFX_goal_ELS_Plane_Lease
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 0
		y = 2

		prerequisite = {
			focus = SPA_air_supremacy
			focus = SPA_army_air_support
		}

		ai_will_do = { factor = 50 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_foreign_airplanes"
			if = {
				limit = { has_completed_focus = SPA_air_supremacy }
				if = {
					limit = { has_dlc_bba = yes }
					add_equipment_to_stockpile = {
						type = small_plane_airframe_0
						amount = 100
						producer = GER
						variant_name = "Ff 68"
					}
				}
				else = {
					add_equipment_to_stockpile = {
						type = fighter_equipment_0
						amount = 100
						producer = GER
					}
				}
			}
			else_if = {
				limit = { has_completed_focus = SPA_army_air_support }
				if = {
					limit = { has_dlc_bba = yes }
					add_equipment_to_stockpile = {
						type = small_plane_cas_airframe_0
						amount = 100
						producer = GER
						variant_name = "Hs 123"
					}
				}
				else = {
					add_equipment_to_stockpile = {
						type = CAS_equipment_1
						amount = 100
						producer = GER
					}
				}
			}
			else = {
				custom_effect_tooltip = SPA_foreign_airplanes_tt
			}
		}
	}

	focus = {# Voice of Heaven
		id = SPA_voice_of_heaven
		icon = GFX_goal_generic_radar_instillation
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = -1
		y = 3

		prerequisite = {
			focus = SPA_fighters
			focus = SPA_bombers
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_voice_of_heaven"
			add_breakthrough_progress = {
				specialization = specialization_air
				value = 0.5
			}
			custom_effect_tooltip = tooltip_white_line
			add_tech_bonus = {
				name = SPA_voice_of_heaven
				bonus = 1
				uses = 1
				category = radar_tech
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Paratroopers
		id = SPA_paratrooper_focus
		icon = GFX_focus_generic_paratrooper
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 3
		y = 1

		prerequisite = {
			focus = SPA_academia_basica_del_aire
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_paratrooper_focus"
			enable_tech_better_paratroopers = yes
			custom_effect_tooltip = tooltip_white_line
			add_tech_bonus = {
				name = SPA_paratrooper_focus
				bonus = 1
				uses = 1
				category = para_tech
			}
		}
		search_filters = { FOCUS_FILTER_RESEARCH }
	}

	focus = {# Colonial Airports
		id = SPA_colonial_air_ports
		icon = GFX_goal_generic_airports
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = -4
		y = 2

		prerequisite = {
			focus = SPA_upgrade_air_ports
		}
		available = {
			290 = { is_owned_and_controlled_by = ROOT }
			968 = { is_owned_and_controlled_by = ROOT }
			297 = { is_owned_and_controlled_by = ROOT }
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_colonial_air_ports"
			290 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
			968 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
			297 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = air_base
					level = 2
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Rule the Skies
		id = SPA_rule_the_skies
		icon = GFX_goal_air_armada
		cost = 7

		relative_position_id = SPA_academia_basica_del_aire
		x = 0
		y = 4

		prerequisite = {
			focus = SPA_voice_of_heaven
		}
		prerequisite = {
			focus = SPA_aviation_industry
		}

		ai_will_do = { factor = 10 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_rule_the_skies"
			air_experience = 10
			add_mastery = {
				amount = 50
				folder = air
			}
			if = {
				limit = { has_idea = SPA_air_supremacy_idea }
				swap_ideas = {
					remove_idea = SPA_air_supremacy_idea
					add_idea = SPA_rule_the_skies_fighters
				}
			}
			else_if = {
				limit = { has_idea = SPA_army_air_support_idea }
				swap_ideas = {
					remove_idea = SPA_army_air_support_idea
					add_idea = SPA_rule_the_skies_cas
				}
			}
			else_if = {
				limit = {
					NOT = {
						has_idea = SPA_rule_the_skies_fighters
						has_idea = SPA_rule_the_skies_cas
					}
				}
				custom_effect_tooltip = SPA_air_idea_effect
			}
		}
		search_filters = { FOCUS_FILTER_AIR_XP FOCUS_FILTER_RESEARCH FOCUS_FILTER_AIRFORCE_BONUS }
	}

	### POLITICAL FOCUSES

	focus = {
		id = SPA_place_in_the_world
		icon = GFX_goal_generic_alliance
		cost = 3

		relative_position_id = SPA_consolidate_spain
		x = 15
		y = 1

		prerequisite = {
			focus = SPA_consolidate_spain
		}
		mutually_exclusive = {
			focus = SPA_we_stand_alone
		}

		bypass = { is_subject = yes }

		ai_will_do = {
			factor = 70
			modifier = {
				factor = 0
				has_idea = SPA_economic_ruin
				has_idea = SPA_social_breakdown_2
			}
			modifier = {
				factor = 0
				has_game_rule = { rule = SPA_forpol option = SPA_FORPOL_NEUT }
			}
		}
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_place_in_the_world"
			add_political_power = 50
			custom_effect_tooltip = tooltip_white_line
			effect_tooltip = {
				activate_targeted_decision = { target = GER decision = SPA_join_faction }
				activate_targeted_decision = { target = ENT decision = SPA_join_faction }
			}
			custom_effect_tooltip = SPA_faction_effect
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {
		id = SPA_guard_border
		icon = GFX_goal_generic_construct_military
		cost = 6

		relative_position_id = SPA_place_in_the_world
		x = 0
		y = 1

		prerequisite = {
			focus = SPA_place_in_the_world
		}
		available = {
			1070 = { is_fully_controlled_by = ROOT } #Basque Country
			172 = { is_fully_controlled_by = ROOT } #Navarre
			166 = { is_fully_controlled_by = ROOT } #Upper Aragon
			940 = { is_fully_controlled_by = ROOT } #Lower Aragon
			165 = { is_fully_controlled_by = ROOT } #Catalonia
		}

		ai_will_do = { factor = 20 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_guard_border"
			1070 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = {
							all_provinces = yes
							limit_to_border = yes
						}
						level = 3
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_border_provinces
						BUILDING = bunker
						NUMBER = 3
					}
				}
			}
			172 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = {
							all_provinces = yes
							limit_to_border = yes
						}
						level = 3
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_border_provinces
						BUILDING = bunker
						NUMBER = 3
					}
				}
			}
			166 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = {
							all_provinces = yes
							limit_to_border = yes
						}
						level = 3
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_border_provinces
						BUILDING = bunker
						NUMBER = 3
					}
				}
			}
			940 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = {
							all_provinces = yes
							limit_to_border = yes
						}
						level = 3
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_border_provinces
						BUILDING = bunker
						NUMBER = 3
					}
				}
			}
			165 = {
				custom_override_tooltip = {
					add_building_construction = {
						type = bunker
						province = {
							all_provinces = yes
							limit_to_border = yes
						}
						level = 3
						instant_build = yes
					}
					tooltip = {
						localization_key = tooltip_add_building_on_border_provinces
						BUILDING = bunker
						NUMBER = 3
					}
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Iberian Trade
		id = SPA_iberian_trade
		icon = GFX_goal_portugal
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = -2
		y = 1

		prerequisite = {
			focus = SPA_place_in_the_world
		}
		allow_branch = {
			is_in_faction_with = ENT
		}
		available = { is_in_faction_with = POR }

		bypass = {
			NOT = { country_exists = POR }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_iberian_trade"
			add_ideas = SPA_mediterranean_allies1
			POR = { country_event = { id = spain_foreign_policy_events.7 days = 2 } }
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Suppport Sardinia
		id = SPA_support_sardinia
		icon = GFX_goal_FRA_savoie
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_iberian_trade
		}
		allow_branch = {
			is_in_faction_with = SRD
		}
		available = { is_in_faction_with = SRD }

		bypass = {
			NOT = { country_exists = SRD }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_support_sardinia"
			swap_ideas = {
				remove_idea = SPA_mediterranean_allies1
				add_idea = SPA_mediterranean_allies2
			}
			SRD = { country_event = { id = spain_foreign_policy_events.8 days = 2 } }
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Suppport the Borbóns
		id = SPA_support_sicily
		icon = GFX_goal_SIC_kingdom_of_two_sicilies
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_iberian_trade
		}
		allow_branch = {
			is_in_faction_with = SIC
			NOT = { country_exists = SRD }
		}
		available = { is_in_faction_with = SIC }
		bypass = {
			NOT = { country_exists = SIC }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_support_sicily"
			swap_ideas = {
				remove_idea = SPA_mediterranean_allies1
				add_idea = SPA_mediterranean_allies2
			}
			SIC = { country_event = { id = spain_foreign_policy_events.8 days = 2 } }
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Canadian Advisors
		id = SPA_canadian_advisors
		icon = GFX_goal_canada
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = 2
		y = 1

		prerequisite = {
			focus = SPA_place_in_the_world
		}
		available = { is_in_faction_with = IMP }
		allow_branch = {
			is_in_faction_with = ENT
		}
		bypass = {
			NOT = { country_exists = CAN }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_canadian_advisors"
			add_ideas = SPA_entente_advisors1
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# French Advisors
		id = SPA_french_advisors
		icon = GFX_goal_NFA_troops
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_canadian_advisors
		}
		available = { is_in_faction_with = NFA }

		bypass = {
			NOT = { country_exists = NFA }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_french_advisors"
			swap_ideas = {
				remove_idea = SPA_entente_advisors1
				add_idea = SPA_entente_advisors2
			}
		}
	}

	focus = {# Request German Equipment
		id = SPA_german_equipment
		icon = GFX_focus_ger_heavy_tanks
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = -2
		y = 1

		prerequisite = {
			focus = SPA_place_in_the_world
		}
		allow_branch = {
			NOT = { is_in_faction_with = ENT }
		}
		available = { is_in_faction_with = GER }

		bypass = {
			NOT = { country_exists = GER }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_german_equipment"
			add_equipment_to_stockpile = {
				type = medium_tank_chassis
				amount = 100
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = 2000
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = 200
				producer = GER
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# German Mining Projects
		id = SPA_german_mining_projects
		icon = GFX_goal_generic_coal_mining
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_german_equipment
		}
		available = {
			is_in_faction_with = GER
			175 = { is_fully_controlled_by = ROOT }
			173 = { is_fully_controlled_by = ROOT }
		}

		bypass = {
			NOT = { country_exists = GER }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_german_mining_projects"
			175 = {
				add_resource = {
					type = oil
					amount = 5
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
			173 = {
				add_resource = {
					type = steel
					amount = 8
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Renewed German Trade
		id = SPA_mitteleuropa
		icon = GFX_goal_GER_mitteleuropa
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = 2
		y = 1

		prerequisite = {
			focus = SPA_place_in_the_world
		}
		allow_branch = {
			NOT = { is_in_faction_with = ENT }
		}
		available = { is_in_faction_with = GER }

		bypass = {
			NOT = { country_exists = GER }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_mitteleuropa"
			add_ideas = SPA_german_trade1
			GER_add_to_mitteleuropa = yes
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Expanded Mitteleuropean Trade
		id = SPA_expanded_mitteleuropean_trade
		icon = GFX_goal_Empower_the_Reichsbank
		cost = 7

		relative_position_id = SPA_place_in_the_world
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_mitteleuropa
		}
		available = { is_in_faction_with = GER }

		bypass = {
			NOT = { country_exists = GER }
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_expanded_mitteleuropean_trade"
			swap_ideas = {
				remove_idea = SPA_german_trade1
				add_idea = SPA_german_trade2
			}
		}
	}

	focus = { # We Stand Alone
		id = SPA_we_stand_alone
		icon = GFX_goal_generic_defence
		cost = 3

		relative_position_id = SPA_consolidate_spain
		x = 21
		y = 1

		prerequisite = {
			focus = SPA_consolidate_spain
		}
		mutually_exclusive = {
			focus = SPA_place_in_the_world
		}
		available = {
			has_war = no
			is_in_faction = no
		}

		ai_will_do = {
			factor = 70
			modifier = {
				factor = 0
				has_idea = SPA_economic_ruin
				has_idea = SPA_social_breakdown_2
			}
			modifier = {
				factor = 0
				GER = {
					has_completed_focus = GER_leopold_legion
					is_ai = no
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_forpol option = SPA_FORPOL_ENT }
					has_game_rule = { rule = SPA_forpol option = SPA_FORPOL_GER }
				}
			}
			modifier = {
				factor = 0.5
				GER = { has_completed_focus = GER_leopold_legion }
			}
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_we_stand_alone"
			add_ideas = SPA_splendid_isolation
		}
		search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_ANNEXATION FOCUS_FILTER_INDUSTRY }
	}

	focus = {# The Bounties of Neutrality
		id = SPA_bounties_of_neutrality
		icon = GFX_goal_bag_of_money
		cost = 7

		relative_position_id = SPA_we_stand_alone
		x = -2
		y = 1

		prerequisite = {
			focus = SPA_we_stand_alone
		}
		available = { is_subject = no }

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_bounties_of_neutrality"
			swap_ideas = {
				remove_idea = SPA_splendid_isolation
				add_idea = SPA_splendid_isolation2
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Spanish Volunteers
		id = SPA_increased_volunteers
		icon = GFX_goal_generic_army_cooperation
		cost = 7

		relative_position_id = SPA_we_stand_alone
		x = -1
		y = 2

		prerequisite = {
			focus = SPA_bounties_of_neutrality
		}

		available = { is_subject = no }

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_increased_volunteers"
			add_ideas = SPA_increased_volunteers_idea
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}

	focus = {# Influx of Refugees
		id = SPA_influx_of_refugees
		icon = GFX_goal_generic_destruction_civil_war
		cost = 7

		relative_position_id = SPA_we_stand_alone
		x = 2
		y = 1

		prerequisite = {
			focus = SPA_we_stand_alone
		}
		available = {
			has_war = no
			second_weltkrieg_has_begun = yes
		}

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_influx_of_refugees"
			add_ideas = SPA_refugees1
			custom_effect_tooltip = SPA_refugee_idea_tt
		}
		bypass = {
			second_weltkrieg_has_begun = yes
			NOT = {
				OR = {
					GER = { has_war_with = INT }
					GER = { has_war_with = RUS }
					NFA = { has_war_with = INT }
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {# Putting the Refugees to Work
		id = SPA_putting_refugees_to_work
		icon = GFX_goal_refugee_management
		cost = 7

		relative_position_id = SPA_we_stand_alone
		x = 1
		y = 2

		prerequisite = {
			focus = SPA_influx_of_refugees
		}
		available = { is_subject = no }

		ai_will_do = { factor = 40 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_putting_refugees_to_work"
			swap_ideas = {
				remove_idea = SPA_refugees1
				add_idea = SPA_refugees2
			}
			add_ideas = SPA_refugees_work
		}
		bypass = {
			second_weltkrieg_has_begun = yes
			NOT = {
				OR = {
					GER = { has_war_with = INT }
					GER = { has_war_with = RUS }
					NFA = { has_war_with = INT }
				}
			}
		}
	}

	focus = {
		id = SPA_lease_gibraltar
		icon = GFX_goal_gibraltar
		cost = 3

		relative_position_id = SPA_we_stand_alone
		x = 0
		y = 1

		prerequisite = {
			focus = SPA_we_stand_alone
		}
		available = {
			has_war = no
			is_subject = no
			118 = { is_owned_and_controlled_by = ROOT }
			GER = { has_war_with = INT }
		}

		ai_will_do = { factor = 100 }
		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_lease_gibraltar"
			GER = { country_event = { id = spain_foreign_policy_events.11 days = 2 } }
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				118 = { transfer_state_to = GER }
				give_military_access = GER
				add_offsite_building = {
					type = industrial_complex
					level = 3
				}
			}
		}
		search_filters = { FOCUS_FILTER_INDUSTRY }
	}

	focus = {
		id = SPA_bourbon_throne
		icon = GFX_goal_natfrance
		cost = 3

		relative_position_id = SPA_consolidate_spain
		x = 18
		y = 3

		prerequisite = {
			focus = SPA_consolidate_spain
		}
		available = {
			has_war = no
			has_country_leader = { character = SPA_jaime_de_borbon }
			NOT = { is_in_faction_with = NFA }
		}
		allow_branch = {
			has_country_leader = { character = SPA_jaime_de_borbon }
			is_subject = no
		}

		bypass = {
			is_in_faction_with = NFA
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				is_actual_major = no
			}
		}

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_bourbon_throne"
			reverse_add_opinion_modifier = { target = FRA modifier = KR_outraged }
			reverse_add_opinion_modifier = { target = NFA modifier = KR_outraged }
			FRA = {
				every_state = {
					limit = {
						OR = {
							is_core_of = PREV
							is_claimed_by = PREV
						}
					}
					add_claim_by = ROOT
				}
			}
			custom_effect_tooltip = SPA_remove_claims_on_FRA_tt
			hidden_effect = { #To prevent exploit
				set_country_flag = SPA_has_claimed_france
			}
		}
	}

	focus = {# The French Coronation
		id = SPA_franco_spain
		icon = GFX_goal_NFA_French_Kingdom
		cost = 3

		relative_position_id = SPA_bourbon_throne
		x = 0
		y = 1

		prerequisite = {
			focus = SPA_bourbon_throne
		}
		available = {
			has_country_flag = SPA_has_claimed_france
			is_subject = no
			SPA = {
				16 = { is_owned_and_controlled_by = ROOT } #Paris
				18 = { is_owned_and_controlled_by = ROOT } #Champagne
				20 = { is_owned_and_controlled_by = ROOT } #Lyonnais
				21 = { is_owned_and_controlled_by = ROOT } #Provence
				19 = { is_owned_and_controlled_by = ROOT } #Aquitaine
			}
		}
		ai_will_do = { factor = 50 } # The AI should in practice never meet the conditions to do this focus, but if they somehow do so be it.

		completion_reward = {
			log = "[GetLogRoot]: Focus Completed SPA_franco_spain"
			custom_effect_tooltip = SPA_francospain_tt
			hidden_effect = {
				FRA = {
					every_state = {
						limit = {
							OR = {
								is_core_of = PREV
								is_claimed_by = PREV
							}
						}
						remove_claim_by = ROOT
					}
				}
				set_temp_variable = { tag_to_release = FRP }
				every_owned_state = {
					limit = {
						is_core_of = FRA
					}
					transfer_state_to = var:tag_to_release
					add_core_of = var:tag_to_release
				}
				set_autonomy = {
					target = FRP
					autonomy_state = crownland
					end_wars = no
				}
				FRP = { country_event = france_puppet_events.1 }
			}
		}
		search_filters = { FOCUS_FILTER_POLITICAL }
	}
}

