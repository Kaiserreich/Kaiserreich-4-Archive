###########################
# Spain Events
###########################
# By ~mw~
###########################

add_namespace = spain_domestic_events
add_namespace = spain_foreign_policy_events
add_namespace = spanish_civil_war_events

#Events affecting other countries are under 'Foreign Policy'

# Introduction event moved to intro screen

# Black Monday hits Spain
country_event = {
	id = spain_domestic_events.2
	title = spain_domestic_events.2.t
	desc = spain_domestic_events.2.d
	picture = GFX_report_event_NOR_black_monday

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			add_ideas = SPA_black_monday
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.2 option spain_domestic_events.2.a"
		name = spain_domestic_events.2.a
		add_stability = -0.10
		effect_tooltip = { add_ideas = SPA_black_monday }
		if = {
			limit = { focus_progress = { focus = SPA_focus_economy progress > 0.1 } }
			custom_effect_tooltip = SPA_fake_economy_promises_tt
		}
		hidden_effect = {
			country_event = { id = spain_domestic_events.3 days = 30 random_days = 30 }
		}
	}
}

# Social breakdown
country_event = {
	id = spain_domestic_events.3
	title = spain_domestic_events.3.t
	desc = spain_domestic_events.3.d
	picture = GFX_report_event_generic_riot

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.3 option spain_domestic_events.3.a"
		name = spain_domestic_events.3.a
		add_stability = -0.20
	}
}

### Carlist Event Chains

# Alfonso Carlos de Borbon dies
country_event = {
	id = spain_domestic_events.4
	title = spain_domestic_events.4.t
	desc = spain_domestic_events.4.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.4 option spain_domestic_events.4.a"
		name = spain_domestic_events.4.a
		add_stability = -0.02
	}
}

# Javier gives another speech
country_event = {
	id = spain_domestic_events.8
	title = spain_domestic_events.8.t
	desc = spain_domestic_events.8.d
	picture = GFX_report_event_SPA_javier

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			country_event = { id = spain_domestic_events.9 days = 30 random_days = 150 }
			country_event = { id = spain_domestic_events.10 days = 30 random_days = 150 }
			country_event = { id = spain_domestic_events.11 days = 30 random_days = 150 }
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.8 option spain_domestic_events.8.a"
		name = spain_domestic_events.8.a #Time to ban his organisation
		custom_effect_tooltip = SPA_ban_carlists
		add_stability = -0.20
		set_country_flag = SPA_javier_banned
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.8 option spain_domestic_events.8.b"
		name = spain_domestic_events.8.b #Arrest Javier and his followers!
		custom_effect_tooltip = SPA_arrest_javier
		add_stability = -0.10
		set_country_flag = SPA_javier_arrested
		hidden_effect = {
			POR = {
				country_event = { id = spain_foreign_policy_events.3 days = 20 random_days = 80 }
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.8 option spain_domestic_events.8.e"
		name = spain_domestic_events.8.e #Ignore the pretender
		add_political_power = -50
		add_stability = -0.05
		set_country_flag = SPA_javier_ignored
	}
}

# Carlist bombing
country_event = {
	id = spain_domestic_events.9
	title = spain_domestic_events.9.t
	desc = spain_domestic_events.9.d
	picture = GFX_report_event_generic_bombing

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_arrested
			has_country_flag = SPA_javier_ignored
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = SPA_aftermath_of_the_civil_war
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.9 option spain_domestic_events.9.a"
		name = spain_domestic_events.9.a
		add_stability = -0.02
	}
}

# Carlist Demonstrations
country_event = {
	id = spain_domestic_events.10
	title = spain_domestic_events.10.t
	desc = spain_domestic_events.10.d
	picture = GFX_report_event_gathering_protest

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_ignored
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = SPA_aftermath_of_the_civil_war
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.10 option spain_domestic_events.10.a"
		name = spain_domestic_events.10.a
		add_stability = -0.05
	}
}

# Assassination of Miguel Ponte Manso de Zuniga
country_event = {
	id = spain_domestic_events.11
	title = spain_domestic_events.11.t
	desc = spain_domestic_events.11.d
	picture = GFX_report_event_generic_funeral

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_arrested
			has_country_flag = SPA_cntfai_disband
			has_country_flag = SPA_cntfai_arrest
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = SPA_aftermath_of_the_civil_war
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.11 option spain_domestic_events.11.a"
		name = spain_domestic_events.11.a
		add_stability = -0.05
	}
}

### CNT-FAI event chains

# The CNT-FAI speech
country_event = {
	id = spain_domestic_events.13
	title = spain_domestic_events.13.t
	desc = spain_domestic_events.13.d
	picture = GFX_report_event_SPA_CNT_FAI

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			country_event = { id = spain_domestic_events.14 days = 20 random_days = 30 }
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.13 option spain_domestic_events.13.a"
		name = spain_domestic_events.13.a #Ban the organisation of workers
		custom_effect_tooltip = SPA_ban_cntfai
		add_political_power = -100
		add_stability = -0.05
		add_popularity = {
			ideology = social_liberal
			popularity = -0.03
		}
		hidden_effect = {
			country_event = { id = spain_domestic_events.15 days = 20 random_days = 30 }
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.13 option spain_domestic_events.13.b"
		name = spain_domestic_events.13.b #Arrest the leaders of the movement
		custom_effect_tooltip = SPA_arrest_cntfai
		add_stability = -0.10
		set_country_flag = SPA_cntfai_arrest
		add_popularity = {
			ideology = social_conservative
			popularity = -0.03
		}
		add_popularity = {
			ideology = social_liberal
			popularity = -0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = -0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = -0.03
		}
		hidden_effect = {
			country_event = { id = spain_domestic_events.16 days = 20 random_days = 30 }
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.13 option spain_domestic_events.13.c"
		name = spain_domestic_events.13.c #Forcefully disband the movement
		custom_effect_tooltip = SPA_force_cntfai
		add_stability = -0.20
		set_country_flag = SPA_cntfai_disband
		add_popularity = {
			ideology = social_conservative
			popularity = -0.05
		}
		add_popularity = {
			ideology = social_liberal
			popularity = -0.05
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = -0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = -0.03
		}
		hidden_effect = {
			country_event = { id = spain_domestic_events.17 days = 20 random_days = 30 }
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.13 option spain_domestic_events.13.e"
		name = spain_domestic_events.13.e #Allow this to happen
		custom_effect_tooltip = SPA_allow_cntfai
		add_political_power = -200
		add_popularity = {
			ideology = social_conservative
			popularity = 0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = 0.03
		}
		hidden_effect = {
			country_event = { id = spain_domestic_events.18 days = 20 random_days = 80 }
		}
	}
}

# CNT-FAI Protests
country_event = {
	id = spain_domestic_events.14
	title = spain_domestic_events.14.t
	desc = spain_domestic_events.14.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.14 option spain_domestic_events.14.a"
		name = spain_domestic_events.14.a
		add_stability = -0.05
	}
}

# National CNT-FAI Protests
country_event = {
	id = spain_domestic_events.15
	title = spain_domestic_events.15.t
	desc = spain_domestic_events.15.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.15 option spain_domestic_events.15.a"
		name = spain_domestic_events.15.a #Send out the police!
		add_stability = -0.10
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.15 option spain_domestic_events.15.b"
		name = spain_domestic_events.15.b #Allow them to organise
		custom_effect_tooltip = SPA_allow_cntfai
		add_popularity = {
			ideology = social_conservative
			popularity = 0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = 0.03
		}
	}
}

# Arresting the CNT-FAI
country_event = {
	id = spain_domestic_events.16
	title = spain_domestic_events.16.t
	desc = spain_domestic_events.16.d
	picture = GFX_report_event_HOL_zwolle_riots

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.16 option spain_domestic_events.16.a"
		name = spain_domestic_events.16.a #Find the rat and establish a secret police!
		add_political_power = -20
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
				}
				country_event = { id = spain_foreign_policy_events.5 days = 15 }
			}
		}
	}
}

# Forcefully Disbanding the CNT-FAI
country_event = {
	id = spain_domestic_events.17
	title = spain_domestic_events.17.t
	desc = spain_domestic_events.17.d
	picture = GFX_report_event_HOL_zwolle_riots

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.17 option spain_domestic_events.17.a"
		name = spain_domestic_events.17.a
		add_stability = 0.05
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
				}
				country_event = { id = spain_foreign_policy_events.5 days = 15 }
			}
		}
	}
}

# CNT-FAI organising the workers
country_event = {
	id = spain_domestic_events.18
	title = spain_domestic_events.18.t
	desc = spain_domestic_events.18.d
	picture = GFX_report_event_SPA_CNT_FAI

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.18 option spain_domestic_events.18.a"
		name = spain_domestic_events.18.a
		add_stability = 0.02
		hidden_effect = {
			country_event = { id = spain_domestic_events.19 days = 20 random_days = 80 }
		}
	}
}

# CNT-FAI Plan South commenced
country_event = {
	id = spain_domestic_events.19
	title = spain_domestic_events.19.t
	desc = spain_domestic_events.19.d
	picture = GFX_report_event_generic_economic_policy

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.19 option spain_domestic_events.19.a"
		name = spain_domestic_events.19.a
		add_stability = 0.05
		set_country_flag = SPA_cntfai_plan_south
		hidden_effect = {
			country_event = { id = spain_domestic_events.20 days = 20 random_days = 80 }
		}
	}
}

# CNT-FAI Plan South completed
country_event = {
	id = spain_domestic_events.20
	title = spain_domestic_events.20.t
	desc = spain_domestic_events.20.d
	picture = GFX_report_event_generic_economic_policy

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.20 option spain_domestic_events.20.a"
		name = spain_domestic_events.20.a
		173 = {
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
			add_resource = {
				type = steel
				amount = 4
			}
		}
		168 = {
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
}

### Election event chains

# King Alfonso has a stroke
country_event = {
	id = spain_domestic_events.21
	title = spain_domestic_events.21.t
	desc = spain_domestic_events.21.d
	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			country_event = { id = spain_domestic_events.22 days = 10 }
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.21 option spain_domestic_events.21.a"
		name = spain_domestic_events.21.a
		add_political_power = -100
		add_stability = -0.10
	}
}

# King Alfonso is in a coma
country_event = {
	id = spain_domestic_events.22
	title = spain_domestic_events.22.t
	desc = spain_domestic_events.22.d
	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SPA_juan_de_borbon = {
				set_character_name = SPA_juan_de_borbon
				remove_all_country_leader_roles = yes
				add_country_leader_role = {
					country_leader = {
						desc = SPA_juan_de_borbon_regent_leader_desc
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			SPA_alfonso_de_borbon = { kill_character = yes }
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.22 option spain_domestic_events.22.a"
		name = spain_domestic_events.22.a #Call for elections, but with only selected parties
		ai_chance = { base = 50 }
		custom_effect_tooltip = SPA_rig_elections
		hidden_effect = {
			country_event = { id = spain_domestic_events.25 days = 5 }
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.22 option spain_domestic_events.22.b"
		name = spain_domestic_events.22.b #The King is not dead! Do nothing!
		ai_chance = { base = 50 }
		add_stability = -0.10
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.1 days = 10 }
		}
	}
	after = {
		SPA_juan_de_borbon = { character_becomes_leader_of_ruling_party_effect_tooltip = yes }
	}
}

# Election riots
country_event = {
	id = spain_domestic_events.25
	title = spain_domestic_events.25.t
	desc = spain_domestic_events.25.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.25 option spain_domestic_events.25.a"
		name = spain_domestic_events.25.a #Call off the election - Martial Law is declared
		ai_chance = { base = 75 }
		custom_effect_tooltip = SPA_cancel_election
		add_political_power = -200
		add_stability = 0.10
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.1 days = 5 }
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.25 option spain_domestic_events.25.b"
		name = spain_domestic_events.25.b #Nothing will stop this election
		ai_chance = { base = 25 }
		add_stability = -0.10
		hidden_effect = {
			country_event = { id = spain_domestic_events.26 days = 1 }
		}
	}
}

# Election day disaster
country_event = {
	id = spain_domestic_events.26
	title = spain_domestic_events.26.t
	desc = spain_domestic_events.26.d
	picture = GFX_report_event_generic_riot

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_war_with = SWF
			has_war_with = SPR
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.26 option spain_domestic_events.26.a"
		name = spain_domestic_events.26.a
		add_stability = -0.10
		add_manpower = -10000
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.1 days = 4 }
		}
	}
}

### POST-WAR EVENTS

# Replacing the king - Fate of the Monarchy
country_event = {
	id = spain_domestic_events.27

	title = {
		text = spain_domestic_events.27.t.juan
		trigger = { has_character = SPA_juan_de_borbon }
	}
	title = {
		text = spain_domestic_events.27.t.jaime
		trigger = { NOT = { has_character = SPA_juan_de_borbon } }
	}
	desc = {
		text = spain_domestic_events.27.d.juan
		trigger = { has_character = SPA_juan_de_borbon }
	}
	desc = {
		text = spain_domestic_events.27.d.jaime
		trigger = { NOT = { has_character = SPA_juan_de_borbon } }
	}

	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.27 option spain_domestic_events.27.a"
		name = spain_domestic_events.27.a #Name him as Alfonso's successor
		ai_chance = {
			base = 80
			modifier = {
				add = -20
				NOT = { has_character = SPA_juan_de_borbon }
			}
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_PATAUT }
				}
			}
		}
		add_political_power = 40
		effect_tooltip = { retire_character = SPA_alfonso_de_borbon }
		SPA_create_juan = yes
		if = { #If Juan died
			limit = { event_target:original_spain = { SPA_juan_de_borbon = { is_dead = yes } } }
			custom_effect_tooltip = SPA_jaime_bourbon_claims_tt
		}
		else = { #If Juan didn't die
			custom_effect_tooltip = SPA_juan_coronation_tt
		}
		if = {
			limit = { has_democratic_government = yes }
			activate_advisor = SPA_jose_maria_gil_robles_y_quinones_de_leon_sic
		}
		else = { activate_advisor = SPA_emilio_mola_vidal_sic }
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.27 option spain_domestic_events.27.b"
		name = spain_domestic_events.27.b #No, the time of the kingdom is over
		ai_chance = {
			base = 20
			modifier = {
				add = 20
				NOT = { has_character = SPA_juan_de_borbon }
			}
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_JUAN_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JUAN_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_PATAUT }
				}
			}
		}
		add_political_power = -50
		if = {
			limit = { has_idea = SPA_memories_of_the_republic }
			swap_ideas = {
				remove_idea = SPA_memories_of_the_republic
				add_idea = SPA_illegitimate_republic
			}
		}
		effect_tooltip = { retire_character = SPA_alfonso_de_borbon }
		hidden_effect = {
			SPA_remove_monarchy = yes
			set_cosmetic_tag = SPA_republic
		}
		if = {
			limit = { has_democratic_government = yes }
			activate_advisor = SPA_jose_calvo_sotelo_sic
		}
		else = { activate_advisor = SPA_camilo_alonso_vega_sic }
	}
}

# Spain asks to join a faction
country_event = {
	id = spain_domestic_events.31
	title = spain_domestic_events.31.t
	desc = spain_domestic_events.31.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.31 option spain_domestic_events.31.a"
		name = spain_domestic_events.31.a #Absolutely, they are welcome
		ai_chance = { base = 100 }
		add_to_faction = FROM
		FROM = {
			country_event = spain_domestic_events.32
			mark_focus_tree_layout_dirty = yes
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_domestic_events.31 option spain_domestic_events.31.b"
		name = spain_domestic_events.31.b #It's not a good idea
		ai_chance = { base = 0 }
		FROM = { country_event = spain_domestic_events.33 }
	}
}

# Spain admitted to faction
country_event = {
	id = spain_domestic_events.32
	title = spain_domestic_events.32.t
	desc = spain_domestic_events.32.d
	picture = GFX_report_event_generic_diplomacy3

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.32 option spain_domestic_events.32.a"
		name = spain_domestic_events.32.a
		if = {
			limit = { is_in_faction_with = NFA has_completed_focus = SPA_bourbon_throne }
			NFA = { remove_opinion_modifier = { target = ROOT modifier = KR_outraged } }
			FRA = { remove_opinion_modifier = { target = ROOT modifier = KR_outraged } }
			FRA = {
				every_state = {
					limit = {
						OR = {
							is_core_of = PREV
							is_claimed_by = PREV
						}
					}
					remove_claim_by = ROOT
				}
			}
			clr_country_flag = SPA_has_claimed_france
			clr_country_flag = SPA_joining_faction
		}
	}
}

# Spain is turned down
country_event = {
	id = spain_domestic_events.33
	title = spain_domestic_events.33.t
	desc = spain_domestic_events.33.d
	picture = GFX_report_event_worried_french

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.33 option spain_domestic_events.33.a"
		name = spain_domestic_events.33.a
		add_political_power = -20
		clr_country_flag = SPA_joining_faction
	}
}

unit_leader_event = { ### Mohamed Meziane goes to Morocco ###
	id = spain_domestic_events.34
	title = spain_domestic_events.34.t
	desc = { #Goes to Morocco after loss of SPK in civil war
		trigger = {
			NOT = { country_exists = SPK }
		}
		text = spain_domestic_events.34.d1
	}
	desc = { #Goes to Morocco after subjugation of SPK by foreign power
		trigger = {
			SPA = { is_subject = yes }
		}
		text = spain_domestic_events.34.d2
	}

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		country_exists = MOR
	}

	option = {
		log = "[GetLogInfo]: event spain_domestic_events.34 option spain_domestic_events.34.a"
		name = spain_domestic_events.34.a
		effect_tooltip = {
			MOR = { SPA_mohamed_naser_ben_mizzian = { set_nationality = ROOT } }
		}
	}
}

########################################
#### All Spains, Foreign Policy
########################################

# Carlists flee to Portugal
country_event = {
	id = spain_foreign_policy_events.3
	title = spain_foreign_policy_events.3.t
	desc = spain_foreign_policy_events.3.d
	picture = GFX_report_event_SPA_javier

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.3 option spain_foreign_policy_events.3.a"
		name = spain_foreign_policy_events.3.a #Allow them to continue operating from Portugal
		ai_chance = { base = 85 }
		add_political_power = 50
		reverse_add_opinion_modifier = {
			target = GER
			modifier = KR_hates_govt
		}
		reverse_add_opinion_modifier = {
			target = AUS
			modifier = KR_hates_govt
		}
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = KR_outraged
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.3 option spain_foreign_policy_events.3.b"
		name = spain_foreign_policy_events.3.b #Break off diplomatic relations with Spain
		ai_chance = { base = 10 }
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = KR_outraged
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.3 option spain_foreign_policy_events.3.c"
		name = spain_foreign_policy_events.3.c #Wash our hands of the Carlists
		ai_chance = { base = 0 }
		add_political_power = -100
	}
}

# CNT-FAI flees to FRA/SRI/ENG
country_event = {
	id = spain_foreign_policy_events.5
	title = spain_foreign_policy_events.4.t
	desc = spain_foreign_policy_events.4.d
	picture = GFX_report_event_SPA_SWF_refugees

	is_triggered_only = yes

	trigger = {
		has_socialist_government = yes
		NOT = {
			country_exists = SWF
			has_global_flag = spanish_civil_war
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.5 option spain_foreign_policy_events.4.a"
		name = spain_foreign_policy_events.4.a
		ai_chance = {
			base = 75
			modifier = {
				add = -40
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = 10
				tag = FRA
				has_country_flag = FRA_support_SWF
			}
			modifier = {
				add = -70
				tag = ENG
				NOT = { has_country_flag = FRA_support_SWF }
			}
		}
		set_variable = { SWF.SWF_foreign_support = ROOT }
		add_political_power = 60
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = SPA_cntfai_supported
		}
		add_manpower = -20000
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = -500
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.5 option spain_foreign_policy_events.4.b"
		name = spain_foreign_policy_events.4.b
		ai_chance = {
			base = 20
			modifier = {
				add = 25
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = -10
				tag = FRA
				has_country_flag = FRA_support_SWF
			}
		}
		add_political_power = -20
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = SPA_cntfai_given_refuge
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.5 option spain_foreign_policy_events.4.c"
		name = spain_foreign_policy_events.4.c
		ai_chance = {
			base = 0
			modifier = {
				add = 15
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = 70
				tag = ENG
				NOT = { has_country_flag = FRA_support_SWF }
			}
		}
		add_political_power = -100
		set_country_flag = SWF_kicked_out
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = SPA_cntfai_kicked_out
		}
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
					NOT = { has_country_flag = SWF_kicked_out }
				}
				country_event = { id = spain_foreign_policy_events.5 days = 15 }
			}
		}
	}
}

# Latin Economic Union
country_event = {
	id = spain_foreign_policy_events.6
	title = spain_foreign_policy_events.6.t
	desc = spain_foreign_policy_events.6.d
	picture = GFX_report_event_SPA_javier

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.6 option spain_foreign_policy_events.6.a"
		name = spain_foreign_policy_events.6.a
		add_ideas = SPR_economic_cooperation_idea
		add_opinion_modifier = { target = ROOT modifier = KR_trade_agreement }
		reverse_add_opinion_modifier = { target = ROOT modifier = KR_trade_agreement }
	}
}

# Portugal Friendship
country_event = {
	id = spain_foreign_policy_events.7
	title = spain_foreign_policy_events.7.t
	desc = spain_foreign_policy_events.7.d
	picture = GFX_report_event_por_salazar_franco1

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.7 option spain_foreign_policy_events.7.a"
		name = spain_foreign_policy_events.7.a
		random_owned_controlled_state = {
			prioritize = { 112 } #Lisbon
			limit = {
				free_building_slots = { building = industrial_complex size > 1 include_locked = yes }
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
		}
		add_opinion_modifier = { target = FROM modifier = KR_approves_of_govt }
		reverse_add_opinion_modifier = { target = FROM modifier = KR_approves_of_govt }
		add_opinion_modifier = { target = FROM modifier = KR_trade_agreement }
		reverse_add_opinion_modifier = { target = FROM modifier = KR_trade_agreement }
	}
}

# Spanish Friendship
country_event = {
	id = spain_foreign_policy_events.8
	title = spain_foreign_policy_events.8.t
	desc = spain_foreign_policy_events.8.d
	picture = GFX_report_event_SIC_naples

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.8 option spain_foreign_policy_events.8.a"
		name = spain_foreign_policy_events.8.a
		add_opinion_modifier = { target = FROM modifier = KR_approves_of_govt }
		reverse_add_opinion_modifier = { target = FROM modifier = KR_approves_of_govt }
		add_opinion_modifier = { target = FROM modifier = KR_trade_agreement }
		reverse_add_opinion_modifier = { target = FROM modifier = KR_trade_agreement }
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 500
			producer = SPA
		}
		add_equipment_to_stockpile = {
			type = convoy_1
			amount = 50
			producer = SPA
		}
	}
}

country_event = { #Shhhh
	id = spain_foreign_policy_events.10
	title = spain_foreign_policy_events.10.t
	desc = spain_foreign_policy_events.10.d

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.10 option spain_foreign_policy_events.10.a"
		name = spain_foreign_policy_events.10.a
		ai_chance = { base = 0 }
		FRA = {
			every_state = {
				limit = {
					OR = {
						is_core_of = PREV
						is_claimed_by = PREV
					}
				}
				add_claim_by = ROOT
			}
		}
		hidden_effect = {
			set_country_flag = SPA_has_claimed_france
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.10 option spain_foreign_policy_events.10.b"
		name = spain_foreign_policy_events.10.b
		ai_chance = { base = 100 }
	}
}
country_event = { #Gibraltar lease event to GER (triggered by focus)
	id = spain_foreign_policy_events.11
	title = spain_foreign_policy_events.11.t
	desc = spain_foreign_policy_events.11.d
	picture = GFX_report_event_GER_ship

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.11 option spain_foreign_policy_events.11.a"
		name = spain_foreign_policy_events.11.a
		ai_chance = { base = 100 }
		118 = {
			transfer_state_to = GER
			set_compliance = 50
		}
		SPK = { give_military_access = GER }
		add_timed_idea = {
			idea = SPA_gibraltar_lease
			days = 90
		}
		hidden_effect = {
			SPK = {
				set_country_flag = SPA_GER_gibraltar_lease
				country_event = { id = spain_foreign_policy_events.12 days = 2 }
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.11 option spain_foreign_policy_events.11.b"
		name = spain_foreign_policy_events.11.b
		ai_chance = { base = 0 }
		hidden_effect = {
			SPK = { country_event = { id = spain_foreign_policy_events.13 days = 2 } }
		}
	}
}
country_event = { #Germany accepts
	id = spain_foreign_policy_events.12
	title = spain_foreign_policy_events.12.t
	desc = spain_foreign_policy_events.12.d

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.12 option spain_foreign_policy_events.12.a"
		name = spain_foreign_policy_events.12.a
		add_political_power = 10
		add_offsite_building = {
			type = industrial_complex
			level = 3
		}
	}
}
country_event = { #Germany refuses
	id = spain_foreign_policy_events.13
	title = spain_foreign_policy_events.13.t
	desc = spain_foreign_policy_events.13.d

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.13 option spain_foreign_policy_events.13.a"
		name = spain_foreign_policy_events.13.a
		add_political_power = -20
	}
}
country_event = { #Gibraltar Seized after GER capped
	id = spain_foreign_policy_events.14
	title = spain_foreign_policy_events.14.t
	desc = spain_foreign_policy_events.14.d
	picture = GFX_report_event_spr_occupation_of_tangiers

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.14 option spain_foreign_policy_events.14.a"
		name = spain_foreign_policy_events.14.a
	}
}
country_event = { #Notify Germany that Gibraltar will be returned now
	id = spain_foreign_policy_events.15
	title = spain_foreign_policy_events.15.t
	desc = spain_foreign_policy_events.15.d
	picture = GFX_report_event_spr_occupation_of_tangiers

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		GER = { NOT = { has_war_with = SPK } }
	}

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.15 option spain_foreign_policy_events.15.a"
		name = spain_foreign_policy_events.15.a
		118 = {
			set_compliance = 0
			transfer_state_to = SPK
		}
		diplomatic_relation = {
			country = SPK
			relation = military_access
			active = no
		}
		hidden_effect = { SPK = { country_event = { id = spain_foreign_policy_events.16 hours = 5 } } }
	}
}
country_event = { #SPK notified of return of Gibraltar
	id = spain_foreign_policy_events.16
	title = spain_foreign_policy_events.16.t
	desc = spain_foreign_policy_events.16.d
	picture = GFX_report_event_spr_occupation_of_tangiers

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.16 option spain_foreign_policy_events.16.a"
		name = spain_foreign_policy_events.16.a
		hidden_effect = { clr_country_flag = SPA_GER_gibraltar_lease }
	}
}

country_event = { #SPA Requesting Return of Galicia start
	id = spain_foreign_policy_events.17
	title = spain_foreign_policy_events.17.t
	desc = spain_foreign_policy_events.17.d
	picture = GFX_report_event_POR_galicia

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		POR = {
			owns_state = 171
			NOT = { has_war_with = SPA }
		}
	}

	option = { #Request Galicia
		log = "[GetLogInfo]: event spain_foreign_policy_events.17 option spain_foreign_policy_events.17.a"
		name = spain_foreign_policy_events.17.a
		ai_chance = { base = 100 }
		POR = { country_event = { id = spain_foreign_policy_events.18 days = 2 } }
	}

	option = { #Not worth it
		log = "[GetLogInfo]: event spain_foreign_policy_events.17 option spain_foreign_policy_events.17.b"
		name = spain_foreign_policy_events.17.b
		ai_chance = { base = 0 }
		add_stability = -0.05
		add_political_power = -30
	}
}

country_event = { #POR deciding whether to return Galicia
	id = spain_foreign_policy_events.18
	title = spain_foreign_policy_events.18.t
	desc = {
		text = spain_foreign_policy_events.18.d
		trigger = { FROM = { tag = SWF } }
	}
	desc = {
		text = spain_foreign_policy_events.18.d2
		trigger = { FROM = { NOT = { tag = SWF } } }
	}
	picture = GFX_report_event_POR_galicia

	is_triggered_only = yes
	fire_only_once = yes

	option = { #We accept
		log = "[GetLogInfo]: event spain_foreign_policy_events.18 option spain_foreign_policy_events.18.a"
		name = spain_foreign_policy_events.18.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				SPA = { has_socialist_government = yes }
				NOT = { POR = { has_war_with = MAF } }
			}
		}
		add_political_power = -10
		SPA = { country_event = { id = spain_foreign_policy_events.19 days = 2 } }
	}

	option = { #We refuse
		log = "[GetLogInfo]: event spain_foreign_policy_events.18 option spain_foreign_policy_events.18.b"
		name = spain_foreign_policy_events.18.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				SPA = { has_socialist_government = no }
			}
			modifier = {
				factor = 0
				POR = { has_war_with = MAF }
			}
		}
		add_political_power = 20
		SPA = { country_event = { id = spain_foreign_policy_events.20 days = 2 } }
	}
}

country_event = { #POR returns Galicia
	id = spain_foreign_policy_events.19
	title = spain_foreign_policy_events.19.t
	desc = spain_foreign_policy_events.19.d
	picture = GFX_report_event_POR_galicia

	is_triggered_only = yes
	fire_only_once = yes

	immediate = {
		hidden_effect = {
			171 = {
				transfer_state_to = SPA
				remove_claim_by = POR
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event spain_foreign_policy_events.19 option spain_foreign_policy_events.19.a"
		name = spain_foreign_policy_events.19.a
		add_political_power = 20
		hidden_effect = {
			remove_opinion_modifier = {
				target = POR
				modifier = KR_hates_govt
			}
		}
	}
}

country_event = { #POR refuses to return Galicia
	id = spain_foreign_policy_events.20
	title = spain_foreign_policy_events.20.t
	desc = spain_foreign_policy_events.20.d
	picture = GFX_report_event_POR_galicia

	is_triggered_only = yes
	fire_only_once = yes

	option = { #We will get it later, hopefully.
		log = "[GetLogInfo]: event spain_foreign_policy_events.20 option spain_foreign_policy_events.20.a"
		name = spain_foreign_policy_events.20.a
		add_political_power = -20
	}
}

########################################
#### Spanish Civil War
########################################

# Civil War begins
country_event = {
	id = spanish_civil_war_events.1
	title = spanish_civil_war_events.1.t
	desc = spanish_civil_war_events.1.d
	picture = GFX_report_event_SPA_civwar

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			SWF = { set_cosmetic_tag = SPA_socialist_civil_war }
			remove_ideas = {
				SPA_black_monday
				SPA_black_monday_2
				SPA_social_breakdown
				SPA_memories_of_the_republic
			}
			set_country_flag = pre_civil_war_over
			mark_focus_tree_layout_dirty = yes
			activate_targeted_decision = { target = ROOT decision = SPA_secure_loyalty }
			activate_targeted_decision = { target = ROOT decision = SPA_increase_security }
			random_list = {
				50 = { }
				50 = { set_country_flag = SPA_assassination_fail }
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.1 option spanish_civil_war_events.1.a"
		name = spanish_civil_war_events.1.a #We shall fight them!
		SPA_start_civil_war = yes
		if = {
			limit = { is_ai = yes }
			SPA_spawn_AI_reinforcements = yes
		}
		SWF_spawn_AI_reinforcements = yes
		SPR_spawn_AI_reinforcements = yes
		custom_effect_tooltip = available_mio_tt
		show_mio_tooltip = SPAIN_generic_civil_war_organisation
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.1 option spanish_civil_war_events.1.b"
		name = spanish_civil_war_events.1.b #Viva la RevoluciÃ³n! (Play as the CNT-FAI)
		ai_chance = { base = 0 }
		SPA_start_civil_war = yes
		SPA_spawn_AI_reinforcements = yes
		SPR_spawn_AI_reinforcements = yes
		SWF = { change_tag_from = ROOT }
		custom_effect_tooltip = tooltip_white_line
		custom_effect_tooltip = available_mio_tt
		show_mio_tooltip = SPAIN_generic_civil_war_organisation
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.1 option spanish_civil_war_events.1.c"
		name = spanish_civil_war_events.1.c #Long live Javier I! (Play as the Carlists)
		ai_chance = { base = 0 }
		SPA_start_civil_war = yes
		SPA_spawn_AI_reinforcements = yes
		SWF_spawn_AI_reinforcements = yes
		SPR = { change_tag_from = ROOT }
	}
}

country_event = { #Choosing a Chief of Army
	id = spanish_civil_war_events.2
	title = spanish_civil_war_events.2.t
	desc = spanish_civil_war_events.2.d

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.2 option spanish_civil_war_events.2.a"
		name = spanish_civil_war_events.2.a
		ai_chance = { base = 50 }
		clear_army_chief = yes
		activate_advisor = SPA_francisco_franco_bahamonde_army_chief
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.2 option spanish_civil_war_events.2.b"
		name = spanish_civil_war_events.2.b
		ai_chance = { base = 50 }
		clear_army_chief = yes
		activate_advisor = SPA_juan_yague_y_blanco_army_chief
	}
}

# Fall of Madrid
country_event = {
	id = spanish_civil_war_events.3
	title = spanish_civil_war_events.3.t
	desc = {
		text = spanish_civil_war_events.3.carlists
		trigger = { tag = SPR }
	}
	desc = {
		text = spanish_civil_war_events.3.socialists
		trigger = { tag = SWF }
	}
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	immediate = {
		set_country_flag = madrid_fallen_once
	}

	trigger = {
		has_global_flag = spanish_civil_war
		NOT = {
			owns_state = 41  #Madrid
			has_country_flag = madrid_fallen_once
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.3 option spanish_civil_war_events.3.a"
		name = spanish_civil_war_events.3.a #We must scavenge what we can!
		ai_chance = { base = 65 }
		add_political_power = -20
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 750
			producer = SPA
		}
		41 = {
			damage_building = {
				type = industrial_complex
				damage = 1
			}
			damage_building = {
				type = arms_factory
				damage = 1
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.3 option spanish_civil_war_events.3.b"
		name = spanish_civil_war_events.3.b #Leave the city as it stands
		ai_chance = { base = 35 }
		add_political_power = 20
	}
}
#Fall of Burgos
country_event = {
	id = spanish_civil_war_events.4
	title = spanish_civil_war_events.4.t
	desc = {
		text = spanish_civil_war_events.4.kingdom
		trigger = { tag = SPK }
	}
	desc = {
		text = spanish_civil_war_events.4.socialists
		trigger = { tag = SWF }
	}
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	immediate = {
		set_country_flag = burgos_fallen_once
	}

	trigger = {
		has_global_flag = spanish_civil_war
		NOT = {
			owns_state = 176  #Burgos
			has_country_flag = burgos_fallen_once
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.4 option spanish_civil_war_events.4.a"
		name = spanish_civil_war_events.4.a #We must scavenge what we can!
		ai_chance = { base = 65 }
		add_political_power = -20
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 500
			producer = SPA
		}
		176 = {
			damage_building = {
				type = industrial_complex
				damage = 1
			}
			damage_building = {
				type = arms_factory
				damage = 1
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.4 option spanish_civil_war_events.4.b"
		name = spanish_civil_war_events.4.b #Leave the city as it stands
		ai_chance = { base = 35 }
		add_political_power = 20
	}
}
# Fall of Barcelona
country_event = {
	id = spanish_civil_war_events.5
	title = spanish_civil_war_events.5.t
	desc = spanish_civil_war_events.5.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	immediate = {
		set_country_flag = barcelona_fallen_once
	}

	trigger = {
		has_global_flag = spanish_civil_war
		NOT = {
			owns_state = 165 #Barcelona
			has_country_flag = barcelona_fallen_once
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.5 option spanish_civil_war_events.5.a"
		name = spanish_civil_war_events.5.a #We must scavenge what we can!
		ai_chance = { base = 65 }
		add_political_power = -20
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 500
			producer = SPA
		}
		165 = {
			damage_building = {
				type = industrial_complex
				damage = 1
			}
			damage_building = {
				type = arms_factory
				damage = 1
			}
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.5 option spanish_civil_war_events.5.b"
		name = spanish_civil_war_events.5.b #Leave the city as it stands
		ai_chance = { base = 35 }
		add_political_power = 20
	}
}

### KINGDOM OF SPAIN EVENTS ###

# events 101-103 removed

# Kingdom of Spain victory event (fired by on_action)
country_event = {
	id = spanish_civil_war_events.120
	title = spanish_civil_war_events.120.t
	desc = spanish_civil_war_events.120.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.120 option spanish_civil_war_events.120.a"
		log = "KR_Event_Logging;Kingdom of Spain WINS SCW"
		name = spanish_civil_war_events.120.a
		add_political_power = 50
		SPA_post_civil_war = yes
		hidden_effect = {
			news_event = { id = spanish_civil_war_events.401 days = 1 }
			country_event = { id = spanish_civil_war_events.322 days = 15 }
			country_event = { id = spanish_civil_war_events.600 days = 10 } #Socialist Resistance
		}
	}
}

# Terror event
country_event = {
	id = spanish_civil_war_events.122
	title = spanish_civil_war_events.122.t
	desc = spanish_civil_war_events.122.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		num_occupied_states > 0
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.122 option spanish_civil_war_events.122.a"
		name = spanish_civil_war_events.122.a
		add_stability = -0.02
	}
}

### CNT-FAI EVENTS ###

# events 204-206 removed

# CNT victory event (fired by on_action)
country_event = {
	id = spanish_civil_war_events.220
	title = spanish_civil_war_events.220.t
	desc = spanish_civil_war_events.220.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.220 option spanish_civil_war_events.220.a"
		log = "KR_Event_Logging;CNT-FAI WINS SCW"
		name = spanish_civil_war_events.220.a
		add_political_power = 50
		set_cosmetic_tag = SPA_socialist
		if = {
			limit = { has_idea = SWF_advisors_france }
			remove_ideas = SWF_advisors_france
		}

		SPA_post_civil_war = yes

		hidden_effect = {
			news_event = { id = spanish_civil_war_events.401 days = 1 }
			country_event = { id = spanish_civil_war_events.221 days = 5 }
			country_event = { id = spanish_civil_war_events.322 days = 15 }
			country_event = { id = spanish_civil_war_events.601 days = 10 } #Reactionary Resistance
		}
	}
}

# CNT considers moving the capital to Madrid
country_event = {
	id = spanish_civil_war_events.221
	title = spanish_civil_war_events.221.t
	desc = spanish_civil_war_events.221.d
	picture = GFX_report_event_generic_diplomacy4

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.221 option spanish_civil_war_events.221.a"
		name = spanish_civil_war_events.221.a
		set_capital = { state = 41 remember_old_capital = no }
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.221 option spanish_civil_war_events.221.b"
		name = spanish_civil_war_events.221.b
		ai_chance = { base = 0 }
	}
	after = {
		add_political_power = 20
	}
}

### Event for SPK and SWF about MIO merges

country_event = {
	id = spanish_civil_war_events.222
	title = spanish_civil_war_events.222.t
	desc = spanish_civil_war_events.222.d
	picture = GFX_report_event_FNG_industry2

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.222 option spanish_civil_war_events.222.a"
		name = spanish_civil_war_events.222.a
		mio:SPAIN_generic_civil_war_organisation = {
			set_temp_variable = { current_mio_size = THIS.size }
			set_temp_variable = { current_mio_funds = THIS.funds }
		}
		custom_effect_tooltip = unavailable_mio_tt
		show_mio_tooltip = SPAIN_generic_civil_war_organisation
		custom_effect_tooltip = tooltip_white_line
		custom_effect_tooltip = SPA_SCW_arms_industry_tt
		custom_effect_tooltip = tooltip_white_line
		mio:SPAIN_astra_unceta_organisation = {
			add_mio_size = current_mio_size
			add_mio_funds = current_mio_funds
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.222 option spanish_civil_war_events.222.b"
		name = spanish_civil_war_events.222.b
		mio:SPAIN_generic_civil_war_organisation = {
			set_temp_variable = { current_mio_size = THIS.size }
			set_temp_variable = { current_mio_funds = THIS.funds }
		}
		custom_effect_tooltip = unavailable_mio_tt
		show_mio_tooltip = SPAIN_generic_civil_war_organisation
		custom_effect_tooltip = tooltip_white_line
		custom_effect_tooltip = SPA_SCW_arms_industry_tt
		custom_effect_tooltip = tooltip_white_line
		mio:SPAIN_star_bonifacio_organisation = {
			add_mio_size = current_mio_size
			add_mio_funds = current_mio_funds
		}
	}
	after = {
		SPK = { clr_country_flag = SPA_civil_war_military_industrial_organisations }
		SWF = { clr_country_flag = SPA_civil_war_military_industrial_organisations }
	}
}

### ASSASSINATION EVENT CHAIN

# Assassination plot begins
country_event = {
	id = spanish_civil_war_events.306
	title = spanish_civil_war_events.306.t
	desc = spanish_civil_war_events.306.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_juan_de_borbon } }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.306 option spanish_civil_war_events.306.a"
		name = spanish_civil_war_events.306.a
		hidden_effect = {
			random_list = {
				1 = {
					modifier = {
						factor = 0
						SPK = { has_country_flag = SPA_security2 }
					}
					country_event = { id = spanish_civil_war_events.309 days = 10 } #success
				}
				0 = {
					modifier = {
						add = 1
						SPK = {
							OR = {
								has_country_flag = SPA_security2
								has_country_flag = SPA_security1
							}
						}
					}
					country_event = { id = spanish_civil_war_events.307 days = 10 } #fails
				}
			}
		}
	}
}

# Assassination plot fails
country_event = {
	id = spanish_civil_war_events.307
	title = spanish_civil_war_events.307.t
	desc = spanish_civil_war_events.307.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_juan_de_borbon } }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.307 option spanish_civil_war_events.307.a"
		name = spanish_civil_war_events.307.a
		add_political_power = -10
		hidden_effect = {
			SPA = {
				country_event = spanish_civil_war_events.308
			}
		}
	}
}

# Inform Kingdom of Spain that plot failed
country_event = {
	id = spanish_civil_war_events.308
	title = spanish_civil_war_events.308.t
	desc = spanish_civil_war_events.308.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.308 option spanish_civil_war_events.308.a"
		name = spanish_civil_war_events.308.a
		add_political_power = 50
		add_stability = 0.05
	}
}

# Assassination plot succeeds
country_event = {
	id = spanish_civil_war_events.309
	title = spanish_civil_war_events.309.t
	desc = spanish_civil_war_events.309.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_juan_de_borbon } }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.309 option spanish_civil_war_events.309.a"
		name = spanish_civil_war_events.309.a
		add_political_power = 50
		add_war_support = 0.05
		hidden_effect = {
			SPA = {
				country_event = spanish_civil_war_events.310
			}
		}
	}
}

# Inform Kingdom of Spain that plot succeeded. Juan dies
country_event = {
	id = spanish_civil_war_events.310
	title = spanish_civil_war_events.310.t
	desc = spanish_civil_war_events.310.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	trigger = {
		has_war_with = SPR
		has_country_leader = { character = SPA_juan_de_borbon }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.310 option spanish_civil_war_events.310.a"
		name = spanish_civil_war_events.310.a #Emilio Mola takes control (pataut)
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_SOCCON }
				}
			}
		}
		set_politics = {
			ruling_party = paternal_autocrat
		}
		add_popularity = {
			ideology = paternal_autocrat
			popularity = 0.25
		}
		activate_advisor = SPA_camilo_alonso_vega_sic
		hidden_effect = {
			promote_character = SPA_emilio_mola_vidal
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.310 option spanish_civil_war_events.310.b"
		name = spanish_civil_war_events.310.b #J.M. Gil-Robles QuiÃ±ones retains the government (authdem)
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_PATAUT }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_PATAUT }
				}
			}
		}
		activate_advisor = SPA_jose_calvo_sotelo_sic
		hidden_effect = {
			promote_character = SPA_jose_maria_gil_robles_y_quinones_de_leon
		}
	}
	after = {
		add_timed_idea = {
			idea = SPA_regent_killed
			days = 90
		}
		hidden_effect = {
			SWF = { country_event = { id = spanish_civil_war_events.311 days = 1 } }
			SPA_juan_de_borbon = { kill_character = yes }
		}
	}
}

# CNT informed of the regent's assassination
country_event = {
	id = spanish_civil_war_events.311
	title = spanish_civil_war_events.311.t
	desc = spanish_civil_war_events.311.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.311 option spanish_civil_war_events.311.a"
		name = spanish_civil_war_events.311.a
	}
}

# Carlist victory event (triggered by on_action)
country_event = {
	id = spanish_civil_war_events.320
	title = spanish_civil_war_events.320.t
	desc = spanish_civil_war_events.320.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.320 option spanish_civil_war_events.320.a"
		log = "KR_Event_Logging;Carlists WINS SCW"
		name = spanish_civil_war_events.320.a
		add_political_power = 50
		set_cosmetic_tag = SPA_carlists_kingdom
		SPA_post_civil_war = yes
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.321 days = 5 }
			country_event = { id = spanish_civil_war_events.322 days = 15 }
			news_event = { id = spanish_civil_war_events.401 days = 1 }
			country_event = { id = spanish_civil_war_events.600 days = 10 } #Socialist Resistance
		}
	}
}

# SPR considers moving the capital to Madrid
country_event = {
	id = spanish_civil_war_events.321
	title = spanish_civil_war_events.321.t
	desc = spanish_civil_war_events.321.d
	picture = GFX_report_event_generic_diplomacy4

	trigger = {
		41 = { is_owned_and_controlled_by = ROOT } #Madrid
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.321 option spanish_civil_war_events.321.a"
		name = spanish_civil_war_events.321.a
		ai_chance = { base = 100 }
		set_capital = { state = 41 remember_old_capital = no }
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.321 option spanish_civil_war_events.321.b"
		name = spanish_civil_war_events.321.b
		ai_chance = { base = 0 }
	}
	after = {
		add_political_power = 20
	}
}

# The Troubles Continue
country_event = {
	id = spanish_civil_war_events.322
	title = spanish_civil_war_events.322.t
	desc = spanish_civil_war_events.322.d
	picture = GFX_report_event_generic_ruins

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.322 option spanish_civil_war_events.322.a"
		name = spanish_civil_war_events.322.a
		set_stability = 0.50
		set_war_support = 0.20
		add_timed_idea = {
			idea = SPA_recover_legitimacy_stability
			days = 140
		}
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.323 days = 140 }
		}
	}
}

# Recovery event #1
country_event = {
	id = spanish_civil_war_events.323
	title = spanish_civil_war_events.323.t
	desc = spanish_civil_war_events.323.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.323 option spanish_civil_war_events.322.a"
		name = spanish_civil_war_events.322.a
		if = {
			limit = {
				has_war_support < 0.5
				has_stability < 0.5
			}
			add_timed_idea = {
				idea = SPA_recover_legitimacy_both
				days = 140
			}
		}
		else_if = {
			limit = { has_war_support < 0.5 }
			add_timed_idea = {
				idea = SPA_recover_legitimacy_war_support
				days = 140
			}
		}
		else = {
			add_timed_idea = {
				idea = SPA_recover_legitimacy_stability
				days = 140
			}
		}
		add_political_power = 50
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.324 days = 140 }
		}
	}
}

# Recovery event #2
country_event = {
	id = spanish_civil_war_events.324
	title = spanish_civil_war_events.323.t
	desc = spanish_civil_war_events.323.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	trigger = {
		has_war = no
		OR = {
			has_stability < 0.5
			has_war_support < 0.5
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.324 option spanish_civil_war_events.322.a"
		name = spanish_civil_war_events.322.a
		if = {
			limit = {
				has_war_support < 0.5
				has_stability < 0.5
			}
			add_timed_idea = {
				idea = SPA_recover_legitimacy_both
				days = 140
			}
		}
		else_if = {
			limit = { has_war_support < 0.5 }
			add_timed_idea = {
				idea = SPA_recover_legitimacy_war_support
				days = 140
			}
		}
		else = {
			add_timed_idea = {
				idea = SPA_recover_legitimacy_stability
				days = 140
			}
		}
		add_political_power = 50
		hidden_effect = {
			country_event = { id = spanish_civil_war_events.324 days = 140 }
		}
	}
}

news_event = { #Spanish Civil War Starts
	id = spanish_civil_war_events.400
	immediate = { log = "[GetLogInfo]: event spanish_civil_war_events.400" }
	title = spanish_civil_war_events.400.t
	desc = spanish_civil_war_events.400.d
	picture = GFX_news_event_SPA_spanish_civil_war

	major = yes
	fire_for_sender = no
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		NOT = {
			tag = SWF
			tag = SPA
			tag = SPR
		}
	}

	option = {
		name = spanish_civil_war_events.400.a
		effect_tooltip = {
			add_named_threat = {
				threat = 5
				name = SPA_civil_war_threat
			}
		}
	}
}

# Spanish Civil War Ends
news_event = {
	id = spanish_civil_war_events.401
	immediate = { log = "[GetLogInfo]: event spanish_civil_war_events.401" }
	title = spanish_civil_war_events.401.t
	desc = {
		text = spanish_civil_war_events.401.SPK
		trigger = { country_exists = SPK }
	}
	desc = {
		text = spanish_civil_war_events.401.SWF
		trigger = { country_exists = SWF }
	}
	desc = {
		text = spanish_civil_war_events.401.SPR
		trigger = { country_exists = SPR }
	}
	picture = GFX_news_event_SPA_victory

	major = yes
	fire_for_sender = no

	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	option = {	# Interesting
		name = spanish_civil_war_events.401.a
		trigger = {
			NOT = { country_exists = SWF }
			has_socialist_government = no
		}
	}
	option = {	# Another victory for the workers of the world!
		name = spanish_civil_war_events.401.b
		trigger = {
			has_socialist_government = yes
			country_exists = SWF
		}
	}
	option = {	# Spain has fallen into the hands of radicals.
		name = spanish_civil_war_events.401.c
		trigger = {
			has_socialist_government = no
			country_exists = SWF
		}
	}
	option = {	# Spain in chains again, but not forever.
		name = spanish_civil_war_events.401.d
		trigger = {
			NOT = { country_exists = SWF }
			has_socialist_government = yes
		}
	}
}

# Collapse of the Spanish Colonial Empire
country_event = { #Spanish Africa Switches Sides
	id = spanish_civil_war_events.500
	title = spanish_civil_war_events.500.t
	desc = spanish_civil_war_events.500.d
	picture = GFX_report_event_generic_ruins

	trigger = {
		has_civil_war = yes
		has_capitulated = no
	}

	is_triggered_only = yes
	fire_only_once = yes

	immediate = {
		hidden_effect = {
			SPA = {
				every_owned_state = {
					limit = { NOT = { is_core_of = PREV } }
					transfer_state_to = ROOT
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.500 option spanish_civil_war_events.500.a"
		name = spanish_civil_war_events.500.a
		effect_tooltip = {
			every_owned_state = {
				limit = { NOT = { is_core_of = ROOT } }
				transfer_state_to = ROOT
			}
		}
	}
}

country_event = {
	id = spanish_civil_war_events.501
	title = spanish_civil_war_events.501.t
	desc = spanish_civil_war_events.501.d
	picture = GFX_report_event_generic_ruins

	trigger = {
		OR = {
			297 = { is_core_of = ROOT } #Douala
			538 = { is_core_of = ROOT } #Gabon
			has_socialist_government = no
		}
		var:297.owner = { is_ally_with = SWF }
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.501 option spanish_civil_war_events.501.a"
		name = spanish_civil_war_events.501.a
		transfer_state = 297
		297 = { add_claim_of_ROOT = yes }
		SWF = { country_event = spanish_civil_war_events.502 }
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.501 option spanish_civil_war_events.501.b"
		name = spanish_civil_war_events.501.b
		ai_chance = { base = 0 }
		if = {
			limit = { NOT = { owns_state = 538 } } #Gabon
			add_political_power = -10
			var:538.owner = { country_event = spanish_civil_war_events.501 }
		}
		else = {
			add_political_power = -100
		}
	}
}

country_event = { #Conflict in Africa seized equatorial guinea
	id = spanish_civil_war_events.502
	title = spanish_civil_war_events.502.t
	desc = spanish_civil_war_events.502.d
	picture = GFX_report_event_NFA_event_NFAGenericArmy

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.502 option spanish_civil_war_events.502.a"
		name = spanish_civil_war_events.502.a #Let them take them
		ai_chance = { base = 80 }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.502 option spanish_civil_war_events.502.b"
		name = spanish_civil_war_events.502.b #Offer what resistance we can.....
		ai_chance = { base = 20 }
		add_political_power = -40
		297 = {
			add_resistance = 20
			add_resistance_target = {
				amount = 20
				days = 730
				tooltip = SWF_colonial_resistance
			}
		}
	}

	after = {
		add_opinion_modifier = { target = FROM modifier = KR_hates_govt }
	}
}

country_event = { #SWF in Africa what to do with Rio de Oro
	id = spanish_civil_war_events.503
	title = spanish_civil_war_events.503.t

	desc = {
		text = spanish_civil_war_events.503.d.mrt
		trigger = { original_tag = MRT }
	}
	desc = {
		text = spanish_civil_war_events.503.d.not_mrt
		trigger = { NOT = { original_tag = MRT } }
	}

	picture = GFX_report_event_NFA_event_ArmyReview

	trigger = {
		OR = {
			967 = { is_core_of = ROOT } #Adrar
			has_socialist_government = no
		}
		var:699.owner = { is_ally_with = SWF }
	}

	is_triggered_only = yes
	fire_only_once = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.503 option spanish_civil_war_events.503.a"
		name = spanish_civil_war_events.503.a #Occupy those territories
		trigger = { original_tag = MRT }
		add_state_core = 699
		transfer_state = 699
		SWF = { country_event = spanish_civil_war_events.506 }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.503 option spanish_civil_war_events.503.b"
		name = spanish_civil_war_events.503.b #Occupy those territories
		trigger = { NOT = { original_tag = MRT } }
		add_manpower = -1000
		add_equipment_to_stockpile = { type = infantry_equipment amount = -500 }
		add_state_claim = 699
		transfer_state = 699
		SWF = { country_event = spanish_civil_war_events.505 }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.503 option spanish_civil_war_events.503.c"
		name = spanish_civil_war_events.503.c #Don't
		trigger = { NOT = { original_tag = MRT } }
		ai_chance = { base = 0 }
		add_political_power = -100
		if = {
			limit = {
				NOT = { tag = MOR }
				country_exists = MOR
				MOR = { has_capitulated = no }
			}
			add_political_power = -10
			MOR = { country_event = spanish_civil_war_events.503 }
		}
		else = {
			add_political_power = -100
		}
	}
}

country_event = { #SWF - Conflict in Africa seized rio de oro
	id = spanish_civil_war_events.505
	title = spanish_civil_war_events.505.t
	desc = spanish_civil_war_events.505.d
	picture = GFX_report_event_NFA_event_NFAGenericArmy

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.505 option spanish_civil_war_events.505.a"
		name = spanish_civil_war_events.505.a #Let them take them
		ai_chance = { base = 80 }
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.505 option spanish_civil_war_events.505.b"
		name = spanish_civil_war_events.505.b #Offer what resistance we can.....
		ai_chance = { base = 20 }
		add_political_power = -40
		699 = {
			add_resistance = 20
			add_resistance_target = {
				amount = 20
				days = 730
				tooltip = SWF_colonial_resistance
			}
		}
	}

	after = {
		add_opinion_modifier = { target = FROM modifier = KR_hates_govt }
	}
}

country_event = { #SWF - Conflict in Africa seized rio de oro (MRT)
	id = spanish_civil_war_events.506
	title = spanish_civil_war_events.506.t
	desc = spanish_civil_war_events.506.d
	picture = GFX_report_event_NFA_event_NFAGenericArmy

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.506 option spanish_civil_war_events.506.a"
		name = spanish_civil_war_events.506.a #Let them take them
		add_opinion_modifier = { target = FROM modifier = KR_hates_govt }
	}
}

country_event = { #SWF in Africa what to do with the Rif
	id = spanish_civil_war_events.507
	title = spanish_civil_war_events.507.t
	desc = {
		text = spanish_civil_war_events.507.d_ger
		trigger = { has_subject = MOR }
	}
	desc = {
		text = spanish_civil_war_events.507.d_other
		trigger = { NOT = { has_subject = MOR } }
	}
	picture = GFX_report_event_NFA_event_ArmyReview

	trigger = {
		OR = {
			tag = MOR
			has_socialist_government = no
		}
		SWF = { any_owned_state = { is_core_of = MOR } }
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.507 option spanish_civil_war_events.507.a"
		name = spanish_civil_war_events.507.a #Occupy those territories
		trigger = { has_subject = MOR }
		add_manpower = -1000
		add_equipment_to_stockpile = { type = infantry_equipment amount = -500 }
		SWF = {
			every_owned_state = {
				limit = { is_core_of = MOR }
				teleport_armies = { to_state = 169 } #Sevilla
				transfer_state_to = MOR
			}
			country_event = spanish_civil_war_events.508
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.507 option spanish_civil_war_events.507.b"
		name = spanish_civil_war_events.507.b #Occupy those territories
		trigger = {
			NOT = { tag = GER }
		}
		add_manpower = -1000
		add_equipment_to_stockpile = { type = infantry_equipment amount = -500 }
		SWF = {
			every_owned_state = {
				limit = { is_core_of = MOR }
				teleport_armies = { to_state = 169 } #Sevilla
				transfer_state_to = ROOT
			}
			country_event = spanish_civil_war_events.508
		}
	}

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.507 option spanish_civil_war_events.507.c"
		name = spanish_civil_war_events.507.c #Don't
		ai_chance = { base = 0 }
		add_political_power = -100
		if = {
			limit = {
				NOT = { tag = NFA }
				country_exists = NFA
				NFA = { has_capitulated = no }
			}
			add_political_power = -10
			NFA = { country_event = spanish_civil_war_events.507 }
		}
		else = {
			add_political_power = -100
		}
	}
}
country_event = { # German Empire occupies Spanish Morocco
	id = spanish_civil_war_events.508
	title = spanish_civil_war_events.508.t
	desc = spanish_civil_war_events.508.d

	is_triggered_only = yes

	option = { # Nothing we can do
		log = "[GetLogInfo]: event spanish_civil_war_events.508 option spanish_civil_war_events.508.a"
		name = spanish_civil_war_events.508.a
		add_opinion_modifier = { target = FROM modifier = KR_hates_govt }
	}
}
country_event = { #Syndicalist Resistance (Post War)
	id = spanish_civil_war_events.600
	title = spanish_civil_war_events.600.t
	desc = spanish_civil_war_events.600.d
	picture = GFX_report_event_generic_riot2
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.600 option spanish_civil_war_events.600.a"
		name = spanish_civil_war_events.600.a
		add_ideas = SPR_syndicalist_resistance
		add_popularity = { ideology = totalist popularity = 0.03 }
		add_popularity = { ideology = syndicalist popularity = 0.07 }
		add_popularity = { ideology = radical_socialist popularity = 0.05 }
	}
}
country_event = { #Monarchist Resistance (Post War)
	id = spanish_civil_war_events.601
	title = spanish_civil_war_events.601.t
	desc = spanish_civil_war_events.601.d
	picture = GFX_report_event_generic_riot2
	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.601 option spanish_civil_war_events.601.a"
		name = spanish_civil_war_events.601.a
		add_ideas = SWF_monarchist_resistance
		add_popularity = { ideology = social_conservative popularity = 0.03 }
		add_popularity = { ideology = authoritarian_democrat popularity = 0.07 }
		add_popularity = { ideology = paternal_autocrat popularity = 0.05 }
		add_popularity = { ideology = national_populist popularity = 0.08 }
	}
}
country_event = { #Congress of Iberian Socialists
	id = spanish_civil_war_events.602
	title = spanish_civil_war_events.602.t
	desc = spanish_civil_war_events.602.d
	picture = GFX_report_event_SPA_CNT_FAI

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.602 option spanish_civil_war_events.602.a"
		name = spanish_civil_war_events.602.a #CNT
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_game_rule = { rule = SWF_path option = SWF_PATH_RADSOC }
			}
		}
		add_popularity = {
			ideology = syndicalist
			popularity = 0.1
		}
		set_temp_variable = { coalition_partner_var = token:totalist }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:radical_socialist }
		add_to_coalition = yes
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.602 option spanish_civil_war_events.602.b"
		name = spanish_civil_war_events.602.b #PSOE
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_game_rule = { rule = SWF_path option = SWF_PATH_SYNDIE }
			}
		}
		set_politics = { ruling_party = radical_socialist }
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.1
		}
		set_temp_variable = { coalition_partner_var = token:totalist }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:syndicalist }
		add_to_coalition = yes
	}
}
country_event = { #SPA SoCon switch
	id = spanish_civil_war_events.603
	title = spanish_civil_war_events.603.t
	desc = spanish_civil_war_events.603.d
	picture = GFX_report_event_generic_conference4

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.603 option spanish_civil_war_events.603.a"
		name = spanish_civil_war_events.603.a #AuthDem
		ai_chance = {
			base = 60
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_JUAN_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_SOCCON }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_SOCCON }
				}
			}
		}
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.1
		}
	}
	option = {
		log = "[GetLogInfo]: event spanish_civil_war_events.603 option spanish_civil_war_events.603.b"
		name = spanish_civil_war_events.603.b #SocCon
		ai_chance = {
			base = 40
			modifier = {
				factor = 0
				OR = {
					has_game_rule = { rule = SPA_path option = SPA_PATH_JUAN_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_JAIME_AUTDEM }
					has_game_rule = { rule = SPA_path option = SPA_PATH_REP_AUTDEM }
				}
			}
		}
		set_politics = { ruling_party = social_conservative }
		add_popularity = {
			ideology = social_conservative
			popularity = 0.3
		}
		hidden_effect = {
			set_temp_variable = { coalition_partner_var = token:authoritarian_democrat }
			add_to_coalition = yes
			set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
			add_to_coalition = yes
		}
		if = {
			limit = { is_monarchy = yes }
			activate_advisor = SPA_jose_calvo_sotelo_sic
		}
		else = { activate_advisor = SPA_jose_maria_gil_robles_y_quinones_de_leon_sic }
	}
}
